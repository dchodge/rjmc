<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Example 2: SEIR change-point attack rate • rjmc</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Example 2: SEIR change-point attack rate">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rjmc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Ex1_mixture.html">Example 1: Mixture model</a>
    </li>
    <li>
      <a href="../articles/Ex2_seir_attack_rate.html">Example 2: SEIR change-point attack rate</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Example 2: SEIR change-point attack rate</h1>
                        <h4 data-toc-skip class="author">David
Hodgson</h4>
            
            <h4 data-toc-skip class="date">2025-08-13</h4>
      

      <div class="hidden name"><code>Ex2_seir_attack_rate.Rmd</code></div>

    </div>

    
    
<!-- Triggering GitHub Actions workflow -->
<p>This vignette demonstrates using RJMCMC to infer a piecewise-constant
attack/transmission rate (change-point analysis) in a simple SEIR model
from simulated incidence data.</p>
<ul>
<li>The time-varying transmission rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\beta(t)</annotation></semantics></math>
is modeled as a step function with an unknown number of segments and
unknown change-points.</li>
<li>RJMCMC explores the model dimension by proposing birth/death moves
on the number of segments, and random-walk updates to segment-specific
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
values.</li>
<li>We show recovery of both the number and locations of change-points
and the underlying incidence curve.</li>
</ul>
<p><strong>Note</strong>: All safety checks and validation functions
have been extracted to separate R files to make this vignette more
concise and maintainable. When running this vignette interactively,
these functions will be automatically loaded. For pkgdown builds, the
functions are already available through the package.</p>
<div class="section level2">
<h2 id="packages">1. Packages<a class="anchor" aria-label="anchor" href="#packages"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/load_all.html" class="external-link">load_all</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mjskay.github.io/tidybayes/" class="external-link">tidybayes</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mjskay.github.io/ggdist/" class="external-link">ggdist</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load safety check functions (only when running interactively)</span></span>
<span><span class="co"># These functions provide comprehensive input validation and safe defaults</span></span>
<span><span class="co"># See R/safety_check_Ex2.R for full documentation</span></span>
<span><span class="co"># Note: In pkgdown builds, these functions are available through the package</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="st">"R/safety_check_Ex2.R"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Load corrected birth and death functions</span></span>
<span>  <span class="co"># These functions match the thesis exactly and include proper dimension checks</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="st">"R/corrected_birth_death.R"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Load simple and robust birth/death functions</span></span>
<span>  <span class="co"># These are much simpler and more standard implementations</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="st">"R/simple_birth_death.R"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Using more than one core might fail on windows</span></span>
<span><span class="va">aaa_mc_cores</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="va">.Platform</span><span class="op">$</span><span class="va">OS.type</span> <span class="op">==</span> <span class="st">"windows"</span><span class="op">)</span> <span class="fl">1</span> <span class="kw">else</span> <span class="fl">2</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simulate-seir-with-piecewise-constant-transmission-rate">2. Simulate SEIR with piecewise-constant transmission rate<a class="anchor" aria-label="anchor" href="#simulate-seir-with-piecewise-constant-transmission-rate"></a>
</h2>
<p>We simulate a discrete-time SEIR model (day step) with a
piecewise-constant
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\beta(t)</annotation></semantics></math>
and normal observation noise on daily incidence.</p>
<ul>
<li>Population:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>100</mn><mo>,</mo><mn>000</mn></mrow><annotation encoding="application/x-tex">N = 100{,}000</annotation></semantics></math>
</li>
<li>Latent period:
1/<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
= 4 days</li>
<li>Infectious period:
1/<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>
= 6 days</li>
<li>Change-points at days 40 and 80 with segment values: 0.30, 0.01,
0.40</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Helper to expand piecewise-constant beta from segment endpoints</span></span>
<span><span class="va">make_beta_t</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">beta_vec</span>, <span class="va">cp_vec</span>, <span class="va">T</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Use safety check functions</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">validate_make_beta_t_inputs</span><span class="op">(</span><span class="va">beta_vec</span>, <span class="va">cp_vec</span>, <span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu">create_safe_beta</span><span class="op">(</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Ensure change-points are within bounds and ordered</span></span>
<span>  <span class="va">ends</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cp_vec</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, <span class="cn">T</span><span class="op">)</span></span>
<span>  <span class="va">ends</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ends</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">T</span></span>
<span>  </span>
<span>  <span class="va">starts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ends</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Initialize output vector</span></span>
<span>  <span class="va">beta_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="cn">T</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Fill in segment values</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">beta_vec</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">k</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">starts</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="va">k</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ends</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">start_idx</span> <span class="op">&lt;-</span> <span class="va">starts</span><span class="op">[</span><span class="va">k</span><span class="op">]</span></span>
<span>      <span class="va">end_idx</span> <span class="op">&lt;-</span> <span class="va">ends</span><span class="op">[</span><span class="va">k</span><span class="op">]</span></span>
<span>      </span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">start_idx</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">end_idx</span><span class="op">)</span> <span class="op">&amp;&amp;</span> </span>
<span>          <span class="va">start_idx</span> <span class="op">&gt;=</span> <span class="fl">1</span> <span class="op">&amp;&amp;</span> <span class="va">end_idx</span> <span class="op">&lt;=</span> <span class="cn">T</span> <span class="op">&amp;&amp;</span> <span class="va">start_idx</span> <span class="op">&lt;=</span> <span class="va">end_idx</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">idx</span> <span class="op">&lt;-</span> <span class="va">start_idx</span><span class="op">:</span><span class="va">end_idx</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">idx</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="va">beta_t</span><span class="op">[</span><span class="va">idx</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">beta_vec</span><span class="op">[</span><span class="va">k</span><span class="op">]</span></span>
<span>        <span class="op">}</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Final safety check</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">beta_t</span><span class="op">)</span><span class="op">)</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">beta_t</span> <span class="op">&lt;=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu">create_safe_beta</span><span class="op">(</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">beta_t</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Deterministic SEIR forward solver for expected incidence</span></span>
<span><span class="va">seir_expected_incidence</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">T</span>, <span class="va">N</span>, <span class="va">beta_t</span>, <span class="va">gamma</span>, <span class="va">S0</span>, <span class="va">E0</span>, <span class="va">I0</span>, <span class="va">R0</span>, <span class="va">rho</span> <span class="op">=</span> <span class="fl">1.0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Use safety check functions</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">validate_seir_inputs</span><span class="op">(</span><span class="cn">T</span>, <span class="va">N</span>, <span class="va">beta_t</span>, <span class="va">gamma</span>, <span class="va">S0</span>, <span class="va">E0</span>, <span class="va">I0</span>, <span class="va">R0</span>, <span class="va">rho</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu">create_safe_seir_result</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Initialize arrays</span></span>
<span>  <span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="cn">T</span><span class="op">)</span>; <span class="va">E</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="cn">T</span><span class="op">)</span>; <span class="va">I</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="cn">T</span><span class="op">)</span>; <span class="va">R</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="cn">T</span><span class="op">)</span></span>
<span>  <span class="va">inc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="cn">T</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Set initial conditions</span></span>
<span>  <span class="va">S</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">S0</span><span class="op">)</span>; <span class="va">E</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">E0</span><span class="op">)</span>; <span class="va">I</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">I0</span><span class="op">)</span>; <span class="va">R</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">R0</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Forward simulation</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="cn">T</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Safety check for current state</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">S</span><span class="op">[</span><span class="va">t</span><span class="op">]</span><span class="op">)</span> <span class="op">||</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">E</span><span class="op">[</span><span class="va">t</span><span class="op">]</span><span class="op">)</span> <span class="op">||</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">I</span><span class="op">[</span><span class="va">t</span><span class="op">]</span><span class="op">)</span> <span class="op">||</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">R</span><span class="op">[</span><span class="va">t</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">S</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">S0</span><span class="op">)</span>; <span class="va">E</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">E0</span><span class="op">)</span>; <span class="va">I</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">I0</span><span class="op">)</span>; <span class="va">R</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">R0</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="co"># Calculate transmission rate</span></span>
<span>    <span class="va">lambda</span> <span class="op">&lt;-</span> <span class="va">beta_t</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">*</span> <span class="va">I</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">/</span> <span class="va">N</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span> <span class="op">||</span> <span class="va">lambda</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span> <span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>    </span>
<span>    <span class="co"># Calculate transitions</span></span>
<span>    <span class="va">new_inf</span> <span class="op">&lt;-</span> <span class="va">lambda</span> <span class="op">*</span> <span class="va">S</span><span class="op">[</span><span class="va">t</span><span class="op">]</span></span>
<span>    <span class="va">new_E_to_I</span> <span class="op">&lt;-</span> <span class="va">gamma</span> <span class="op">*</span> <span class="va">E</span><span class="op">[</span><span class="va">t</span><span class="op">]</span></span>
<span>    <span class="va">new_I_to_R</span> <span class="op">&lt;-</span> <span class="va">gamma</span> <span class="op">*</span> <span class="va">I</span><span class="op">[</span><span class="va">t</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="co"># Safety checks for transitions</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">new_inf</span><span class="op">)</span> <span class="op">||</span> <span class="va">new_inf</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span> <span class="va">new_inf</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">new_E_to_I</span><span class="op">)</span> <span class="op">||</span> <span class="va">new_E_to_I</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span> <span class="va">new_E_to_I</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">new_I_to_R</span><span class="op">)</span> <span class="op">||</span> <span class="va">new_I_to_R</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span> <span class="va">new_I_to_R</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>    </span>
<span>    <span class="co"># Record incidence</span></span>
<span>    <span class="va">inc</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">rho</span> <span class="op">*</span> <span class="va">new_inf</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">inc</span><span class="op">[</span><span class="va">t</span><span class="op">]</span><span class="op">)</span> <span class="op">||</span> <span class="va">inc</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span> <span class="va">inc</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>    </span>
<span>    <span class="co"># Update states for next time step</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">t</span> <span class="op">&lt;</span> <span class="cn">T</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">S</span><span class="op">[</span><span class="va">t</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">S</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">-</span> <span class="va">new_inf</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>      <span class="va">E</span><span class="op">[</span><span class="va">t</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">E</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">+</span> <span class="va">new_inf</span> <span class="op">-</span> <span class="va">new_E_to_I</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>      <span class="va">I</span><span class="op">[</span><span class="va">t</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">I</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">+</span> <span class="va">new_E_to_I</span> <span class="op">-</span> <span class="va">new_I_to_R</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>      <span class="va">R</span><span class="op">[</span><span class="va">t</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">R</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">+</span> <span class="va">new_I_to_R</span>, <span class="va">N</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="co"># Safety checks for next state</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">S</span><span class="op">[</span><span class="va">t</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="va">S</span><span class="op">[</span><span class="va">t</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">S0</span><span class="op">)</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">E</span><span class="op">[</span><span class="va">t</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="va">E</span><span class="op">[</span><span class="va">t</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">E0</span><span class="op">)</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">I</span><span class="op">[</span><span class="va">t</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="va">I</span><span class="op">[</span><span class="va">t</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">I0</span><span class="op">)</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">R</span><span class="op">[</span><span class="va">t</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="va">R</span><span class="op">[</span><span class="va">t</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">R0</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Final safety check for output</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span><span class="op">)</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">E</span><span class="op">)</span><span class="op">)</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">I</span><span class="op">)</span><span class="op">)</span> <span class="op">||</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span><span class="op">)</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">inc</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu">create_safe_seir_result</span><span class="op">(</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>S <span class="op">=</span> <span class="va">S</span>, E <span class="op">=</span> <span class="va">E</span>, I <span class="op">=</span> <span class="va">I</span>, R <span class="op">=</span> <span class="va">R</span>, incidence <span class="op">=</span> <span class="va">inc</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Truth</span></span>
<span><span class="va">T_days</span> <span class="op">&lt;-</span> <span class="fl">120</span></span>
<span><span class="va">N_pop</span>  <span class="op">&lt;-</span> <span class="fl">100000</span></span>
<span><span class="va">sigma</span>  <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fl">4</span></span>
<span><span class="va">gamma</span>  <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fl">6</span></span>
<span><span class="va">rho_true</span> <span class="op">&lt;-</span> <span class="fl">1.0</span></span>
<span><span class="va">beta_true_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.01</span>, <span class="fl">0.4</span><span class="op">)</span>  <span class="co"># Transmission rates between 0 and 1</span></span>
<span><span class="va">cp_true</span>        <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">80</span>, <span class="va">T_days</span><span class="op">)</span>  <span class="co"># segment endpoints (last must be T)</span></span>
<span><span class="va">beta_true_t</span>    <span class="op">&lt;-</span> <span class="fu">make_beta_t</span><span class="op">(</span><span class="va">beta_true_vals</span>, <span class="va">cp_true</span>, <span class="va">T_days</span><span class="op">)</span></span>
<span></span>
<span><span class="va">init_I</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span></span>
<span><span class="va">sim_true</span> <span class="op">&lt;-</span> <span class="fu">seir_expected_incidence</span><span class="op">(</span></span>
<span>  T <span class="op">=</span> <span class="va">T_days</span>, N <span class="op">=</span> <span class="va">N_pop</span>, beta_t <span class="op">=</span> <span class="va">beta_true_t</span>,</span>
<span>  gamma <span class="op">=</span> <span class="va">gamma</span>, S0 <span class="op">=</span> <span class="va">N_pop</span> <span class="op">-</span> <span class="va">init_I</span>, E0 <span class="op">=</span> <span class="fl">0</span>, I0 <span class="op">=</span> <span class="va">init_I</span>, R0 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  rho <span class="op">=</span> <span class="va">rho_true</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Observations: Poisson noise on expected incidence</span></span>
<span><span class="va">sigma_obs</span> <span class="op">&lt;-</span> <span class="fl">4</span>  <span class="co"># observation noise standard deviation (not used for Poisson)</span></span>
<span><span class="va">obs_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">T_days</span>, lambda <span class="op">=</span> <span class="va">sim_true</span><span class="op">$</span><span class="va">incidence</span><span class="op">)</span></span>
<span><span class="va">obs_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">obs_y</span>, <span class="fl">0</span><span class="op">)</span>  <span class="co"># ensure non-negative observations</span></span>
<span></span>
<span><span class="co"># Quick visuals</span></span>
<span><span class="va">p_obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>day <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">T_days</span>, y <span class="op">=</span> <span class="va">obs_y</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">day</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"grey80"</span>, color <span class="op">=</span> <span class="st">"grey20"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Day"</span>, y <span class="op">=</span> <span class="st">"Incidence"</span>, title <span class="op">=</span> <span class="st">"Simulated daily incidence (observed)"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>day <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">T_days</span>, beta <span class="op">=</span> <span class="va">beta_true_t</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">day</span>, <span class="va">beta</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_step</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Day"</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">beta</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span>, title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"True transmission "</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">beta</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="va">p_obs</span> <span class="op">/</span> <span class="va">p_beta</span></span></code></pre></div>
<p><img src="Ex2_seir_attack_rate_files/figure-html/simulate-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="rjmcmc-model-specification">3. RJMCMC model specification<a class="anchor" aria-label="anchor" href="#rjmcmc-model-specification"></a>
</h2>
<p>We define the model interface required by <code>rjmc_func</code>. The
<code>jump</code> matrix encodes the change-point segmentation:</p>
<ul>
<li>Row 1: segment-specific transmission rates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\beta_k</annotation></semantics></math>
in [0, 1]</li>
<li>Row 2: segment end days (in 1..T), increasing, with the last equal
to T</li>
</ul>
<p>The continuous parameter vector contains a single parameter
controlling normal observation noise:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><msup><mi>e</mi><mi>θ</mi></msup></mrow><annotation encoding="application/x-tex">\sigma = e^{\theta}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
is unconstrained.</p>
<div class="section level3">
<h3 id="theoretical-framework">3.1 Theoretical Framework<a class="anchor" aria-label="anchor" href="#theoretical-framework"></a>
</h3>
<p>This implementation follows the RJMCMC theory from Lyyjynen (2014)
§5.2 for piecewise-constant intensity functions:</p>
<ul>
<li>
<strong>Prior on number of change-points</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>∼</mo><mtext mathvariant="normal">Poisson</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>λ</mi><mi>k</mi></mrow></msup></mrow><annotation encoding="application/x-tex">k \sim \text{Poisson}(\mu) \cdot e^{-\lambda k}</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mi>K</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k = K-1</annotation></semantics></math>
(K = number of segments)
<ul>
<li>Modified to strongly prefer fewer segments with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">\mu = 0.5</annotation></semantics></math>
and penalty factor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>2.0</mn></mrow><annotation encoding="application/x-tex">\lambda = 2.0</annotation></semantics></math>
</li>
</ul>
</li>
<li>
<strong>Prior on segment heights</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mi>k</mi></msub><mo>∼</mo><mtext mathvariant="normal">Gamma</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\beta_k \sim \text{Gamma}(\alpha, \beta)</annotation></semantics></math>
</li>
<li>
<strong>Prior on observation noise</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>σ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∼</mo><mtext mathvariant="normal">Normal</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>10</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log(\sigma) \sim \text{Normal}(\log(10), 1)</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
is the standard deviation</li>
<li>
<strong>Spacing prior</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∝</mo><msubsup><mo>∏</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>s</mi><mi>j</mi></msub><mo>−</mo><msub><mi>s</mi><mrow><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(s) \propto \prod_{j=1}^{k+1} (s_j - s_{j-1})</annotation></semantics></math>
for ordered change-points</li>
<li>
<strong>Birth proposal</strong>: Split a segment at random point,
preserve weighted geometric mean of heights</li>
<li>
<strong>Death proposal</strong>: Merge adjacent segments, weighted
average of heights</li>
<li>
<strong>Acceptance ratios</strong>: Include proposal PDFs, Jacobian,
and prior ratios as per Green (1995)</li>
<li>
<strong>Likelihood</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub><mo>∼</mo><mtext mathvariant="normal">Normal</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mi>t</mi></msub><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">y_t \sim \text{Normal}(\mu_t, \sigma^2)</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\mu_t</annotation></semantics></math>
is the expected incidence from the SEIR model</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Build expected incidence given a jump matrix</span></span>
<span><span class="va">expected_incidence_from_jump</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">params</span>, <span class="va">jump</span>, <span class="va">datalist</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Use safety check functions</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">validate_rjmc_params</span><span class="op">(</span><span class="va">params</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"expected_incidence_from_jump: Expected 1 dummy parameter for Poisson model"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">validate_datalist</span><span class="op">(</span><span class="va">datalist</span><span class="op">)</span> <span class="op">||</span> <span class="op">!</span><span class="fu">validate_jump_matrix</span><span class="op">(</span><span class="va">jump</span>, <span class="va">datalist</span><span class="op">$</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">datalist</span><span class="op">$</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Extract parameters</span></span>
<span>  <span class="cn">T</span> <span class="op">&lt;-</span> <span class="va">datalist</span><span class="op">$</span><span class="cn">T</span></span>
<span>  <span class="va">S0</span> <span class="op">&lt;-</span> <span class="va">datalist</span><span class="op">$</span><span class="va">S0</span></span>
<span>  <span class="va">E0</span> <span class="op">&lt;-</span> <span class="va">datalist</span><span class="op">$</span><span class="va">E0</span></span>
<span>  <span class="va">I0</span> <span class="op">&lt;-</span> <span class="va">datalist</span><span class="op">$</span><span class="va">I0</span></span>
<span>  <span class="va">R0</span> <span class="op">&lt;-</span> <span class="va">datalist</span><span class="op">$</span><span class="va">R0</span></span>
<span>  <span class="va">gamma</span> <span class="op">&lt;-</span> <span class="va">datalist</span><span class="op">$</span><span class="va">gamma</span></span>
<span>  <span class="va">rho</span> <span class="op">&lt;-</span> <span class="va">datalist</span><span class="op">$</span><span class="va">rho</span></span>
<span>  </span>
<span>  <span class="co"># Extract beta and change-points from jump</span></span>
<span>  <span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">jump</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">cp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">jump</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Create piecewise-constant beta function</span></span>
<span>  <span class="va">beta_t</span> <span class="op">&lt;-</span> <span class="fu">make_beta_t</span><span class="op">(</span><span class="va">beta</span>, <span class="va">cp</span>, <span class="cn">T</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Solve SEIR model</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">seir_expected_incidence</span><span class="op">(</span><span class="cn">T</span>, <span class="va">datalist</span><span class="op">$</span><span class="va">N</span>, <span class="va">beta_t</span>, <span class="va">gamma</span>, <span class="va">S0</span>, <span class="va">E0</span>, <span class="va">I0</span>, <span class="va">R0</span>, <span class="va">rho</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Safety check for result</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span> <span class="op">||</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">is.list</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">incidence</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Return only the incidence vector, not the entire result object</span></span>
<span>  <span class="va">result</span><span class="op">$</span><span class="va">incidence</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Helper function to compute Jacobian for birth transformation</span></span>
<span><span class="co"># Based on thesis §5.2: J ≈ h_parent / u2^2 for the (h_j, u1, u2) -&gt; (h_L, h_R, s*) mapping</span></span>
<span><span class="va">compute_birth_jacobian</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">beta_parent</span>, <span class="va">u2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Use safety check functions</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">validate_numeric_param</span><span class="op">(</span><span class="va">beta_parent</span>, <span class="st">"beta_parent"</span>, min_val <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span> <span class="op">||</span> </span>
<span>      <span class="op">!</span><span class="fu">validate_numeric_param</span><span class="op">(</span><span class="va">u2</span>, <span class="st">"u2"</span>, min_val <span class="op">=</span> <span class="fl">0.001</span>, max_val <span class="op">=</span> <span class="fl">0.999</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">1.0</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Simplified Jacobian: J ≈ h_parent / u2^2</span></span>
<span>  <span class="va">jacobian</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">beta_parent</span> <span class="op">/</span> <span class="op">(</span><span class="va">u2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Bound the Jacobian to reasonable values</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">jacobian</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Helper function to compute Jacobian for death transformation</span></span>
<span><span class="co"># Based on thesis §5.2: J ≈ 1 for the death move (inverse of birth)</span></span>
<span><span class="va">compute_death_jacobian</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">beta_merged</span>, <span class="va">beta_old</span>, <span class="va">w_minus</span>, <span class="va">w_plus</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Use safety check functions</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">validate_numeric_param</span><span class="op">(</span><span class="va">beta_merged</span>, <span class="st">"beta_merged"</span>, min_val <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span> <span class="op">||</span></span>
<span>      <span class="op">!</span><span class="fu">validate_numeric_param</span><span class="op">(</span><span class="va">beta_old</span>, <span class="st">"beta_old"</span>, min_val <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span> <span class="op">||</span></span>
<span>      <span class="op">!</span><span class="fu">validate_numeric_param</span><span class="op">(</span><span class="va">w_minus</span>, <span class="st">"w_minus"</span>, min_val <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span> <span class="op">||</span></span>
<span>      <span class="op">!</span><span class="fu">validate_numeric_param</span><span class="op">(</span><span class="va">w_plus</span>, <span class="st">"w_plus"</span>, min_val <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">1.0</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># For death moves, the Jacobian is approximately 1</span></span>
<span>  <span class="fl">1.0</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Helper function for proposal probabilities (to avoid circular references)</span></span>
<span><span class="va">sampleProposal_internal</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">params</span>, <span class="va">jump</span>, <span class="va">datalist</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Use safety check functions</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">validate_rjmc_params</span><span class="op">(</span><span class="va">params</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">||</span> <span class="op">!</span><span class="fu">validate_jump_matrix</span><span class="op">(</span><span class="va">jump</span>, <span class="va">datalist</span><span class="op">$</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.33</span>, <span class="fl">0.33</span>, <span class="fl">1.0</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Based on thesis §5.2: birth/death probabilities derived from Poisson prior</span></span>
<span>  <span class="va">K</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">jump</span><span class="op">)</span></span>
<span>  <span class="va">k</span> <span class="op">&lt;-</span> <span class="va">K</span> <span class="op">-</span> <span class="fl">1</span>  <span class="co"># number of change-points</span></span>
<span>  </span>
<span>  <span class="co"># Prior parameters</span></span>
<span>  <span class="va">mu_prior</span> <span class="op">&lt;-</span> <span class="fl">2.5</span>  <span class="co"># Poisson prior mean for number of change-points</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">K</span> <span class="op">&lt;=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.0</span>, <span class="fl">1.0</span><span class="op">)</span><span class="op">)</span>  <span class="co"># only birth and within-model moves</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">K</span> <span class="op">&gt;=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.0</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span><span class="op">)</span><span class="op">)</span>  <span class="co"># only death and within-model moves</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="co"># Compute birth/death probabilities based on Poisson prior ratios</span></span>
<span>    <span class="va">bk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">0.6</span> <span class="op">*</span> <span class="va">mu_prior</span> <span class="op">/</span> <span class="op">(</span><span class="va">k</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>, <span class="fl">0.6</span><span class="op">)</span></span>
<span>    <span class="va">dk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">0.6</span> <span class="op">*</span> <span class="va">k</span> <span class="op">/</span> <span class="va">mu_prior</span>, <span class="fl">0.6</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Ensure probabilities are finite and non-negative</span></span>
<span>    <span class="va">bk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">0.0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">bk</span>, <span class="fl">0.6</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">dk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">0.0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">dk</span>, <span class="fl">0.6</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Ensure probabilities sum to at most 0.9</span></span>
<span>    <span class="va">total</span> <span class="op">&lt;-</span> <span class="va">bk</span> <span class="op">+</span> <span class="va">dk</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">total</span> <span class="op">&gt;</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">scale_factor</span> <span class="op">&lt;-</span> <span class="fl">0.9</span> <span class="op">/</span> <span class="va">total</span></span>
<span>      <span class="va">bk</span> <span class="op">&lt;-</span> <span class="va">bk</span> <span class="op">*</span> <span class="va">scale_factor</span></span>
<span>      <span class="va">dk</span> <span class="op">&lt;-</span> <span class="va">dk</span> <span class="op">*</span> <span class="va">scale_factor</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">bk</span>, <span class="va">dk</span>, <span class="fl">1.0</span><span class="op">)</span>  <span class="co"># birth, death, within-model</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># RJMCMC model list</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  lowerParSupport_fitted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span><span class="op">)</span>,  <span class="co"># Dummy parameter bounds</span></span>
<span>  upperParSupport_fitted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>,</span>
<span>  namesOfParameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dummy"</span><span class="op">)</span>,  <span class="co"># Dummy parameter name</span></span>
<span></span>
<span>  sampleInitPrior <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">datalist</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># For Poisson model, we need a dummy parameter for internal RJMCMC machinery</span></span>
<span>    <span class="co"># Initialize dummy parameter around 0</span></span>
<span>    <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Use safety check functions</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">validate_numeric_param</span><span class="op">(</span><span class="va">result</span>, <span class="st">"result"</span>, allow_null <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>  <span class="co"># Return safe default if generation failed</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="va">result</span></span>
<span>  <span class="op">}</span>,</span>
<span></span>
<span>  sampleInitJump <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">params</span>, <span class="va">datalist</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Use safety check functions</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">validate_rjmc_params</span><span class="op">(</span><span class="va">params</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">||</span> <span class="op">!</span><span class="fu">validate_datalist</span><span class="op">(</span><span class="va">datalist</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu">create_safe_jump</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="cn">T</span> <span class="op">&lt;-</span> <span class="va">datalist</span><span class="op">$</span><span class="cn">T</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">validate_numeric_param</span><span class="op">(</span><span class="cn">T</span>, <span class="st">"T"</span>, min_val <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu">create_safe_jump</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="co"># SIMPLIFIED: Start with exactly 2 segments for stability</span></span>
<span>    <span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Initialization: K ="</span>, <span class="va">K</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Create 2 segments with reasonable beta values</span></span>
<span>    <span class="va">betas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">K</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span><span class="op">)</span>  <span class="co"># Reasonable beta values</span></span>
<span>    </span>
<span>    <span class="co"># Place change-point at 1/3 of time range (more balanced than middle)</span></span>
<span>    <span class="co"># This avoids clustering at the start and gives more reasonable segment sizes</span></span>
<span>    <span class="va">cps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="cn">T</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>, <span class="cn">T</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Safety check for generated values</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">betas</span><span class="op">)</span><span class="op">)</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">cps</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu">create_safe_jump</span><span class="op">(</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="co"># Ensure change-points are valid and ordered</span></span>
<span>    <span class="va">cps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">cps</span><span class="op">)</span></span>
<span>    <span class="va">cps</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cps</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">T</span>  <span class="co"># Ensure last change-point is exactly T</span></span>
<span>    </span>
<span>    <span class="co"># Final safety check</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">cps</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">cps</span> <span class="op">&gt;</span> <span class="cn">T</span><span class="op">)</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">betas</span> <span class="op">&lt;=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu">create_safe_jump</span><span class="op">(</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">betas</span>, <span class="va">cps</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Final matrix check</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span><span class="op">)</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span> <span class="op">!=</span> <span class="va">K</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu">create_safe_jump</span><span class="op">(</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="va">result</span></span>
<span>  <span class="op">}</span>,</span>
<span></span>
<span>  evaluateLogPrior <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">params</span>, <span class="va">jump</span>, <span class="va">datalist</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Use safety check functions</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">validate_rjmc_params</span><span class="op">(</span><span class="va">params</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"evaluateLogPrior: Expected 1 dummy parameter for Poisson model"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="co"># Start with zero log prior (flat prior on dummy parameter)</span></span>
<span>    <span class="va">lp</span> <span class="op">&lt;-</span> <span class="fl">0.0</span></span>
<span>    </span>
<span>    <span class="co"># Safety check for jump</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">validate_jump_matrix</span><span class="op">(</span><span class="va">jump</span>, <span class="va">datalist</span><span class="op">$</span><span class="cn">T</span>, min_segments <span class="op">=</span> <span class="fl">1</span>, max_segments <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="co"># Number of change-points: k ~ Poisson(μ) where k = K-1</span></span>
<span>    <span class="va">K</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">jump</span><span class="op">)</span></span>
<span>    <span class="va">k</span> <span class="op">&lt;-</span> <span class="va">K</span> <span class="op">-</span> <span class="fl">1</span>  <span class="co"># number of change-points (excluding boundaries)</span></span>
<span>    </span>
<span>    <span class="co"># Prior that allows reasonable number of change points</span></span>
<span>    <span class="va">mu_prior</span> <span class="op">&lt;-</span> <span class="fl">3</span>  <span class="co"># prior mean for number of change-points</span></span>
<span>    </span>
<span>    <span class="co"># Simple Poisson prior without additional penalty</span></span>
<span>    <span class="va">lp</span> <span class="op">&lt;-</span> <span class="va">lp</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">dpois</a></span><span class="op">(</span><span class="va">k</span>, lambda <span class="op">=</span> <span class="va">mu_prior</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Safety check for Poisson prior</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">lp</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Segment heights (betas): ~ Gamma(α,β) instead of uniform</span></span>
<span>    <span class="va">beta_vec</span> <span class="op">&lt;-</span> <span class="va">jump</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span></span>
<span>    <span class="va">alpha_prior</span> <span class="op">&lt;-</span> <span class="fl">2.0</span>  <span class="co"># shape parameter</span></span>
<span>    <span class="va">beta_prior</span> <span class="op">&lt;-</span> <span class="fl">5.0</span>   <span class="co"># rate parameter (mean = α/β = 2.0/5.0 = 0.4)</span></span>
<span>    <span class="va">lp</span> <span class="op">&lt;-</span> <span class="va">lp</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">beta_vec</span>, shape <span class="op">=</span> <span class="va">alpha_prior</span>, rate <span class="op">=</span> <span class="va">beta_prior</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Safety check for Gamma prior</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">lp</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Change-points: ordered spacing prior</span></span>
<span>    <span class="cn">T</span> <span class="op">&lt;-</span> <span class="va">datalist</span><span class="op">$</span><span class="cn">T</span></span>
<span>    <span class="va">cp_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">jump</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Spacing prior: log(prod(widths)) from thesis (5.33)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cp_vec</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">starts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cp_vec</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="va">widths</span> <span class="op">&lt;-</span> <span class="va">cp_vec</span> <span class="op">-</span> <span class="va">starts</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">widths</span> <span class="op">&lt;=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span><span class="op">)</span>  <span class="co"># Safety check for widths</span></span>
<span>      <span class="va">lp</span> <span class="op">&lt;-</span> <span class="va">lp</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">widths</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="co"># Final safety check</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">lp</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Debug output for extreme values</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">lp</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">1e6</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"WARNING: Very low prior:"</span>, <span class="va">lp</span>, <span class="st">"K ="</span>, <span class="va">K</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="va">lp</span></span>
<span>  <span class="op">}</span>,</span>
<span></span>
<span>  evaluateLogLikelihood <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">params</span>, <span class="va">jump</span>, <span class="va">datalist</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">y</span>   <span class="op">&lt;-</span> <span class="va">datalist</span><span class="op">$</span><span class="va">y</span></span>
<span>    <span class="cn">T</span>   <span class="op">&lt;-</span> <span class="va">datalist</span><span class="op">$</span><span class="cn">T</span></span>
<span>    </span>
<span>    <span class="co"># Use safety check functions</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">validate_rjmc_params</span><span class="op">(</span><span class="va">params</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"evaluateLogLikelihood: Expected 1 dummy parameter for Poisson model"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="va">mu_t</span> <span class="op">&lt;-</span> <span class="fu">expected_incidence_from_jump</span><span class="op">(</span><span class="va">params</span>, <span class="va">jump</span>, <span class="va">datalist</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Safety checks for expected incidence</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">mu_t</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">mu_t</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">mu_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">mu_t</span>, <span class="fl">1e-6</span><span class="op">)</span>  <span class="co"># ensure positive expected values</span></span>
<span></span>
<span>    <span class="co"># Poisson likelihood for counts: y_t ~ Poisson(mu_t)</span></span>
<span>    <span class="va">log_lik</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">dpois</a></span><span class="op">(</span><span class="va">y</span>, lambda <span class="op">=</span> <span class="va">mu_t</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">log_lik</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Simple dimension penalty (much smaller)</span></span>
<span>    <span class="va">K</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">jump</span><span class="op">)</span></span>
<span>    <span class="va">penalty_term</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">K</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.1</span>  <span class="co"># Small penalty for complexity</span></span>
<span></span>
<span>    <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">log_lik</span><span class="op">)</span> <span class="op">-</span> <span class="va">penalty_term</span></span>
<span>    </span>
<span>    <span class="co"># Debug output for extreme values</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">result</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">1e6</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"WARNING: Very low likelihood:"</span>, <span class="va">result</span>, <span class="st">"K ="</span>, <span class="va">K</span>, <span class="st">"sum(log_lik) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">log_lik</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="va">result</span></span>
<span>  <span class="op">}</span>,</span>
<span></span>
<span>  sampleBirthProposal <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">params</span>, <span class="va">jump</span>, <span class="va">i_idx</span>, <span class="va">datalist</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Use simple birth function that's more robust</span></span>
<span>    <span class="fu">simpleBirthProposal</span><span class="op">(</span><span class="va">params</span>, <span class="va">jump</span>, <span class="va">i_idx</span>, <span class="va">datalist</span><span class="op">)</span></span>
<span>  <span class="op">}</span>,</span>
<span>  </span>
<span>  sampleDeathProposal <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">params</span>, <span class="va">jump</span>, <span class="va">i_idx</span>, <span class="va">datalist</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Use simple death function that's more robust</span></span>
<span>    <span class="fu">simpleDeathProposal</span><span class="op">(</span><span class="va">params</span>, <span class="va">jump</span>, <span class="va">i_idx</span>, <span class="va">datalist</span><span class="op">)</span></span>
<span>  <span class="op">}</span>,</span>
<span></span>
<span>  evaluateBirthProposal <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">params</span>, <span class="va">jump</span>, <span class="va">i_idx</span>, <span class="va">datalist</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Use safety check functions</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">validate_rjmc_params</span><span class="op">(</span><span class="va">params</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">||</span> <span class="op">!</span><span class="fu">validate_jump_matrix</span><span class="op">(</span><span class="va">jump</span>, <span class="va">datalist</span><span class="op">$</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="co"># Based on thesis §5.2: birth acceptance ratio with proper proposal PDFs</span></span>
<span>    <span class="cn">T</span> <span class="op">&lt;-</span> <span class="va">datalist</span><span class="op">$</span><span class="cn">T</span></span>
<span>    <span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">jump</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">cp</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">jump</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">K</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Get current birth/death probabilities</span></span>
<span>    <span class="va">move_probs</span> <span class="op">&lt;-</span> <span class="fu">sampleProposal_internal</span><span class="op">(</span><span class="va">params</span>, <span class="va">jump</span>, <span class="va">datalist</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Safety check for move_probs</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">move_probs</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">2</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">move_probs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="va">bk</span> <span class="op">&lt;-</span> <span class="va">move_probs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>  <span class="co"># birth probability</span></span>
<span>    <span class="va">dk1</span> <span class="op">&lt;-</span> <span class="va">move_probs</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="co"># death probability in new state (k+1)</span></span>
<span>    </span>
<span>    <span class="co"># Safety check for probabilities</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">bk</span> <span class="op">&lt;=</span> <span class="fl">0</span> <span class="op">||</span> <span class="va">dk1</span> <span class="op">&lt;=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="co"># Proposal ratio: log(d_{k+1} * L / (b_k * (k+1))) from thesis (5.50)</span></span>
<span>    <span class="va">log_prop_ratio</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">dk1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="cn">T</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">bk</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">K</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Safety check for final result</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">log_prop_ratio</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="va">log_prop_ratio</span></span>
<span>  <span class="op">}</span>,</span>
<span></span>
<span>  evaluateDeathProposal <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">params</span>, <span class="va">jump</span>, <span class="va">i_idx</span>, <span class="va">datalist</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Use safety check functions</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">validate_rjmc_params</span><span class="op">(</span><span class="va">params</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">||</span> <span class="op">!</span><span class="fu">validate_jump_matrix</span><span class="op">(</span><span class="va">jump</span>, <span class="va">datalist</span><span class="op">$</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="co"># Based on thesis §5.2: death acceptance ratio with proper proposal PDFs</span></span>
<span>    <span class="cn">T</span> <span class="op">&lt;-</span> <span class="va">datalist</span><span class="op">$</span><span class="cn">T</span></span>
<span>    <span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">jump</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">cp</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">jump</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">K</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">K</span> <span class="op">&lt;=</span> <span class="fl">1</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># For death, the proposal ratio is the inverse of birth</span></span>
<span>    <span class="co"># From thesis (5.55): log(b_{k-1} * k / (d_k * L))</span></span>
<span>    </span>
<span>    <span class="co"># Get current birth/death probabilities</span></span>
<span>    <span class="va">move_probs</span> <span class="op">&lt;-</span> <span class="fu">sampleProposal_internal</span><span class="op">(</span><span class="va">params</span>, <span class="va">jump</span>, <span class="va">datalist</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Safety check for move_probs</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">move_probs</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">2</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">move_probs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="va">dk</span> <span class="op">&lt;-</span> <span class="va">move_probs</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>      <span class="co"># death probability in current state</span></span>
<span>    <span class="va">bk_minus1</span> <span class="op">&lt;-</span> <span class="va">move_probs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="co"># birth probability in new state (k-1)</span></span>
<span>    </span>
<span>    <span class="co"># Proposal ratio: log(b_{k-1} * k / (d_k * L))</span></span>
<span>    <span class="va">log_prop_ratio</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">bk_minus1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">K</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">dk</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="cn">T</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Safety check for final result</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">log_prop_ratio</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="va">log_prop_ratio</span></span>
<span>  <span class="op">}</span>,</span>
<span></span>
<span>  sampleJump <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">params</span>, <span class="va">jump</span>, <span class="va">i_idx</span>, <span class="va">datalist</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Use simple height update function that's more robust</span></span>
<span>    <span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">alpha</span> <span class="op">&lt;</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">jump</span> <span class="op">&lt;-</span> <span class="fu">simpleHeightUpdate</span><span class="op">(</span><span class="va">params</span>, <span class="va">jump</span>, <span class="va">i_idx</span>, <span class="va">datalist</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">alpha</span> <span class="op">&lt;</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">jump</span> <span class="op">&lt;-</span> <span class="fu">simpleChangePointUpdate</span><span class="op">(</span><span class="va">params</span>, <span class="va">jump</span>, <span class="va">i_idx</span>, <span class="va">datalist</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">jump</span></span>
<span>  <span class="op">}</span>,</span>
<span>  </span>
<span></span>
<span>  sampleProposal <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">params</span>, <span class="va">jump</span>, <span class="va">datalist</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Simple, balanced proposal probabilities</span></span>
<span>    <span class="va">K</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">jump</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">K</span> <span class="op">&lt;=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="co"># Can't have fewer than 1 segment - only birth and within-model</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.0</span>, <span class="fl">0.6</span><span class="op">)</span><span class="op">)</span>  <span class="co"># birth, death, within-model</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">K</span> <span class="op">&gt;=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="co"># Can't have more than 20 segments - only death and within-model</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.0</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span><span class="op">)</span><span class="op">)</span>  <span class="co"># birth, death, within-model</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="co"># Balanced probabilities for intermediate K values</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span>  <span class="co"># birth, death, within-model</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="settings-data-and-run">4. Settings, data, and run<a class="anchor" aria-label="anchor" href="#settings-data-and-run"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">settings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  numberCores <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  numberChainRuns <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  iterations <span class="op">=</span> <span class="fl">40000</span>,  <span class="co"># Increased from 10000 to allow more exploration</span></span>
<span>  burninPosterior <span class="op">=</span> <span class="fl">20000</span>,  <span class="co"># Increased from 5000 to allow proper burn-in</span></span>
<span>  thin <span class="op">=</span> <span class="fl">10</span>,  <span class="co"># Increased from 1 to reduce autocorrelation</span></span>
<span>  runParallel <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="va">obs_y</span>,</span>
<span>  N_data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">obs_y</span><span class="op">)</span>,</span>
<span>  T <span class="op">=</span> <span class="va">T_days</span>,</span>
<span>  N <span class="op">=</span> <span class="va">N_pop</span>,</span>
<span>  gamma <span class="op">=</span> <span class="va">gamma</span>,</span>
<span>  S0 <span class="op">=</span> <span class="va">N_pop</span> <span class="op">-</span> <span class="va">init_I</span>,</span>
<span>  E0 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  I0 <span class="op">=</span> <span class="va">init_I</span>,</span>
<span>  R0 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  rho <span class="op">=</span> <span class="va">rho_true</span> <span class="co"># 1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">outputs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rjmc_func.html">rjmc_func</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">data_l</span>, <span class="va">settings</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## `consoleUpdates` not specified in settings. Default value 100. </span></span>
<span><span class="co">## `numberFittedPar` not specified in settings. Default value equal to the number of parameters in the model  1 . </span></span>
<span><span class="co">## `onAdaptiveCov` not specified in settings. Default value TRUE. </span></span>
<span><span class="co">## `updatesAdaptiveCov` not specified in settings. Default value 100. </span></span>
<span><span class="co">## `burninAdaptiveCov` not specified in settings. Default value 2000. </span></span>
<span><span class="co">## `onAdaptiveTemp` not specified in settings.  Default value TRUE. </span></span>
<span><span class="co">## `updatesAdaptiveTemp` not specified in settings.  Default value 10. </span></span>
<span><span class="co">## `lowerParBounds` not specified in settings. Defaults to lowerParSupport_fitted. </span></span>
<span><span class="co">## `upperParBounds` not specified in settings. Defaults to upperParSupport_fitted </span></span>
<span><span class="co">## `covarInitVal` not specified in settings.  Default value 1e-10. </span></span>
<span><span class="co">## `covarInitValAdapt` not specified in settings.  Default value 1e-10. </span></span>
<span><span class="co">## `covarMaxVal` not specified in settings. Default value 1. </span></span>
<span><span class="co">## Initialization: K = 2 </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 0 of 40000. Chain number 1. Current logpost: Initialization: K = -10091. Length of jump: 2.          2 </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 0 of 40000. Chain number 2. Current logpost: -18642.6. Length of jump: 2.          Initialization: K = 2 </span></span>
<span><span class="co">## Initialization: K = 2 </span></span>
<span><span class="co">## Running MCMC-PT iteration number: 0 of 40000. Chain number 3. Current logpost: -53261.5. Length of jump: 1.          Cannot merge: only 1 segment</span></span>
<span><span class="co">## Cannot merge: only 1 segment</span></span>
<span><span class="co">## Running MCMC-PT iteration number: 0 of 40000. Chain number 4. Current logpost: -11111.3. Length of jump: 2.          Cannot merge: only 1 segment</span></span>
<span><span class="co">## Cannot merge: only 1 segment</span></span>
<span><span class="co">## Cannot merge: only 1 segment</span></span>
<span><span class="co">## Cannot merge: only 1 segment</span></span>
<span><span class="co">## Cannot merge: only 1 segment</span></span>
<span><span class="co">## Cannot merge: only 1 segment</span></span>
<span><span class="co">## Cannot merge: only 1 segment</span></span>
<span><span class="co">## Cannot merge: only 1 segment</span></span>
<span><span class="co">## Cannot merge: only 1 segment</span></span>
<span><span class="co">## Cannot merge: only 1 segment</span></span>
<span><span class="co">## Cannot merge: only 1 segment</span></span>
<span><span class="co">## Cannot merge: only 1 segment</span></span>
<span><span class="co">## Cannot merge: only 1 segment</span></span>
<span><span class="co">## Cannot merge: only 1 segment</span></span>
<span><span class="co">## Running MCMC-PT iteration number: 100 of 40000. Chain number 1. Current logpost: -4083.09. Length of jump: 5.          Running MCMC-PT iteration number: 100 of 40000. Chain number 2. Current logpost: -7322.51. Length of jump: 2.          Running MCMC-PT iteration number: 100 of 40000. Chain number 3. Current logpost: -51707.7. Length of jump: 3.          Running MCMC-PT iteration number: 100 of 40000. Chain number 4. Current logpost: -3105.69. Length of jump: 3.          Running MCMC-PT iteration number: 200 of 40000. Chain number 3. Current logpost: -49096.2. Length of jump: 2.          Running MCMC-PT iteration number: 200 of 40000. Chain number 2. Current logpost: -5837.95. Length of jump: 2.          Running MCMC-PT iteration number: 200 of 40000. Chain number 1. Current logpost: -1394.41. Length of jump: 4.          Running MCMC-PT iteration number: 200 of 40000. Chain number 4. Current logpost: -2078.78. Length of jump: 3.          Running MCMC-PT iteration number: 300 of 40000. Chain number 3. Current logpost: -10850.6. Length of jump: 4.          Running MCMC-PT iteration number: 300 of 40000. Chain number 1. Current logpost: -687.398. Length of jump: 4.          Running MCMC-PT iteration number: 300 of 40000. Chain number 2. Current logpost: -5836.48. Length of jump: 2.          Running MCMC-PT iteration number: 300 of 40000. Chain number 4. Current logpost: -892.968. Length of jump: 3.          Running MCMC-PT iteration number: 400 of 40000. Chain number 3. Current logpost: -7394.29. Length of jump: 3.          Running MCMC-PT iteration number: 400 of 40000. Chain number 1. Current logpost: -514.767. Length of jump: 4.          Running MCMC-PT iteration number: 400 of 40000. Chain number 2. Current logpost: -1725.09. Length of jump: 3.          Running MCMC-PT iteration number: 400 of 40000. Chain number 4. Current logpost: -395.868. Length of jump: 4.          Running MCMC-PT iteration number: 500 of 40000. Chain number 3. Current logpost: -4295.91. Length of jump: 3.          Running MCMC-PT iteration number: 500 of 40000. Chain number 1. Current logpost: -503.756. Length of jump: 4.          Running MCMC-PT iteration number: 500 of 40000. Chain number 2. Current logpost: -1482.93. Length of jump: 3.          Running MCMC-PT iteration number: 500 of 40000. Chain number 4. Current logpost: -364.812. Length of jump: 6.          Running MCMC-PT iteration number: 600 of 40000. Chain number 3. Current logpost: -1129.34. Length of jump: 3.          Running MCMC-PT iteration number: 600 of 40000. Chain number 1. Current logpost: -464.832. Length of jump: 5.          Running MCMC-PT iteration number: 600 of 40000. Chain number 2. Current logpost: -1225. Length of jump: 4.          Running MCMC-PT iteration number: 600 of 40000. Chain number 4. Current logpost: -364.536. Length of jump: 5.          Running MCMC-PT iteration number: 700 of 40000. Chain number 3. Current logpost: -982.397. Length of jump: 4.          Running MCMC-PT iteration number: 700 of 40000. Chain number 1. Current logpost: -447.719. Length of jump: 5.          Running MCMC-PT iteration number: 700 of 40000. Chain number 2. Current logpost: -1164.49. Length of jump: 4.          Running MCMC-PT iteration number: 700 of 40000. Chain number 4. Current logpost: -364.677. Length of jump: 6.          Running MCMC-PT iteration number: 800 of 40000. Chain number 1. Current logpost: -418.176. Length of jump: 8.          Running MCMC-PT iteration number: 800 of 40000. Chain number 2. Current logpost: -878.93. Length of jump: 4.          Running MCMC-PT iteration number: 800 of 40000. Chain number 4. Current logpost: -366.398. Length of jump: 5.          Running MCMC-PT iteration number: 900 of 40000. Chain number 3. Current logpost: -709.276. Length of jump: 5.          Running MCMC-PT iteration number: 900 of 40000. Chain number 2. Current logpost: -553.231. Length of jump: 5.          Running MCMC-PT iteration number: 900 of 40000. Chain number 1. Current logpost: -375.157. Length of jump: 7.          Running MCMC-PT iteration number: 900 of 40000. Chain number 4. Current logpost: -367.084. Length of jump: 6.          Running MCMC-PT iteration number: 1000 of 40000. Chain number 3. Current logpost: -661.777. Length of jump: 6.          Running MCMC-PT iteration number: 1000 of 40000. Chain number 2. Current logpost: -495.038. Length of jump: 6.          Running MCMC-PT iteration number: 1000 of 40000. Chain number 1. Current logpost: -375.898. Length of jump: 8.          Running MCMC-PT iteration number: 1000 of 40000. Chain number 4. Current logpost: -364.851. Length of jump: 5.          Running MCMC-PT iteration number: 1100 of 40000. Chain number 3. Current logpost: -557.832. Length of jump: 6.          Running MCMC-PT iteration number: 1100 of 40000. Chain number 2. Current logpost: -462.824. Length of jump: 5.          Running MCMC-PT iteration number: 1100 of 40000. Chain number 1. Current logpost: -373.322. Length of jump: 7.          Running MCMC-PT iteration number: 1100 of 40000. Chain number 4. Current logpost: -363.831. Length of jump: 5.          Running MCMC-PT iteration number: 1200 of 40000. Chain number 3. Current logpost: -434.077. Length of jump: 5.          Running MCMC-PT iteration number: 1200 of 40000. Chain number 2. Current logpost: -426.798. Length of jump: 6.          Running MCMC-PT iteration number: 1200 of 40000. Chain number 1. Current logpost: -372.96. Length of jump: 7.          Running MCMC-PT iteration number: 1200 of 40000. Chain number 4. Current logpost: -363.63. Length of jump: 5.          Running MCMC-PT iteration number: 1300 of 40000. Chain number 3. Current logpost: -422.096. Length of jump: 5.          Running MCMC-PT iteration number: 1300 of 40000. Chain number 2. Current logpost: -420.202. Length of jump: 6.          Running MCMC-PT iteration number: 1300 of 40000. Chain number 1. Current logpost: -371.776. Length of jump: 7.          Running MCMC-PT iteration number: 1300 of 40000. Chain number 4. Current logpost: -364.205. Length of jump: 6.          Running MCMC-PT iteration number: 1400 of 40000. Chain number 1. Current logpost: -371.591. Length of jump: 7.          Running MCMC-PT iteration number: 1400 of 40000. Chain number 4. Current logpost: -363.83. Length of jump: 6.          Running MCMC-PT iteration number: 1500 of 40000. Chain number 3. Current logpost: -406.889. Length of jump: 6.          Running MCMC-PT iteration number: 1500 of 40000. Chain number 2. Current logpost: -415.536. Length of jump: 6.          Running MCMC-PT iteration number: 1500 of 40000. Chain number 1. Current logpost: -371.562. Length of jump: 7.          Running MCMC-PT iteration number: 1500 of 40000. Chain number 4. Current logpost: -363.228. Length of jump: 5.          Running MCMC-PT iteration number: 1600 of 40000. Chain number 3. Current logpost: -404.362. Length of jump: 6.          Running MCMC-PT iteration number: 1600 of 40000. Chain number 1. Current logpost: -371.817. Length of jump: 7.          Running MCMC-PT iteration number: 1600 of 40000. Chain number 2. Current logpost: -417.021. Length of jump: 6.          Running MCMC-PT iteration number: 1600 of 40000. Chain number 4. Current logpost: -363.825. Length of jump: 5.          Running MCMC-PT iteration number: 1700 of 40000. Chain number 3. Current logpost: -402.927. Length of jump: 6.          Running MCMC-PT iteration number: 1700 of 40000. Chain number 1. Current logpost: -371.045. Length of jump: 7.          Running MCMC-PT iteration number: 1700 of 40000. Chain number 2. Current logpost: -408.976. Length of jump: 6.          Running MCMC-PT iteration number: 1700 of 40000. Chain number 4. Current logpost: -364.831. Length of jump: 5.          Running MCMC-PT iteration number: 1800 of 40000. Chain number 3. Current logpost: -389.195. Length of jump: 7.          Running MCMC-PT iteration number: 1800 of 40000. Chain number 1. Current logpost: -369.302. Length of jump: 6.          Running MCMC-PT iteration number: 1800 of 40000. Chain number 2. Current logpost: -407.719. Length of jump: 6.          Running MCMC-PT iteration number: 1800 of 40000. Chain number 4. Current logpost: -364.445. Length of jump: 5.          Running MCMC-PT iteration number: 1900 of 40000. Chain number 3. Current logpost: -386.655. Length of jump: 7.          Running MCMC-PT iteration number: 1900 of 40000. Chain number 1. Current logpost: -361.775. Length of jump: 6.          Running MCMC-PT iteration number: 1900 of 40000. Chain number 2. Current logpost: -400.678. Length of jump: 6.          Running MCMC-PT iteration number: 1900 of 40000. Chain number 4. Current logpost: -365.811. Length of jump: 5.          Running MCMC-PT iteration number: 2000 of 40000. Chain number 3. Current logpost: -386.31. Length of jump: 7.          Running MCMC-PT iteration number: 2000 of 40000. Chain number 1. Current logpost: -364.36. Length of jump: 6.          Running MCMC-PT iteration number: 2000 of 40000. Chain number 2. Current logpost: -404.204. Length of jump: 6.          Running MCMC-PT iteration number: 2000 of 40000. Chain number 4. Current logpost: -366.628. Length of jump: 6.          Running MCMC-PT iteration number: 2100 of 40000. Chain number 3. Current logpost: -389.093. Length of jump: 7.          Running MCMC-PT iteration number: 2100 of 40000. Chain number 1. Current logpost: -361.512. Length of jump: 6.          Running MCMC-PT iteration number: 2100 of 40000. Chain number 2. Current logpost: -397.119. Length of jump: 6.          Running MCMC-PT iteration number: 2100 of 40000. Chain number 4. Current logpost: -364.833. Length of jump: 6.          Running MCMC-PT iteration number: 2200 of 40000. Chain number 3. Current logpost: -376.006. Length of jump: 6.          Running MCMC-PT iteration number: 2200 of 40000. Chain number 1. Current logpost: -361.904. Length of jump: 5.          Running MCMC-PT iteration number: 2200 of 40000. Chain number 2. Current logpost: -391.248. Length of jump: 8.          Running MCMC-PT iteration number: 2200 of 40000. Chain number 4. Current logpost: -364.369. Length of jump: 6.          Running MCMC-PT iteration number: 2300 of 40000. Chain number 3. Current logpost: -370.784. Length of jump: 7.          Running MCMC-PT iteration number: 2300 of 40000. Chain number 1. Current logpost: -360.51. Length of jump: 4.          Running MCMC-PT iteration number: 2300 of 40000. Chain number 2. Current logpost: -389.819. Length of jump: 7.          Running MCMC-PT iteration number: 2300 of 40000. Chain number 4. Current logpost: -363.922. Length of jump: 6.          Running MCMC-PT iteration number: 2400 of 40000. Chain number 3. Current logpost: -365.401. Length of jump: 6.          Running MCMC-PT iteration number: 2400 of 40000. Chain number 1. Current logpost: -360.54. Length of jump: 4.          Running MCMC-PT iteration number: 2400 of 40000. Chain number 2. Current logpost: -388.246. Length of jump: 8.          Running MCMC-PT iteration number: 2400 of 40000. Chain number 4. Current logpost: -364.791. Length of jump: 6.          Running MCMC-PT iteration number: 2500 of 40000. Chain number 3. Current logpost: -364.808. Length of jump: 7.          Running MCMC-PT iteration number: 2500 of 40000. Chain number 1. Current logpost: -365.454. Length of jump: 4.          Running MCMC-PT iteration number: 2500 of 40000. Chain number 2. Current logpost: -390.383. Length of jump: 9.          Running MCMC-PT iteration number: 2500 of 40000. Chain number 4. Current logpost: -366.789. Length of jump: 7.          Running MCMC-PT iteration number: 2600 of 40000. Chain number 3. Current logpost: -364.768. Length of jump: 6.          Running MCMC-PT iteration number: 2600 of 40000. Chain number 1. Current logpost: -362.545. Length of jump: 4.          Running MCMC-PT iteration number: 2600 of 40000. Chain number 2. Current logpost: -390.086. Length of jump: 9.          Running MCMC-PT iteration number: 2600 of 40000. Chain number 4. Current logpost: -366.505. Length of jump: 7.          Running MCMC-PT iteration number: 2700 of 40000. Chain number 3. Current logpost: -362.837. Length of jump: 7.          Running MCMC-PT iteration number: 2700 of 40000. Chain number 1. Current logpost: -362.35. Length of jump: 4.          Running MCMC-PT iteration number: 2700 of 40000. Chain number 2. Current logpost: -387.217. Length of jump: 9.          Running MCMC-PT iteration number: 2700 of 40000. Chain number 4. Current logpost: -365.755. Length of jump: 7.          Running MCMC-PT iteration number: 2800 of 40000. Chain number 3. Current logpost: -364.101. Length of jump: 5.          Running MCMC-PT iteration number: 2800 of 40000. Chain number 1. Current logpost: -363.199. Length of jump: 4.          Running MCMC-PT iteration number: 2800 of 40000. Chain number 2. Current logpost: -374.879. Length of jump: 9.          Running MCMC-PT iteration number: 2800 of 40000. Chain number 4. Current logpost: -364.455. Length of jump: 6.          Running MCMC-PT iteration number: 2900 of 40000. Chain number 3. Current logpost: -362.654. Length of jump: 5.          Running MCMC-PT iteration number: 2900 of 40000. Chain number 1. Current logpost: -365.052. Length of jump: 5.          Running MCMC-PT iteration number: 2900 of 40000. Chain number 4. Current logpost: -364.218. Length of jump: 6.          Running MCMC-PT iteration number: 3000 of 40000. Chain number 4. Current logpost: -362.381. Length of jump: 7.          Running MCMC-PT iteration number: 3000 of 40000. Chain number 2. Current logpost: -369.895. Length of jump: 9.          Running MCMC-PT iteration number: 3100 of 40000. Chain number 3. Current logpost: -361.499. Length of jump: 4.          Running MCMC-PT iteration number: 3100 of 40000. Chain number 1. Current logpost: -363.419. Length of jump: 6.          Running MCMC-PT iteration number: 3100 of 40000. Chain number 2. Current logpost: -369.172. Length of jump: 8.          Running MCMC-PT iteration number: 3100 of 40000. Chain number 4. Current logpost: -362.768. Length of jump: 6.          Running MCMC-PT iteration number: 3200 of 40000. Chain number 3. Current logpost: -363.948. Length of jump: 5.          Running MCMC-PT iteration number: 3200 of 40000. Chain number 1. Current logpost: -365.326. Length of jump: 5.          Running MCMC-PT iteration number: Running MCMC-PT iteration number: 32003200 of  of 4000040000. Chain number . Chain number 42. Current logpost: . Current logpost: -367.34-361.536. Length of jump: . Length of jump: 96.          .          Running MCMC-PT iteration number: 3300 of 40000. Chain number 3. Current logpost: -361.494. Length of jump: 6.          Running MCMC-PT iteration number: 3300 of 40000. Chain number 1. Current logpost: -361.473. Length of jump: 5.          Running MCMC-PT iteration number: 3300 of 40000. Chain number 4. Current logpost: -363.103. Length of jump: 6.          Running MCMC-PT iteration number: 3300 of 40000. Chain number 2. Current logpost: -366.144. Length of jump: 9.          Running MCMC-PT iteration number: 3400 of 40000. Chain number 3. Current logpost: -360.887. Length of jump: 5.          Running MCMC-PT iteration number: 3400 of 40000. Chain number 1. Current logpost: -360.861. Length of jump: 5.          Running MCMC-PT iteration number: 3400 of 40000. Chain number 4. Current logpost: -362.099. Length of jump: 5.          Running MCMC-PT iteration number: 3400 of 40000. Chain number 2. Current logpost: -368.817. Length of jump: 8.          Running MCMC-PT iteration number: 3500 of 40000. Chain number 3. Current logpost: -360.099. Length of jump: 6.          Running MCMC-PT iteration number: 3500 of 40000. Chain number 1. Current logpost: -361.123. Length of jump: 6.          Running MCMC-PT iteration number: 3500 of 40000. Chain number 4. Current logpost: -361.011. Length of jump: 5.          Running MCMC-PT iteration number: 3500 of 40000. Chain number 2. Current logpost: -360.537. Length of jump: 7.          Running MCMC-PT iteration number: 3600 of 40000. Chain number 3. Current logpost: -360.055. Length of jump: 6.          Running MCMC-PT iteration number: 3600 of 40000. Chain number 1. Current logpost: -360.192. Length of jump: 5.          Running MCMC-PT iteration number: 3600 of 40000. Chain number 4. Current logpost: -360.934. Length of jump: 5.          Running MCMC-PT iteration number: 3600 of 40000. Chain number 2. Current logpost: -356.138. Length of jump: 7.          Running MCMC-PT iteration number: 3700 of 40000. Chain number 3. Current logpost: -362.277. Length of jump: 7.          Running MCMC-PT iteration number: 3700 of 40000. Chain number 1. Current logpost: -359.928. Length of jump: 5.          Running MCMC-PT iteration number: 3700 of 40000. Chain number 4. Current logpost: -360.117. Length of jump: 4.          Running MCMC-PT iteration number: 3700 of 40000. Chain number 2. Current logpost: -355.591. Length of jump: 7.          Running MCMC-PT iteration number: 3800 of 40000. Chain number 3. Current logpost: -361.345. Length of jump: 7.          Running MCMC-PT iteration number: 3800 of 40000. Chain number 1. Current logpost: -360.399. Length of jump: 5.          Running MCMC-PT iteration number: 3800 of 40000. Chain number 2. Current logpost: -355.424. Length of jump: 7.          Running MCMC-PT iteration number: 3800 of 40000. Chain number 4. Current logpost: -363.764. Length of jump: 5.          Running MCMC-PT iteration number: 3900 of 40000. Chain number 3. Current logpost: -365.359. Length of jump: 8.          Running MCMC-PT iteration number: 3900 of 40000. Chain number 1. Current logpost: -360.348. Length of jump: 5.          Running MCMC-PT iteration number: 3900 of 40000. Chain number 4. Current logpost: -367.001. Length of jump: 7.          Running MCMC-PT iteration number: 3900 of 40000. Chain number 2. Current logpost: -357.379. Length of jump: 6.          Running MCMC-PT iteration number: 4000 of 40000. Chain number 3. Current logpost: -363.577. Length of jump: 7.          Running MCMC-PT iteration number: 4000 of 40000. Chain number 1. Current logpost: -361.947. Length of jump: 5.          Running MCMC-PT iteration number: 4000 of 40000. Chain number 2. Current logpost: -356.035. Length of jump: 5.          Running MCMC-PT iteration number: 4000 of 40000. Chain number 4. Current logpost: -363.676. Length of jump: 6.          Running MCMC-PT iteration number: 4100 of 40000. Chain number 3. Current logpost: -363.552. Length of jump: 7.          Running MCMC-PT iteration number: 4100 of 40000. Chain number 1. Current logpost: -360.21. Length of jump: 6.          Running MCMC-PT iteration number: 4100 of 40000. Chain number 2. Current logpost: -357.04. Length of jump: 5.          Running MCMC-PT iteration number: 4100 of 40000. Chain number 4. Current logpost: -365.453. Length of jump: 7.          Running MCMC-PT iteration number: 4200 of 40000. Chain number 3. Current logpost: -363.871. Length of jump: 8.          Running MCMC-PT iteration number: 4200 of 40000. Chain number 1. Current logpost: -360.939. Length of jump: 6.          Running MCMC-PT iteration number: 4200 of 40000. Chain number 2. Current logpost: -357.05. Length of jump: 5.          Running MCMC-PT iteration number: 4200 of 40000. Chain number 4. Current logpost: -366.457. Length of jump: 8.          Running MCMC-PT iteration number: 4300 of 40000. Chain number 3. Current logpost: -364.236. Length of jump: 8.          Running MCMC-PT iteration number: 4300 of 40000. Chain number 1. Current logpost: -361.212. Length of jump: 6.          Running MCMC-PT iteration number: 4300 of 40000. Chain number 2. Current logpost: -360.415. Length of jump: 6.          Running MCMC-PT iteration number: 4300 of 40000. Chain number 4. Current logpost: -365.753. Length of jump: 8.          Running MCMC-PT iteration number: 4400 of 40000. Chain number 3. Current logpost: -363.876. Length of jump: 8.          Running MCMC-PT iteration number: 4400 of 40000. Chain number 1. Current logpost: -358.818. Length of jump: 5.          Running MCMC-PT iteration number: 4400 of 40000. Chain number 2. Current logpost: -356.457. Length of jump: 5.          Running MCMC-PT iteration number: 4400 of 40000. Chain number 4. Current logpost: -365.416. Length of jump: 8.          Running MCMC-PT iteration number: 4500 of 40000. Chain number 3. Current logpost: -365.764. Length of jump: 8.          Running MCMC-PT iteration number: 4500 of 40000. Chain number 1. Current logpost: -359.186. Length of jump: 4.          Running MCMC-PT iteration number: 4500 of 40000. Chain number 2. Current logpost: -358.573. Length of jump: 6.          Running MCMC-PT iteration number: 4500 of 40000. Chain number 4. Current logpost: -371.39. Length of jump: 10.          Running MCMC-PT iteration number: 4600 of 40000. Chain number 3. Current logpost: -364.956. Length of jump: 7.          Running MCMC-PT iteration number: 4600 of 40000. Chain number 1. Current logpost: -359.627. Length of jump: 4.          Running MCMC-PT iteration number: 4600 of 40000. Chain number 2. Current logpost: -356.801. Length of jump: 7.          Running MCMC-PT iteration number: 4600 of 40000. Chain number 4. Current logpost: -365.882. Length of jump: 8.          Running MCMC-PT iteration number: 4700 of 40000. Chain number 3. Current logpost: -364. Length of jump: 6.          Running MCMC-PT iteration number: 4700 of 40000. Chain number 1. Current logpost: -358.994. Length of jump: 4.          Running MCMC-PT iteration number: 4700 of 40000. Chain number 2. Current logpost: -355.23. Length of jump: 7.          Running MCMC-PT iteration number: 4700 of 40000. Chain number 4. Current logpost: -367.273. Length of jump: 7.          Running MCMC-PT iteration number: 4800 of 40000. Chain number 3. Current logpost: -365.045. Length of jump: 8.          Running MCMC-PT iteration number: 4800 of 40000. Chain number 1. Current logpost: -358.66. Length of jump: 4.          Running MCMC-PT iteration number: 4800 of 40000. Chain number 2. Current logpost: -356.575. Length of jump: 8.          Running MCMC-PT iteration number: 4800 of 40000. Chain number 4. Current logpost: -364.145. Length of jump: 6.          Running MCMC-PT iteration number: 4900 of 40000. Chain number 3. Current logpost: -364.87. Length of jump: 7.          Running MCMC-PT iteration number: 4900 of 40000. Chain number 1. Current logpost: -359.589. Length of jump: 4.          Running MCMC-PT iteration number: 4900 of 40000. Chain number 2. Current logpost: -357.177. Length of jump: 8.          Running MCMC-PT iteration number: 4900 of 40000. Chain number 4. Current logpost: -364.061. Length of jump: 6.          Running MCMC-PT iteration number: 5000 of 40000. Chain number 3. Current logpost: -361.333. Length of jump: 6.          Running MCMC-PT iteration number: 5000 of 40000. Chain number 1. Current logpost: -358.206. Length of jump: 5.          Running MCMC-PT iteration number: 5000 of 40000. Chain number 2. Current logpost: -358.008. Length of jump: 8.          Running MCMC-PT iteration number: 5000 of 40000. Chain number 4. Current logpost: -360.894. Length of jump: 5.          Running MCMC-PT iteration number: 5100 of 40000. Chain number 3. Current logpost: -362.199. Length of jump: 6.          Running MCMC-PT iteration number: 5100 of 40000. Chain number 1. Current logpost: -358.609. Length of jump: 5.          Running MCMC-PT iteration number: 5100 of 40000. Chain number 2. Current logpost: -356.787. Length of jump: 7.          Running MCMC-PT iteration number: 5100 of 40000. Chain number 4. Current logpost: -362.928. Length of jump: 6.          Running MCMC-PT iteration number: 5200 of 40000. Chain number 3. Current logpost: -362.23. Length of jump: 6.          Running MCMC-PT iteration number: 5200 of 40000. Chain number 1. Current logpost: -359.845. Length of jump: 5.          Running MCMC-PT iteration number: 5200 of 40000. Chain number 2. Current logpost: -357.337. Length of jump: 6.          Running MCMC-PT iteration number: 5200 of 40000. Chain number 4. Current logpost: -362.609. Length of jump: 6.          Running MCMC-PT iteration number: 5300 of 40000. Chain number 3. Current logpost: -362.454. Length of jump: 6.          Running MCMC-PT iteration number: 5300 of 40000. Chain number 1. Current logpost: -358.184. Length of jump: 5.          Running MCMC-PT iteration number: 5300 of 40000. Chain number 2. Current logpost: -357.155. Length of jump: 5.          Running MCMC-PT iteration number: 5300 of 40000. Chain number 4. Current logpost: -362.491. Length of jump: 5.          Running MCMC-PT iteration number: 5400 of 40000. Chain number 3. Current logpost: -362.172. Length of jump: 6.          Running MCMC-PT iteration number: 5400 of 40000. Chain number 1. Current logpost: -362.317. Length of jump: 5.          Running MCMC-PT iteration number: 5400 of 40000. Chain number 2. Current logpost: -358.801. Length of jump: 5.          Running MCMC-PT iteration number: 5400 of 40000. Chain number 4. Current logpost: -362.267. Length of jump: 5.          Running MCMC-PT iteration number: 5500 of 40000. Chain number 3. Current logpost: -362.036. Length of jump: 6.          Running MCMC-PT iteration number: 5500 of 40000. Chain number 1. Current logpost: -363.909. Length of jump: 5.          Running MCMC-PT iteration number: 5500 of 40000. Chain number 2. Current logpost: -359.56. Length of jump: 5.          Running MCMC-PT iteration number: 5500 of 40000. Chain number 4. Current logpost: -365.818. Length of jump: 6.          Running MCMC-PT iteration number: 5600 of 40000. Chain number 3. Current logpost: -361.395. Length of jump: 7.          Running MCMC-PT iteration number: 5600 of 40000. Chain number 1. Current logpost: -361.458. Length of jump: 5.          Running MCMC-PT iteration number: 5600 of 40000. Chain number 2. Current logpost: -358.583. Length of jump: 5.          Running MCMC-PT iteration number: 5600 of 40000. Chain number 4. Current logpost: -358.889. Length of jump: 6.          Running MCMC-PT iteration number: 5700 of 40000. Chain number 3. Current logpost: -363.248. Length of jump: 6.          Running MCMC-PT iteration number: 5700 of 40000. Chain number 1. Current logpost: -359.383. Length of jump: 5.          Running MCMC-PT iteration number: 5700 of 40000. Chain number 2. Current logpost: -359.099. Length of jump: 5.          Running MCMC-PT iteration number: 5700 of 40000. Chain number 4. Current logpost: -359.44. Length of jump: 6.          Running MCMC-PT iteration number: 5800 of 40000. Chain number 2. Current logpost: -359.941. Length of jump: 5.          Running MCMC-PT iteration number: 5800 of 40000. Chain number 4. Current logpost: -359.938. Length of jump: 6.          Running MCMC-PT iteration number: 5900 of 40000. Chain number 3. Current logpost: -362.795. Length of jump: 7.          Running MCMC-PT iteration number: 5900 of 40000. Chain number 1. Current logpost: -361.821. Length of jump: 8.          Running MCMC-PT iteration number: 5900 of 40000. Chain number 2. Current logpost: -357.151. Length of jump: 5.          Running MCMC-PT iteration number: 5900 of 40000. Chain number 4. Current logpost: -359.487. Length of jump: 6.          Running MCMC-PT iteration number: 6000 of 40000. Chain number 3. Current logpost: -360.547. Length of jump: 6.          Running MCMC-PT iteration number: 6000 of 40000. Chain number 1. Current logpost: -360.228. Length of jump: 7.          Running MCMC-PT iteration number: 6000 of 40000. Chain number 2. Current logpost: -357.813. Length of jump: 5.          Running MCMC-PT iteration number: 6000 of 40000. Chain number 4. Current logpost: -358.848. Length of jump: 5.          Running MCMC-PT iteration number: 6100 of 40000. Chain number 3. Current logpost: -361.251. Length of jump: 5.          Running MCMC-PT iteration number: 6100 of 40000. Chain number 1. Current logpost: -358.728. Length of jump: 7.          Running MCMC-PT iteration number: 6100 of 40000. Chain number 2. Current logpost: -356.866. Length of jump: 6.          Running MCMC-PT iteration number: 6100 of 40000. Chain number 4. Current logpost: -359.938. Length of jump: 5.          Running MCMC-PT iteration number: 6200 of 40000. Chain number 3. Current logpost: -360.678. Length of jump: 3.          Running MCMC-PT iteration number: 6200 of 40000. Chain number 1. Current logpost: -360.965. Length of jump: 7.          Running MCMC-PT iteration number: 6200 of 40000. Chain number 2. Current logpost: -358.05. Length of jump: 6.          Running MCMC-PT iteration number: 6200 of 40000. Chain number 4. Current logpost: -359.183. Length of jump: 5.          Running MCMC-PT iteration number: 6300 of 40000. Chain number 3. Current logpost: -360.678. Length of jump: 3.          Running MCMC-PT iteration number: 6300 of 40000. Chain number 1. Current logpost: -362.339. Length of jump: 7.          Running MCMC-PT iteration number: 6300 of 40000. Chain number 2. Current logpost: -356.81. Length of jump: 6.          Running MCMC-PT iteration number: 6300 of 40000. Chain number 4. Current logpost: -359.75. Length of jump: 5.          Running MCMC-PT iteration number: 6400 of 40000. Chain number 3. Current logpost: -363.103. Length of jump: 3.          Running MCMC-PT iteration number: 6400 of 40000. Chain number 1. Current logpost: -360.48. Length of jump: 8.          Running MCMC-PT iteration number: 6400 of 40000. Chain number 2. Current logpost: -357.058. Length of jump: 6.          Running MCMC-PT iteration number: 6400 of 40000. Chain number 4. Current logpost: -359.673. Length of jump: 5.          Running MCMC-PT iteration number: 6500 of 40000. Chain number 3. Current logpost: -360.966. Length of jump: 3.          Running MCMC-PT iteration number: 6500 of 40000. Chain number 1. Current logpost: -364.055. Length of jump: 9.          Running MCMC-PT iteration number: 6500 of 40000. Chain number 2. Current logpost: -357.42. Length of jump: 6.          Running MCMC-PT iteration number: 6500 of 40000. Chain number 4. Current logpost: -359.222. Length of jump: 4.          Running MCMC-PT iteration number: 6600 of 40000. Chain number 3. Current logpost: -361.834. Length of jump: 4.          Running MCMC-PT iteration number: 6600 of 40000. Chain number 1. Current logpost: -363.254. Length of jump: 8.          Running MCMC-PT iteration number: 6600 of 40000. Chain number 2. Current logpost: -357. Length of jump: 6.          Running MCMC-PT iteration number: 6600 of 40000. Chain number 4. Current logpost: -358.748. Length of jump: 4.          Running MCMC-PT iteration number: 6700 of 40000. Chain number 3. Current logpost: -361.319. Length of jump: 5.          Running MCMC-PT iteration number: 6700 of 40000. Chain number 1. Current logpost: -364.333. Length of jump: 8.          Running MCMC-PT iteration number: 6700 of 40000. Chain number 2. Current logpost: -356.867. Length of jump: 7.          Running MCMC-PT iteration number: 6700 of 40000. Chain number 4. Current logpost: -358.103. Length of jump: 4.          Running MCMC-PT iteration number: 6800 of 40000. Chain number 3. Current logpost: -360.358. Length of jump: 5.          Running MCMC-PT iteration number: 6800 of 40000. Chain number 1. Current logpost: -363.927. Length of jump: 6.          Running MCMC-PT iteration number: 6800 of 40000. Chain number 2. Current logpost: -359.069. Length of jump: 7.          Running MCMC-PT iteration number: 6800 of 40000. Chain number 4. Current logpost: -364.331. Length of jump: 6.          Running MCMC-PT iteration number: 6900 of 40000. Chain number 3. Current logpost: -360.204. Length of jump: 5.          Running MCMC-PT iteration number: 6900 of 40000. Chain number 1. Current logpost: -360.906. Length of jump: 6.          Running MCMC-PT iteration number: 6900 of 40000. Chain number 2. Current logpost: -357.665. Length of jump: 7.          Running MCMC-PT iteration number: 6900 of 40000. Chain number 4. Current logpost: -355.758. Length of jump: 6.          Running MCMC-PT iteration number: 7000 of 40000. Chain number 3. Current logpost: -361.663. Length of jump: 5.          Running MCMC-PT iteration number: 7000 of 40000. Chain number 1. Current logpost: -361.471. Length of jump: 6.          Running MCMC-PT iteration number: 7000 of 40000. Chain number 2. Current logpost: -357.684. Length of jump: 7.          Running MCMC-PT iteration number: 7000 of 40000. Chain number 4. Current logpost: -356.329. Length of jump: 7.          Running MCMC-PT iteration number: 7100 of 40000. Chain number 3. Current logpost: -361.372. Length of jump: 3.          Running MCMC-PT iteration number: 7100 of 40000. Chain number 1. Current logpost: -361.965. Length of jump: 6.          Running MCMC-PT iteration number: 7100 of 40000. Chain number 2. Current logpost: -358.652. Length of jump: 9.          Running MCMC-PT iteration number: 7100 of 40000. Chain number 4. Current logpost: -355.776. Length of jump: 6.          Running MCMC-PT iteration number: 7200 of 40000. Chain number 3. Current logpost: -362.317. Length of jump: 4.          Running MCMC-PT iteration number: 7200 of 40000. Chain number 1. Current logpost: -366.446. Length of jump: 7.          Running MCMC-PT iteration number: 7200 of 40000. Chain number 2. Current logpost: -359.084. Length of jump: 10.          Running MCMC-PT iteration number: 7200 of 40000. Chain number 4. Current logpost: -356.802. Length of jump: 6.          Running MCMC-PT iteration number: 7300 of 40000. Chain number 3. Current logpost: -360.865. Length of jump: 6.          Running MCMC-PT iteration number: 7300 of 40000. Chain number 1. Current logpost: -362.471. Length of jump: 7.          Running MCMC-PT iteration number: 7300 of 40000. Chain number 2. Current logpost: -355.573. Length of jump: 8.          Running MCMC-PT iteration number: 7300 of 40000. Chain number 4. Current logpost: -356.99. Length of jump: 7.          Running MCMC-PT iteration number: 7400 of 40000. Chain number 3. Current logpost: -360.039. Length of jump: 5.          Running MCMC-PT iteration number: 7400 of 40000. Chain number 1. Current logpost: -361.935. Length of jump: 7.          Running MCMC-PT iteration number: 7400 of 40000. Chain number 2. Current logpost: -355.395. Length of jump: 8.          Running MCMC-PT iteration number: 7500 of 40000. Chain number 3. Current logpost: -360.604. Length of jump: 6.          Running MCMC-PT iteration number: 7400 of 40000. Chain number 4. Current logpost: -358.981. Length of jump: 7.          Running MCMC-PT iteration number: 7500 of 40000. Chain number 1. Current logpost: -364.83. Length of jump: 9.          Running MCMC-PT iteration number: 7500 of 40000. Chain number 2. Current logpost: -354.655. Length of jump: 8.          Running MCMC-PT iteration number: 7500 of 40000. Chain number 4. Current logpost: -359.826. Length of jump: 8.          Running MCMC-PT iteration number: 7600 of 40000. Chain number 3. Current logpost: -363.033. Length of jump: 6.          Running MCMC-PT iteration number: 7600 of 40000. Chain number 1. Current logpost: -365.547. Length of jump: 8.          Running MCMC-PT iteration number: 7600 of 40000. Chain number 2. Current logpost: -354.441. Length of jump: 8.          Running MCMC-PT iteration number: 7600 of 40000. Chain number 4. Current logpost: -362.249. Length of jump: 9.          Running MCMC-PT iteration number: 7700 of 40000. Chain number 3. Current logpost: -360.976. Length of jump: 5.          Running MCMC-PT iteration number: 7700 of 40000. Chain number 1. Current logpost: -363.749. Length of jump: 9.          Running MCMC-PT iteration number: 7700 of 40000. Chain number 2. Current logpost: -354.21. Length of jump: 8.          Running MCMC-PT iteration number: 7700 of 40000. Chain number 4. Current logpost: -362.479. Length of jump: 9.          Running MCMC-PT iteration number: 7800 of 40000. Chain number 3. Current logpost: -360.882. Length of jump: 5.          Running MCMC-PT iteration number: 7800 of 40000. Chain number 1. Current logpost: -363.088. Length of jump: 10.          Running MCMC-PT iteration number: 7800 of 40000. Chain number 2. Current logpost: -357.974. Length of jump: 8.          Running MCMC-PT iteration number: 7800 of 40000. Chain number 4. Current logpost: -361.872. Length of jump: 8.          Running MCMC-PT iteration number: 7900 of 40000. Chain number 3. Current logpost: -360.967. Length of jump: 6.          Running MCMC-PT iteration number: 7900 of 40000. Chain number 1. Current logpost: -362.15. Length of jump: 9.          Running MCMC-PT iteration number: 7900 of 40000. Chain number 2. Current logpost: -356.685. Length of jump: 9.          Running MCMC-PT iteration number: 7900 of 40000. Chain number 4. Current logpost: -361.294. Length of jump: 9.          Running MCMC-PT iteration number: 8000 of 40000. Chain number 3. Current logpost: -362.853. Length of jump: 6.          Running MCMC-PT iteration number: 8000 of 40000. Chain number 1. Current logpost: -360.357. Length of jump: 8.          Running MCMC-PT iteration number: 8000 of 40000. Chain number 2. Current logpost: -358.023. Length of jump: 9.          Running MCMC-PT iteration number: 8000 of 40000. Chain number 4. Current logpost: -357.654. Length of jump: 8.          Running MCMC-PT iteration number: 8100 of 40000. Chain number 3. Current logpost: -363.629. Length of jump: 6.          Running MCMC-PT iteration number: 8100 of 40000. Chain number 1. Current logpost: -365.13. Length of jump: 8.          Running MCMC-PT iteration number: 8100 of 40000. Chain number 2. Current logpost: -360.812. Length of jump: 8.          Running MCMC-PT iteration number: 8100 of 40000. Chain number 4. Current logpost: -359.044. Length of jump: 8.          Running MCMC-PT iteration number: 8200 of 40000. Chain number 3. Current logpost: -361.163. Length of jump: 5.          Running MCMC-PT iteration number: 8200 of 40000. Chain number 1. Current logpost: -358.594. Length of jump: 6.          Running MCMC-PT iteration number: 8200 of 40000. Chain number 2. Current logpost: -360.931. Length of jump: 8.          Running MCMC-PT iteration number: 8200 of 40000. Chain number 4. Current logpost: -359.595. Length of jump: 8.          Running MCMC-PT iteration number: 8300 of 40000. Chain number 3. Current logpost: -361.264. Length of jump: 5.          Running MCMC-PT iteration number: 8300 of 40000. Chain number 1. Current logpost: -358.282. Length of jump: 6.          Running MCMC-PT iteration number: 8300 of 40000. Chain number 2. Current logpost: -358.053. Length of jump: 8.          Running MCMC-PT iteration number: 8300 of 40000. Chain number 4. Current logpost: -359.622. Length of jump: 9.          Running MCMC-PT iteration number: 8400 of 40000. Chain number 3. Current logpost: -360.948. Length of jump: 6.          Running MCMC-PT iteration number: 8400 of 40000. Chain number 1. Current logpost: -355.993. Length of jump: 6.          Running MCMC-PT iteration number: 8400 of 40000. Chain number 2. Current logpost: -354.827. Length of jump: 7.          Running MCMC-PT iteration number: 8400 of 40000. Chain number 4. Current logpost: -359.183. Length of jump: 8.          Running MCMC-PT iteration number: 8500 of 40000. Chain number 3. Current logpost: -361.146. Length of jump: 6.          Running MCMC-PT iteration number: 8500 of 40000. Chain number 1. Current logpost: -359.524. Length of jump: 7.          Running MCMC-PT iteration number: 8500 of 40000. Chain number 2. Current logpost: -355.258. Length of jump: 7.          Running MCMC-PT iteration number: 8500 of 40000. Chain number 4. Current logpost: -359.684. Length of jump: 7.          Running MCMC-PT iteration number: 8600 of 40000. Chain number 3. Current logpost: -361.362. Length of jump: 6.          Running MCMC-PT iteration number: 8600 of 40000. Chain number 1. Current logpost: -358.302. Length of jump: 7.          Running MCMC-PT iteration number: 8600 of 40000. Chain number 2. Current logpost: -356.94. Length of jump: 8.          Running MCMC-PT iteration number: 8600 of 40000. Chain number 4. Current logpost: -357.094. Length of jump: 7.          Running MCMC-PT iteration number: 8700 of 40000. Chain number 3. Current logpost: -361.986. Length of jump: 7.          Running MCMC-PT iteration number: 8700 of 40000. Chain number 1. Current logpost: -357.602. Length of jump: 7.          Running MCMC-PT iteration number: 8700 of 40000. Chain number 2. Current logpost: -358.203. Length of jump: 9.          Running MCMC-PT iteration number: 8700 of 40000. Chain number 4. Current logpost: -357.856. Length of jump: 7.          Running MCMC-PT iteration number: 8800 of 40000. Chain number 3. Current logpost: -362.895. Length of jump: 7.          Running MCMC-PT iteration number: 8800 of 40000. Chain number 1. Current logpost: -355.749. Length of jump: 6.          Running MCMC-PT iteration number: 8800 of 40000. Chain number 2. Current logpost: -357.218. Length of jump: 8.          Running MCMC-PT iteration number: 8800 of 40000. Chain number 4. Current logpost: -359.148. Length of jump: 7.          Running MCMC-PT iteration number: 8900 of 40000. Chain number 3. Current logpost: -363.925. Length of jump: 7.          Running MCMC-PT iteration number: 8900 of 40000. Chain number 1. Current logpost: -358.518. Length of jump: 7.          Running MCMC-PT iteration number: 8900 of 40000. Chain number 2. Current logpost: -358.716. Length of jump: 8.          Running MCMC-PT iteration number: 8900 of 40000. Chain number 4. Current logpost: -359.186. Length of jump: 6.          Running MCMC-PT iteration number: 9000 of 40000. Chain number 3. Current logpost: -364.731. Length of jump: 8.          Running MCMC-PT iteration number: 9000 of 40000. Chain number 1. Current logpost: -362.097. Length of jump: 8.          Running MCMC-PT iteration number: 9000 of 40000. Chain number 2. Current logpost: -356.582. Length of jump: 6.          Running MCMC-PT iteration number: 9000 of 40000. Chain number 4. Current logpost: -359.706. Length of jump: 7.          Running MCMC-PT iteration number: 9100 of 40000. Chain number 3. Current logpost: -365.179. Length of jump: 7.          Running MCMC-PT iteration number: 9100 of 40000. Chain number 1. Current logpost: -358.041. Length of jump: 7.          Running MCMC-PT iteration number: 9100 of 40000. Chain number 2. Current logpost: -356.583. Length of jump: 5.          Running MCMC-PT iteration number: 9100 of 40000. Chain number 4. Current logpost: -356.489. Length of jump: 9.          Running MCMC-PT iteration number: 9200 of 40000. Chain number 3. Current logpost: -361.333. Length of jump: 5.          Running MCMC-PT iteration number: 9200 of 40000. Chain number 1. Current logpost: -357.205. Length of jump: 7.          Running MCMC-PT iteration number: 9200 of 40000. Chain number 2. Current logpost: -357.71. Length of jump: 5.          Running MCMC-PT iteration number: 9200 of 40000. Chain number 4. Current logpost: -356.175. Length of jump: 9.          Running MCMC-PT iteration number: 9300 of 40000. Chain number 3. Current logpost: -361.096. Length of jump: 5.          Running MCMC-PT iteration number: 9300 of 40000. Chain number 1. Current logpost: -358.037. Length of jump: 7.          Running MCMC-PT iteration number: 9300 of 40000. Chain number 2. Current logpost: -356.149. Length of jump: 6.          Running MCMC-PT iteration number: 9300 of 40000. Chain number 4. Current logpost: -356.309. Length of jump: 9.          Running MCMC-PT iteration number: 9400 of 40000. Chain number 3. Current logpost: -360.74. Length of jump: 4.          Running MCMC-PT iteration number: 9400 of 40000. Chain number 1. Current logpost: -361.214. Length of jump: 7.          Running MCMC-PT iteration number: 9400 of 40000. Chain number 2. Current logpost: -356.596. Length of jump: 6.          Running MCMC-PT iteration number: 9400 of 40000. Chain number 4. Current logpost: -358.179. Length of jump: 10.          Running MCMC-PT iteration number: 9500 of 40000. Chain number 3. Current logpost: -361.702. Length of jump: 5.          Running MCMC-PT iteration number: 9500 of 40000. Chain number 1. Current logpost: -359.43. Length of jump: 7.          Running MCMC-PT iteration number: 9500 of 40000. Chain number 2. Current logpost: -357.172. Length of jump: 6.          Running MCMC-PT iteration number: 9500 of 40000. Chain number 4. Current logpost: -357.409. Length of jump: 9.          Running MCMC-PT iteration number: 9600 of 40000. Chain number 3. Current logpost: -363.53. Length of jump: 5.          Running MCMC-PT iteration number: 9600 of 40000. Chain number 1. Current logpost: -359.272. Length of jump: 7.          Running MCMC-PT iteration number: 9600 of 40000. Chain number 2. Current logpost: -358.05. Length of jump: 7.          Running MCMC-PT iteration number: 9600 of 40000. Chain number 4. Current logpost: -355.277. Length of jump: 8.          Running MCMC-PT iteration number: 9700 of 40000. Chain number 3. Current logpost: -360.627. Length of jump: 4.          Running MCMC-PT iteration number: 9700 of 40000. Chain number 1. Current logpost: -359.487. Length of jump: 7.          Running MCMC-PT iteration number: 9700 of 40000. Chain number 2. Current logpost: -357.941. Length of jump: 8.          Running MCMC-PT iteration number: 9800 of 40000. Chain number 3. Current logpost: -360.604. Length of jump: 4.          Running MCMC-PT iteration number: 9700 of 40000. Chain number 4. Current logpost: -356.231. Length of jump: 8.          Running MCMC-PT iteration number: 9800 of 40000. Chain number 1. Current logpost: -357.46. Length of jump: 7.          Running MCMC-PT iteration number: 9800 of 40000. Chain number 2. Current logpost: -357.541. Length of jump: 8.          Running MCMC-PT iteration number: 9900 of 40000. Chain number 3. Current logpost: -360.699. Length of jump: 3.          Running MCMC-PT iteration number: 9800 of 40000. Chain number 4. Current logpost: -358.982. Length of jump: 8.          Running MCMC-PT iteration number: 9900 of 40000. Chain number 1. Current logpost: -358.851. Length of jump: 7.          Running MCMC-PT iteration number: 9900 of 40000. Chain number 2. Current logpost: -357.649. Length of jump: 8.          Running MCMC-PT iteration number: 10000 of 40000. Chain number 3. Current logpost: -360.811. Length of jump: 3.          Running MCMC-PT iteration number: 9900 of 40000. Chain number 4. Current logpost: -361.798. Length of jump: 9.          Running MCMC-PT iteration number: 10000 of 40000. Chain number 1. Current logpost: -357.506. Length of jump: 7.          Running MCMC-PT iteration number: 10000 of 40000. Chain number 2. Current logpost: -359.798. Length of jump: 7.          Running MCMC-PT iteration number: 10100 of 40000. Chain number 3. Current logpost: -362.746. Length of jump: 4.          Running MCMC-PT iteration number: 10000 of 40000. Chain number 4. Current logpost: -357.932. Length of jump: 8.          Running MCMC-PT iteration number: 10100 of 40000. Chain number 1. Current logpost: -358.215. Length of jump: 6.          Running MCMC-PT iteration number: 10100 of 40000. Chain number 2. Current logpost: -359.377. Length of jump: 7.          Running MCMC-PT iteration number: 10200 of 40000. Chain number 3. Current logpost: -359.484. Length of jump: 6.          Running MCMC-PT iteration number: 10100 of 40000. Chain number 4. Current logpost: -358.391. Length of jump: 8.          Running MCMC-PT iteration number: 10200 of 40000. Chain number 1. Current logpost: -359.716. Length of jump: 7.          Running MCMC-PT iteration number: 10200 of 40000. Chain number 2. Current logpost: -356.778. Length of jump: 8.          Running MCMC-PT iteration number: 10300 of 40000. Chain number 3. Current logpost: -358.444. Length of jump: 5.          Running MCMC-PT iteration number: 10200 of 40000. Chain number 4. Current logpost: -360.449. Length of jump: 9.          Running MCMC-PT iteration number: 10300 of 40000. Chain number 1. Current logpost: -360.184. Length of jump: 6.          Running MCMC-PT iteration number: 10300 of 40000. Chain number 2. Current logpost: -357.301. Length of jump: 8.          Running MCMC-PT iteration number: 10400 of 40000. Chain number 3. Current logpost: -359.702. Length of jump: 5.          Running MCMC-PT iteration number: 10300 of 40000. Chain number 4. Current logpost: -359.103. Length of jump: 9.          Running MCMC-PT iteration number: 10400 of 40000. Chain number 1. Current logpost: -357.08. Length of jump: 6.          Running MCMC-PT iteration number: 10400 of 40000. Chain number 2. Current logpost: -358.563. Length of jump: 9.          Running MCMC-PT iteration number: 10500 of 40000. Chain number 3. Current logpost: -362.63. Length of jump: 5.          Running MCMC-PT iteration number: 10400 of 40000. Chain number 4. Current logpost: -356.582. Length of jump: 7.          Running MCMC-PT iteration number: 10500 of 40000. Chain number 1. Current logpost: -357.056. Length of jump: 6.          Running MCMC-PT iteration number: 10500 of 40000. Chain number 2. Current logpost: -361.34. Length of jump: 10.          Running MCMC-PT iteration number: 10600 of 40000. Chain number 3. Current logpost: -358.892. Length of jump: 4.          Running MCMC-PT iteration number: 10500 of 40000. Chain number 4. Current logpost: -353.693. Length of jump: 7.          Running MCMC-PT iteration number: 10600 of 40000. Chain number 1. Current logpost: -356.471. Length of jump: 6.          Running MCMC-PT iteration number: 10600 of 40000. Chain number 2. Current logpost: -360.546. Length of jump: 10.          Running MCMC-PT iteration number: 10700 of 40000. Chain number 3. Current logpost: -357.881. Length of jump: 5.          Running MCMC-PT iteration number: 10600 of 40000. Chain number 4. Current logpost: -354.908. Length of jump: 8.          Running MCMC-PT iteration number: 10700 of 40000. Chain number 1. Current logpost: -356.812. Length of jump: 7.          Running MCMC-PT iteration number: 10700 of 40000. Chain number 2. Current logpost: -359.542. Length of jump: 9.          Running MCMC-PT iteration number: 10800 of 40000. Chain number 3. Current logpost: -356.227. Length of jump: 5.          Running MCMC-PT iteration number: 10700 of 40000. Chain number 4. Current logpost: -353.677. Length of jump: 7.          Running MCMC-PT iteration number: 10800 of 40000. Chain number 1. Current logpost: -360.855. Length of jump: 7.          Running MCMC-PT iteration number: 10800 of 40000. Chain number 2. Current logpost: -360.29. Length of jump: 9.          Running MCMC-PT iteration number: 10900 of 40000. Chain number 3. Current logpost: -354.869. Length of jump: 6.          Running MCMC-PT iteration number: 10800 of 40000. Chain number 4. Current logpost: -355.44. Length of jump: 7.          Running MCMC-PT iteration number: 10900 of 40000. Chain number 1. Current logpost: -357.233. Length of jump: 7.          Running MCMC-PT iteration number: 10900 of 40000. Chain number 2. Current logpost: -359.769. Length of jump: 9.          Running MCMC-PT iteration number: 11000 of 40000. Chain number 3. Current logpost: -358.708. Length of jump: 5.          Running MCMC-PT iteration number: 10900 of 40000. Chain number 4. Current logpost: -355.192. Length of jump: 7.          Running MCMC-PT iteration number: 11000 of 40000. Chain number 1. Current logpost: -356.944. Length of jump: 6.          Running MCMC-PT iteration number: 11000 of 40000. Chain number 2. Current logpost: -359.698. Length of jump: 9.          Running MCMC-PT iteration number: 11100 of 40000. Chain number 3. Current logpost: -360.479. Length of jump: 5.          Running MCMC-PT iteration number: 11000 of 40000. Chain number 4. Current logpost: -358.962. Length of jump: 9.          Running MCMC-PT iteration number: 11100 of 40000. Chain number 1. Current logpost: -356.117. Length of jump: 7.          Running MCMC-PT iteration number: 11100 of 40000. Chain number 2. Current logpost: -360.83. Length of jump: 9.          Running MCMC-PT iteration number: 11200 of 40000. Chain number 3. Current logpost: -356.647. Length of jump: 5.          Running MCMC-PT iteration number: 11100 of 40000. Chain number 4. Current logpost: -357.608. Length of jump: 8.          Running MCMC-PT iteration number: 11200 of 40000. Chain number 1. Current logpost: -358.833. Length of jump: 7.          Running MCMC-PT iteration number: 11200 of 40000. Chain number 2. Current logpost: -361.099. Length of jump: 10.          Running MCMC-PT iteration number: 11300 of 40000. Chain number 3. Current logpost: -358.711. Length of jump: 5.          Running MCMC-PT iteration number: 11200 of 40000. Chain number 4. Current logpost: -357.157. Length of jump: 8.          Running MCMC-PT iteration number: 11300 of 40000. Chain number 1. Current logpost: -357.815. Length of jump: 7.          Running MCMC-PT iteration number: 11300 of 40000. Chain number 2. Current logpost: -367.496. Length of jump: 9.          Running MCMC-PT iteration number: 11400 of 40000. Chain number 3. Current logpost: -357.531. Length of jump: 5.          Running MCMC-PT iteration number: 11400 of 40000. Chain number 1. Current logpost: -360.024. Length of jump: 7.          Running MCMC-PT iteration number: 11500 of 40000. Chain number 3. Current logpost: -356.563. Length of jump: 6.          Running MCMC-PT iteration number: 11400 of 40000. Chain number 2. Current logpost: -364.548. Length of jump: 7.          Running MCMC-PT iteration number: 11400 of 40000. Chain number 4. Current logpost: -361.347. Length of jump: 8.          Running MCMC-PT iteration number: 11500 of 40000. Chain number 1. Current logpost: -357.339. Length of jump: 6.          Running MCMC-PT iteration number: 11600 of 40000. Chain number 3. Current logpost: -357.054. Length of jump: 6.          Running MCMC-PT iteration number: 11500 of 40000. Chain number 2. Current logpost: -364.979. Length of jump: 6.          Running MCMC-PT iteration number: 11500 of 40000. Chain number 4. Current logpost: -358.022. Length of jump: 7.          Running MCMC-PT iteration number: 11600 of 40000. Chain number 1. Current logpost: -356.157. Length of jump: 6.          Running MCMC-PT iteration number: 11700 of 40000. Chain number 3. Current logpost: -355.659. Length of jump: 6.          Running MCMC-PT iteration number: 11600 of 40000. Chain number 2. Current logpost: -358.3. Length of jump: 5.          Running MCMC-PT iteration number: 11600 of 40000. Chain number 4. Current logpost: -356.079. Length of jump: 5.          Running MCMC-PT iteration number: 11700 of 40000. Chain number 1. Current logpost: -357.255. Length of jump: 7.          Running MCMC-PT iteration number: 11800 of 40000. Chain number 3. Current logpost: -356.231. Length of jump: 6.          Running MCMC-PT iteration number: 11700 of 40000. Chain number 2. Current logpost: -360.084. Length of jump: 6.          Running MCMC-PT iteration number: 11700 of 40000. Chain number 4. Current logpost: -357.359. Length of jump: 5.          Running MCMC-PT iteration number: 11800 of 40000. Chain number 1. Current logpost: -356.262. Length of jump: 8.          Running MCMC-PT iteration number: 11900 of 40000. Chain number 3. Current logpost: -356.467. Length of jump: 6.          Running MCMC-PT iteration number: 11800 of 40000. Chain number 2. Current logpost: -360.615. Length of jump: 6.          Running MCMC-PT iteration number: 11800 of 40000. Chain number 4. Current logpost: -356.211. Length of jump: 5.          Running MCMC-PT iteration number: 11900 of 40000. Chain number 1. Current logpost: -357.649. Length of jump: 7.          Running MCMC-PT iteration number: 12000 of 40000. Chain number 3. Current logpost: -363.692. Length of jump: 6.          Running MCMC-PT iteration number: 11900 of 40000. Chain number 2. Current logpost: -360.124. Length of jump: 6.          Running MCMC-PT iteration number: 11900 of 40000. Chain number 4. Current logpost: -358.897. Length of jump: 5.          Running MCMC-PT iteration number: 12000 of 40000. Chain number 1. Current logpost: -358.542. Length of jump: 8.          Running MCMC-PT iteration number: 12100 of 40000. Chain number 3. Current logpost: -358.946. Length of jump: 6.          Running MCMC-PT iteration number: 12000 of 40000. Chain number 2. Current logpost: -360.428. Length of jump: 6.          Running MCMC-PT iteration number: 12000 of 40000. Chain number 4. Current logpost: -356.664. Length of jump: 5.          Running MCMC-PT iteration number: 12100 of 40000. Chain number 1. Current logpost: -357.502. Length of jump: 7.          Running MCMC-PT iteration number: 12200 of 40000. Chain number 3. Current logpost: -360.23. Length of jump: 6.          Running MCMC-PT iteration number: 12100 of 40000. Chain number 2. Current logpost: -360.37. Length of jump: 6.          Running MCMC-PT iteration number: 12100 of 40000. Chain number 4. Current logpost: -356.545. Length of jump: 5.          Running MCMC-PT iteration number: 12200 of 40000. Chain number 1. Current logpost: -356.34. Length of jump: 7.          Running MCMC-PT iteration number: 12300 of 40000. Chain number 3. Current logpost: -358.501. Length of jump: 6.          Running MCMC-PT iteration number: 12200 of 40000. Chain number 2. Current logpost: -362.507. Length of jump: 6.          Running MCMC-PT iteration number: 12200 of 40000. Chain number 4. Current logpost: -357.908. Length of jump: 5.          Running MCMC-PT iteration number: 12300 of 40000. Chain number 1. Current logpost: -359.855. Length of jump: 8.          Running MCMC-PT iteration number: 12400 of 40000. Chain number 3. Current logpost: -356.282. Length of jump: 7.          Running MCMC-PT iteration number: 12300 of 40000. Chain number 2. Current logpost: -361.83. Length of jump: 6.          Running MCMC-PT iteration number: 12300 of 40000. Chain number 4. Current logpost: -358.048. Length of jump: 5.          Running MCMC-PT iteration number: 12400 of 40000. Chain number 1. Current logpost: -361.098. Length of jump: 8.          Running MCMC-PT iteration number: 12500 of 40000. Chain number 3. Current logpost: -358.802. Length of jump: 8.          Running MCMC-PT iteration number: 12400 of 40000. Chain number 2. Current logpost: -360.264. Length of jump: 6.          Running MCMC-PT iteration number: 12400 of 40000. Chain number 4. Current logpost: -356.948. Length of jump: 6.          Running MCMC-PT iteration number: 12500 of 40000. Chain number 1. Current logpost: -364.666. Length of jump: 8.          Running MCMC-PT iteration number: 12600 of 40000. Chain number 3. Current logpost: -359.105. Length of jump: 9.          Running MCMC-PT iteration number: 12500 of 40000. Chain number 2. Current logpost: -360.072. Length of jump: 6.          Running MCMC-PT iteration number: 12500 of 40000. Chain number 4. Current logpost: -361.362. Length of jump: 8.          Running MCMC-PT iteration number: 12600 of 40000. Chain number 1. Current logpost: -364.831. Length of jump: 9.          Running MCMC-PT iteration number: 12700 of 40000. Chain number 3. Current logpost: -359.806. Length of jump: 8.          Running MCMC-PT iteration number: 12600 of 40000. Chain number 2. Current logpost: -361.23. Length of jump: 5.          Running MCMC-PT iteration number: 12600 of 40000. Chain number 4. Current logpost: -357.774. Length of jump: 6.          Running MCMC-PT iteration number: 12700 of 40000. Chain number 1. Current logpost: -367.605. Length of jump: 9.          Running MCMC-PT iteration number: 12800 of 40000. Chain number 3. Current logpost: -357.724. Length of jump: 8.          Running MCMC-PT iteration number: 12700 of 40000. Chain number 2. Current logpost: -368.492. Length of jump: 5.          Running MCMC-PT iteration number: 12700 of 40000. Chain number 4. Current logpost: -357.743. Length of jump: 5.          Running MCMC-PT iteration number: 12800 of 40000. Chain number 1. Current logpost: -362.945. Length of jump: 7.          Running MCMC-PT iteration number: 12900 of 40000. Chain number 3. Current logpost: -355.98. Length of jump: 8.          Running MCMC-PT iteration number: 13000 of 40000. Chain number 3. Current logpost: -357.764. Length of jump: 7.          Running MCMC-PT iteration number: 12900 of 40000. Chain number 2. Current logpost: -363.841. Length of jump: 4.          Running MCMC-PT iteration number: 12900 of 40000. Chain number 4. Current logpost: -361.41. Length of jump: 7.          Running MCMC-PT iteration number: 13000 of 40000. Chain number 1. Current logpost: -358.694. Length of jump: 9.          Running MCMC-PT iteration number: 13000 of 40000. Chain number 2. Current logpost: -360.395. Length of jump: 4.          Running MCMC-PT iteration number: 13000 of 40000. Chain number 4. Current logpost: -361.28. Length of jump: 7.          Running MCMC-PT iteration number: 13100 of 40000. Chain number 3. Current logpost: -356.632. Length of jump: 6.          Running MCMC-PT iteration number: 13100 of 40000. Chain number 1. Current logpost: -361.526. Length of jump: 9.          Running MCMC-PT iteration number: 13200 of 40000. Chain number 3. Current logpost: -356.593. Length of jump: 6.          Running MCMC-PT iteration number: 13100 of 40000. Chain number 2. Current logpost: -360.815. Length of jump: 3.          Running MCMC-PT iteration number: 13100 of 40000. Chain number 4. Current logpost: -360.54. Length of jump: 7.          Running MCMC-PT iteration number: 13200 of 40000. Chain number 1. Current logpost: -357.019. Length of jump: 7.          Running MCMC-PT iteration number: 13300 of 40000. Chain number 3. Current logpost: -360.248. Length of jump: 5.          Running MCMC-PT iteration number: 13200 of 40000. Chain number 2. Current logpost: -360.368. Length of jump: 5.          Running MCMC-PT iteration number: 13200 of 40000. Chain number 4. Current logpost: -362.964. Length of jump: 6.          Running MCMC-PT iteration number: 13300 of 40000. Chain number 1. Current logpost: -360.149. Length of jump: 7.          Running MCMC-PT iteration number: 13400 of 40000. Chain number 3. Current logpost: -359.118. Length of jump: 6.          Running MCMC-PT iteration number: 13300 of 40000. Chain number 2. Current logpost: -361.641. Length of jump: 5.          Running MCMC-PT iteration number: 13300 of 40000. Chain number 4. Current logpost: -362.65. Length of jump: 6.          Running MCMC-PT iteration number: 13400 of 40000. Chain number 1. Current logpost: -359.768. Length of jump: 5.          Running MCMC-PT iteration number: 13500 of 40000. Chain number 3. Current logpost: -358.196. Length of jump: 5.          Running MCMC-PT iteration number: 13400 of 40000. Chain number 2. Current logpost: -362.944. Length of jump: 5.          Running MCMC-PT iteration number: 13400 of 40000. Chain number 4. Current logpost: -361.423. Length of jump: 6.          Running MCMC-PT iteration number: 13500 of 40000. Chain number 1. Current logpost: -358.886. Length of jump: 4.          Running MCMC-PT iteration number: 13600 of 40000. Chain number 3. Current logpost: -361.323. Length of jump: 5.          Running MCMC-PT iteration number: 13500 of 40000. Chain number 2. Current logpost: -361.706. Length of jump: 5.          Running MCMC-PT iteration number: 13500 of 40000. Chain number 4. Current logpost: -361.174. Length of jump: 6.          Running MCMC-PT iteration number: 13600 of 40000. Chain number 1. Current logpost: -359.868. Length of jump: 5.          Running MCMC-PT iteration number: 13700 of 40000. Chain number 3. Current logpost: -360.997. Length of jump: 5.          Running MCMC-PT iteration number: 13600 of 40000. Chain number 2. Current logpost: -360.923. Length of jump: 5.          Running MCMC-PT iteration number: 13600 of 40000. Chain number 4. Current logpost: -360.644. Length of jump: 5.          Running MCMC-PT iteration number: 13700 of 40000. Chain number 1. Current logpost: -359.478. Length of jump: 4.          Running MCMC-PT iteration number: 13800 of 40000. Chain number 3. Current logpost: -360.391. Length of jump: 5.          Running MCMC-PT iteration number: 13700 of 40000. Chain number 2. Current logpost: -361.532. Length of jump: 4.          Running MCMC-PT iteration number: 13700 of 40000. Chain number 4. Current logpost: -360.806. Length of jump: 5.          Running MCMC-PT iteration number: 13800 of 40000. Chain number 1. Current logpost: -360.106. Length of jump: 4.          Running MCMC-PT iteration number: 13900 of 40000. Chain number 3. Current logpost: -361.235. Length of jump: 5.          Running MCMC-PT iteration number: 13800 of 40000. Chain number 2. Current logpost: -360.32. Length of jump: 4.          Running MCMC-PT iteration number: 13800 of 40000. Chain number 4. Current logpost: -362.234. Length of jump: 5.          Running MCMC-PT iteration number: 13900 of 40000. Chain number 1. Current logpost: -360.384. Length of jump: 5.          Running MCMC-PT iteration number: 14000 of 40000. Chain number 3. Current logpost: -360.992. Length of jump: 5.          Running MCMC-PT iteration number: 13900 of 40000. Chain number 2. Current logpost: -361.936. Length of jump: 5.          Running MCMC-PT iteration number: 13900 of 40000. Chain number 4. Current logpost: -361.391. Length of jump: 4.          Running MCMC-PT iteration number: 14000 of 40000. Chain number 1. Current logpost: -359.748. Length of jump: 5.          Running MCMC-PT iteration number: 14100 of 40000. Chain number 3. Current logpost: -361.241. Length of jump: 4.          Running MCMC-PT iteration number: 14000 of 40000. Chain number 2. Current logpost: -360.594. Length of jump: 5.          Running MCMC-PT iteration number: 14000 of 40000. Chain number 4. Current logpost: -363.783. Length of jump: 4.          Running MCMC-PT iteration number: 14100 of 40000. Chain number 1. Current logpost: -360.532. Length of jump: 4.          Running MCMC-PT iteration number: 14200 of 40000. Chain number 3. Current logpost: -362.459. Length of jump: 3.          Running MCMC-PT iteration number: 14100 of 40000. Chain number 2. Current logpost: -360.5. Length of jump: 5.          Running MCMC-PT iteration number: 14100 of 40000. Chain number 4. Current logpost: -362.393. Length of jump: 4.          Running MCMC-PT iteration number: 14200 of 40000. Chain number 1. Current logpost: -362.213. Length of jump: 5.          Running MCMC-PT iteration number: 14300 of 40000. Chain number 3. Current logpost: -365.543. Length of jump: 4.          Running MCMC-PT iteration number: 14200 of 40000. Chain number 2. Current logpost: -362.346. Length of jump: 4.          Running MCMC-PT iteration number: 14200 of 40000. Chain number 4. Current logpost: -361.762. Length of jump: 5.          Running MCMC-PT iteration number: 14300 of 40000. Chain number 1. Current logpost: -362.461. Length of jump: 5.          Running MCMC-PT iteration number: 14400 of 40000. Chain number 3. Current logpost: -361.284. Length of jump: 4.          Running MCMC-PT iteration number: 14300 of 40000. Chain number 2. Current logpost: -362.148. Length of jump: 5.          Running MCMC-PT iteration number: 14300 of 40000. Chain number 4. Current logpost: -362.819. Length of jump: 6.          Running MCMC-PT iteration number: 14400 of 40000. Chain number 1. Current logpost: -362.513. Length of jump: 5.          Running MCMC-PT iteration number: 14500 of 40000. Chain number 3. Current logpost: -361.793. Length of jump: 4.          Running MCMC-PT iteration number: 14400 of 40000. Chain number 2. Current logpost: -361.281. Length of jump: 5.          Running MCMC-PT iteration number: 14400 of 40000. Chain number 4. Current logpost: -363.395. Length of jump: 6.          Running MCMC-PT iteration number: 14500 of 40000. Chain number 1. Current logpost: -362.636. Length of jump: 5.          Running MCMC-PT iteration number: 14600 of 40000. Chain number 3. Current logpost: -361.31. Length of jump: 4.          Running MCMC-PT iteration number: 14500 of 40000. Chain number 2. Current logpost: -362.622. Length of jump: 4.          Running MCMC-PT iteration number: 14500 of 40000. Chain number 4. Current logpost: -360.25. Length of jump: 4.          Running MCMC-PT iteration number: 14600 of 40000. Chain number 1. Current logpost: -361.147. Length of jump: 6.          Running MCMC-PT iteration number: 14700 of 40000. Chain number 3. Current logpost: -361.894. Length of jump: 4.          Running MCMC-PT iteration number: 14600 of 40000. Chain number 2. Current logpost: -360.081. Length of jump: 4.          Running MCMC-PT iteration number: 14600 of 40000. Chain number 4. Current logpost: -361.143. Length of jump: 3.          Running MCMC-PT iteration number: 14700 of 40000. Chain number 1. Current logpost: -360.809. Length of jump: 5.          Running MCMC-PT iteration number: 14800 of 40000. Chain number 3. Current logpost: -360.319. Length of jump: 4.          Running MCMC-PT iteration number: 14700 of 40000. Chain number 2. Current logpost: -361.096. Length of jump: 5.          Running MCMC-PT iteration number: 14700 of 40000. Chain number 4. Current logpost: -361.841. Length of jump: 3.          Running MCMC-PT iteration number: 14800 of 40000. Chain number 1. Current logpost: -360.533. Length of jump: 4.          Running MCMC-PT iteration number: 14900 of 40000. Chain number 3. Current logpost: -363.31. Length of jump: 6.          Running MCMC-PT iteration number: 14800 of 40000. Chain number 2. Current logpost: -360.038. Length of jump: 5.          Running MCMC-PT iteration number: 14800 of 40000. Chain number 4. Current logpost: -361.34. Length of jump: 3.          Running MCMC-PT iteration number: 14900 of 40000. Chain number 1. Current logpost: -361.917. Length of jump: 5.          Running MCMC-PT iteration number: 15000 of 40000. Chain number 3. Current logpost: -361.482. Length of jump: 6.          Running MCMC-PT iteration number: 14900 of 40000. Chain number 2. Current logpost: -359.987. Length of jump: 4.          Running MCMC-PT iteration number: 14900 of 40000. Chain number 4. Current logpost: -358.727. Length of jump: 4.          Running MCMC-PT iteration number: 15000 of 40000. Chain number 1. Current logpost: -360.758. Length of jump: 4.          Running MCMC-PT iteration number: 15100 of 40000. Chain number 3. Current logpost: -361.722. Length of jump: 6.          Running MCMC-PT iteration number: 15000 of 40000. Chain number 2. Current logpost: -360.835. Length of jump: 4.          Running MCMC-PT iteration number: 15000 of 40000. Chain number 4. Current logpost: -360.335. Length of jump: 4.          Running MCMC-PT iteration number: 15100 of 40000. Chain number 1. Current logpost: -360.4. Length of jump: 5.          Running MCMC-PT iteration number: 15200 of 40000. Chain number 3. Current logpost: -361.365. Length of jump: 5.          Running MCMC-PT iteration number: 15100 of 40000. Chain number 2. Current logpost: -363.79. Length of jump: 3.          Running MCMC-PT iteration number: 15100 of 40000. Chain number 4. Current logpost: -360.588. Length of jump: 4.          Running MCMC-PT iteration number: 15200 of 40000. Chain number 1. Current logpost: -360.682. Length of jump: 4.          Running MCMC-PT iteration number: 15300 of 40000. Chain number 3. Current logpost: -360.72. Length of jump: 4.          Running MCMC-PT iteration number: 15200 of 40000. Chain number 2. Current logpost: -366.901. Length of jump: 4.          Running MCMC-PT iteration number: 15200 of 40000. Chain number 4. Current logpost: -358.778. Length of jump: 4.          Running MCMC-PT iteration number: 15300 of 40000. Chain number 1. Current logpost: -360.972. Length of jump: 4.          Running MCMC-PT iteration number: 15400 of 40000. Chain number 3. Current logpost: -360.092. Length of jump: 4.          Running MCMC-PT iteration number: 15300 of 40000. Chain number 2. Current logpost: -362.777. Length of jump: 5.          Running MCMC-PT iteration number: 15300 of 40000. Chain number 4. Current logpost: -359.774. Length of jump: 4.          Running MCMC-PT iteration number: 15400 of 40000. Chain number 1. Current logpost: -360.595. Length of jump: 5.          Running MCMC-PT iteration number: 15500 of 40000. Chain number 3. Current logpost: -357.664. Length of jump: 5.          Running MCMC-PT iteration number: 15400 of 40000. Chain number 2. Current logpost: -362.44. Length of jump: 4.          Running MCMC-PT iteration number: 15400 of 40000. Chain number 4. Current logpost: -358.429. Length of jump: 4.          Running MCMC-PT iteration number: 15500 of 40000. Chain number 1. Current logpost: -360.407. Length of jump: 6.          Running MCMC-PT iteration number: 15600 of 40000. Chain number 3. Current logpost: -357.142. Length of jump: 6.          Running MCMC-PT iteration number: 15500 of 40000. Chain number 2. Current logpost: -362.267. Length of jump: 4.          Running MCMC-PT iteration number: 15500 of 40000. Chain number 4. Current logpost: -358.97. Length of jump: 4.          Running MCMC-PT iteration number: 15600 of 40000. Chain number 1. Current logpost: -360.846. Length of jump: 6.          Running MCMC-PT iteration number: 15700 of 40000. Chain number 3. Current logpost: -356.931. Length of jump: 6.          Running MCMC-PT iteration number: 15600 of 40000. Chain number 2. Current logpost: -361.297. Length of jump: 4.          Running MCMC-PT iteration number: 15600 of 40000. Chain number 4. Current logpost: -358.045. Length of jump: 4.          Running MCMC-PT iteration number: 15700 of 40000. Chain number 1. Current logpost: -364.226. Length of jump: 6.          Running MCMC-PT iteration number: 15800 of 40000. Chain number 3. Current logpost: -357.515. Length of jump: 6.          Running MCMC-PT iteration number: 15700 of 40000. Chain number 2. Current logpost: -361.461. Length of jump: 3.          Running MCMC-PT iteration number: 15700 of 40000. Chain number 4. Current logpost: -357.267. Length of jump: 5.          Running MCMC-PT iteration number: 15800 of 40000. Chain number 1. Current logpost: -362.879. Length of jump: 6.          Running MCMC-PT iteration number: 15800 of 40000. Chain number 2. Current logpost: -361.243. Length of jump: 3.          Running MCMC-PT iteration number: 15900 of 40000. Chain number 3. Current logpost: -356.297. Length of jump: 6.          Running MCMC-PT iteration number: 15800 of 40000. Chain number 4. Current logpost: -358.573. Length of jump: 6.          Running MCMC-PT iteration number: 15900 of 40000. Chain number 1. Current logpost: -361.133. Length of jump: 6.          Running MCMC-PT iteration number: 15900 of 40000. Chain number 2. Current logpost: -360.773. Length of jump: 3.          Running MCMC-PT iteration number: 16000 of 40000. Chain number 3. Current logpost: -357.515. Length of jump: 6.          Running MCMC-PT iteration number: 15900 of 40000. Chain number 4. Current logpost: -356.975. Length of jump: 6.          Running MCMC-PT iteration number: 16000 of 40000. Chain number 1. Current logpost: -360.037. Length of jump: 5.          Running MCMC-PT iteration number: 16000 of 40000. Chain number 4. Current logpost: -360.187. Length of jump: 6.          Running MCMC-PT iteration number: 16100 of 40000. Chain number 4. Current logpost: -365.469. Length of jump: 7.          Running MCMC-PT iteration number: 16200 of 40000. Chain number 3. Current logpost: -357.254. Length of jump: 6.          Running MCMC-PT iteration number: 16200 of 40000. Chain number 4. Current logpost: -360.793. Length of jump: 6.          Running MCMC-PT iteration number: 16300 of 40000. Chain number 1. Current logpost: -360.373. Length of jump: 5.          Running MCMC-PT iteration number: 16300 of 40000. Chain number 2. Current logpost: -361.016. Length of jump: 3.          Running MCMC-PT iteration number: 16400 of 40000. Chain number 3. Current logpost: -356.785. Length of jump: 6.          Running MCMC-PT iteration number: 16300 of 40000. Chain number 4. Current logpost: -358.986. Length of jump: 6.          Running MCMC-PT iteration number: 16400 of 40000. Chain number 1. Current logpost: -359.928. Length of jump: 5.          Running MCMC-PT iteration number: 16400 of 40000. Chain number 2. Current logpost: -362.49. Length of jump: 3.          Running MCMC-PT iteration number: 16400 of 40000. Chain number 4. Current logpost: -360.076. Length of jump: 6.          Running MCMC-PT iteration number: 16500 of 40000. Chain number 3. Current logpost: -356.204. Length of jump: 6.          Running MCMC-PT iteration number: 16500 of 40000. Chain number 1. Current logpost: -361.101. Length of jump: 5.          Running MCMC-PT iteration number: 16500 of 40000. Chain number 2. Current logpost: -358.416. Length of jump: 4.          Running MCMC-PT iteration number: 16500 of 40000. Chain number 4. Current logpost: -357.521. Length of jump: 6.          Running MCMC-PT iteration number: 16600 of 40000. Chain number 3. Current logpost: -356.966. Length of jump: 6.          Running MCMC-PT iteration number: 16600 of 40000. Chain number 1. Current logpost: -360.558. Length of jump: 4.          Running MCMC-PT iteration number: 16600 of 40000. Chain number 2. Current logpost: -358.628. Length of jump: 4.          Running MCMC-PT iteration number: 16600 of 40000. Chain number 4. Current logpost: -360.402. Length of jump: 6.          Running MCMC-PT iteration number: 16700 of 40000. Chain number 3. Current logpost: -359.285. Length of jump: 6.          Running MCMC-PT iteration number: 16700 of 40000. Chain number 1. Current logpost: -360.114. Length of jump: 5.          Running MCMC-PT iteration number: 16700 of 40000. Chain number 2. Current logpost: -360.427. Length of jump: 4.          Running MCMC-PT iteration number: 16700 of 40000. Chain number 4. Current logpost: -362.238. Length of jump: 7.          Running MCMC-PT iteration number: 16800 of 40000. Chain number 3. Current logpost: -362.588. Length of jump: 7.          Running MCMC-PT iteration number: 16800 of 40000. Chain number 1. Current logpost: -359.796. Length of jump: 6.          Running MCMC-PT iteration number: 16800 of 40000. Chain number 2. Current logpost: -360.087. Length of jump: 4.          Running MCMC-PT iteration number: 16800 of 40000. Chain number 4. Current logpost: -360.208. Length of jump: 7.          Running MCMC-PT iteration number: 16900 of 40000. Chain number 3. Current logpost: -360.892. Length of jump: 6.          Running MCMC-PT iteration number: 16900 of 40000. Chain number 1. Current logpost: -360.738. Length of jump: 6.          Running MCMC-PT iteration number: 16900 of 40000. Chain number 2. Current logpost: -358.805. Length of jump: 4.          Running MCMC-PT iteration number: 16900 of 40000. Chain number 4. Current logpost: -357.735. Length of jump: 7.          Running MCMC-PT iteration number: 17000 of 40000. Chain number 3. Current logpost: -356.296. Length of jump: 6.          Running MCMC-PT iteration number: 17000 of 40000. Chain number 1. Current logpost: -363.455. Length of jump: 7.          Running MCMC-PT iteration number: 17000 of 40000. Chain number 2. Current logpost: -358.369. Length of jump: 4.          Running MCMC-PT iteration number: 17000 of 40000. Chain number 4. Current logpost: -359.369. Length of jump: 7.          Running MCMC-PT iteration number: 17100 of 40000. Chain number 3. Current logpost: -362.412. Length of jump: 7.          Running MCMC-PT iteration number: 17100 of 40000. Chain number 1. Current logpost: -364.4. Length of jump: 7.          Running MCMC-PT iteration number: 17100 of 40000. Chain number 2. Current logpost: -360.288. Length of jump: 6.          Running MCMC-PT iteration number: 17200 of 40000. Chain number 3. Current logpost: -357.6. Length of jump: 7.          Running MCMC-PT iteration number: 17100 of 40000. Chain number 4. Current logpost: -356.8. Length of jump: 6.          Running MCMC-PT iteration number: 17200 of 40000. Chain number 1. Current logpost: -363.032. Length of jump: 6.          Running MCMC-PT iteration number: 17200 of 40000. Chain number 2. Current logpost: -358.96. Length of jump: 7.          Running MCMC-PT iteration number: 17300 of 40000. Chain number 3. Current logpost: -355.873. Length of jump: 6.          Running MCMC-PT iteration number: 17200 of 40000. Chain number 4. Current logpost: -357.139. Length of jump: 8.          Running MCMC-PT iteration number: 17300 of 40000. Chain number 1. Current logpost: -361.783. Length of jump: 7.          Running MCMC-PT iteration number: 17300 of 40000. Chain number 2. Current logpost: -358.16. Length of jump: 6.          Running MCMC-PT iteration number: 17300 of 40000. Chain number 4. Current logpost: -357.318. Length of jump: 8.          Running MCMC-PT iteration number: 17400 of 40000. Chain number 3. Current logpost: -356.153. Length of jump: 6.          Running MCMC-PT iteration number: 17400 of 40000. Chain number 1. Current logpost: -362.852. Length of jump: 6.          Running MCMC-PT iteration number: 17400 of 40000. Chain number 4. Current logpost: -358.645. Length of jump: 8.          Running MCMC-PT iteration number: 17500 of 40000. Chain number 1. Current logpost: -361.805. Length of jump: 6.          Running MCMC-PT iteration number: 17500 of 40000. Chain number 2. Current logpost: -362.042. Length of jump: 6.          Running MCMC-PT iteration number: 17600 of 40000. Chain number 3. Current logpost: -356.603. Length of jump: 6.          Running MCMC-PT iteration number: 17500 of 40000. Chain number 4. Current logpost: -361.884. Length of jump: 8.          Running MCMC-PT iteration number: 17600 of 40000. Chain number 1. Current logpost: -361.13. Length of jump: 5.          Running MCMC-PT iteration number: 17600 of 40000. Chain number 2. Current logpost: -358.357. Length of jump: 4.          Running MCMC-PT iteration number: 17700 of 40000. Chain number 3. Current logpost: -362.029. Length of jump: 7.          Running MCMC-PT iteration number: 17600 of 40000. Chain number 4. Current logpost: -359.446. Length of jump: 7.          Running MCMC-PT iteration number: 17700 of 40000. Chain number 1. Current logpost: -362.123. Length of jump: 6.          Running MCMC-PT iteration number: 17700 of 40000. Chain number 2. Current logpost: -358.731. Length of jump: 4.          Running MCMC-PT iteration number: 17800 of 40000. Chain number 3. Current logpost: -357.035. Length of jump: 6.          Running MCMC-PT iteration number: 17700 of 40000. Chain number 4. Current logpost: -356.989. Length of jump: 7.          Running MCMC-PT iteration number: 17800 of 40000. Chain number 1. Current logpost: -360.106. Length of jump: 5.          Running MCMC-PT iteration number: 17800 of 40000. Chain number 2. Current logpost: -360.907. Length of jump: 5.          Running MCMC-PT iteration number: 17800 of 40000. Chain number 4. Current logpost: -354.633. Length of jump: 8.          Running MCMC-PT iteration number: 17900 of 40000. Chain number 3. Current logpost: -358.181. Length of jump: 5.          Running MCMC-PT iteration number: 17900 of 40000. Chain number 1. Current logpost: -360.224. Length of jump: 4.          Running MCMC-PT iteration number: 17900 of 40000. Chain number 2. Current logpost: -362.842. Length of jump: 4.          Running MCMC-PT iteration number: 17900 of 40000. Chain number 4. Current logpost: -354.362. Length of jump: 8.          Running MCMC-PT iteration number: 18000 of 40000. Chain number 3. Current logpost: -357.98. Length of jump: 5.          Running MCMC-PT iteration number: 18000 of 40000. Chain number 1. Current logpost: -360.799. Length of jump: 4.          Running MCMC-PT iteration number: 18000 of 40000. Chain number 2. Current logpost: -362.298. Length of jump: 4.          Running MCMC-PT iteration number: 18100 of 40000. Chain number 3. Current logpost: -362.081. Length of jump: 7.          Running MCMC-PT iteration number: 18000 of 40000. Chain number 4. Current logpost: -354.736. Length of jump: 8.          Running MCMC-PT iteration number: 18100 of 40000. Chain number 1. Current logpost: -361.142. Length of jump: 4.          Running MCMC-PT iteration number: 18100 of 40000. Chain number 2. Current logpost: -360.192. Length of jump: 5.          Running MCMC-PT iteration number: 18200 of 40000. Chain number 3. Current logpost: -359.738. Length of jump: 7.          Running MCMC-PT iteration number: 18100 of 40000. Chain number 4. Current logpost: -357.094. Length of jump: 9.          Running MCMC-PT iteration number: 18200 of 40000. Chain number 1. Current logpost: -361.608. Length of jump: 4.          Running MCMC-PT iteration number: 18200 of 40000. Chain number 4. Current logpost: -359.005. Length of jump: 9.          Running MCMC-PT iteration number: 18300 of 40000. Chain number 3. Current logpost: -361.401. Length of jump: 7.          Running MCMC-PT iteration number: 18300 of 40000. Chain number 1. Current logpost: -360.326. Length of jump: 5.          Running MCMC-PT iteration number: 18300 of 40000. Chain number 2. Current logpost: -360.874. Length of jump: 5.          Running MCMC-PT iteration number: 18400 of 40000. Chain number 3. Current logpost: -357.793. Length of jump: 5.          Running MCMC-PT iteration number: 18300 of 40000. Chain number 4. Current logpost: -358.225. Length of jump: 6.          Running MCMC-PT iteration number: 18400 of 40000. Chain number 1. Current logpost: -360.394. Length of jump: 5.          Running MCMC-PT iteration number: 18400 of 40000. Chain number 2. Current logpost: -360.421. Length of jump: 5.          Running MCMC-PT iteration number: 18500 of 40000. Chain number 3. Current logpost: -358.954. Length of jump: 4.          Running MCMC-PT iteration number: 18400 of 40000. Chain number 4. Current logpost: -357.131. Length of jump: 7.          Running MCMC-PT iteration number: 18500 of 40000. Chain number 1. Current logpost: -360.049. Length of jump: 5.          Running MCMC-PT iteration number: 18500 of 40000. Chain number 2. Current logpost: -362.308. Length of jump: 5.          Running MCMC-PT iteration number: 18600 of 40000. Chain number 3. Current logpost: -358.806. Length of jump: 4.          Running MCMC-PT iteration number: 18500 of 40000. Chain number 4. Current logpost: -358.357. Length of jump: 7.          Running MCMC-PT iteration number: 18600 of 40000. Chain number 1. Current logpost: -359.776. Length of jump: 5.          Running MCMC-PT iteration number: 18600 of 40000. Chain number 2. Current logpost: -364.444. Length of jump: 7.          Running MCMC-PT iteration number: 18700 of 40000. Chain number 3. Current logpost: -359.167. Length of jump: 4.          Running MCMC-PT iteration number: 18600 of 40000. Chain number 4. Current logpost: -360.05. Length of jump: 8.          Running MCMC-PT iteration number: 18700 of 40000. Chain number 1. Current logpost: -360.247. Length of jump: 4.          Running MCMC-PT iteration number: 18700 of 40000. Chain number 2. Current logpost: -365.337. Length of jump: 7.          Running MCMC-PT iteration number: 18800 of 40000. Chain number 3. Current logpost: -358.779. Length of jump: 4.          Running MCMC-PT iteration number: 18700 of 40000. Chain number 4. Current logpost: -358.5. Length of jump: 7.          Running MCMC-PT iteration number: 18800 of 40000. Chain number 1. Current logpost: -363.609. Length of jump: 5.          Running MCMC-PT iteration number: 18800 of 40000. Chain number 2. Current logpost: -361.346. Length of jump: 6.          Running MCMC-PT iteration number: 18900 of 40000. Chain number 3. Current logpost: -359.837. Length of jump: 4.          Running MCMC-PT iteration number: 18800 of 40000. Chain number 4. Current logpost: -359.628. Length of jump: 8.          Running MCMC-PT iteration number: 18900 of 40000. Chain number 1. Current logpost: -363.934. Length of jump: 5.          Running MCMC-PT iteration number: 18900 of 40000. Chain number 2. Current logpost: -362.273. Length of jump: 7.          Running MCMC-PT iteration number: 19000 of 40000. Chain number 3. Current logpost: -358.55. Length of jump: 4.          Running MCMC-PT iteration number: 18900 of 40000. Chain number 4. Current logpost: -359.339. Length of jump: 8.          Running MCMC-PT iteration number: 19000 of 40000. Chain number 1. Current logpost: -367.903. Length of jump: 5.          Running MCMC-PT iteration number: 19000 of 40000. Chain number 2. Current logpost: -361.235. Length of jump: 6.          Running MCMC-PT iteration number: 19100 of 40000. Chain number 3. Current logpost: -358.723. Length of jump: 5.          Running MCMC-PT iteration number: 19100 of 40000. Chain number 1. Current logpost: -367.037. Length of jump: 5.          Running MCMC-PT iteration number: 19000 of 40000. Chain number 4. Current logpost: -359.98. Length of jump: 9.          Running MCMC-PT iteration number: 19200 of 40000. Chain number 3. Current logpost: -360.369. Length of jump: 7.          Running MCMC-PT iteration number: 19200 of 40000. Chain number 1. Current logpost: -362.129. Length of jump: 4.          Running MCMC-PT iteration number: 19100 of 40000. Chain number 4. Current logpost: -359.067. Length of jump: 8.          Running MCMC-PT iteration number: 19200 of 40000. Chain number 2. Current logpost: -363.973. Length of jump: 6.          Running MCMC-PT iteration number: 19300 of 40000. Chain number 3. Current logpost: -359.075. Length of jump: 7.          Running MCMC-PT iteration number: 19300 of 40000. Chain number 1. Current logpost: -360.758. Length of jump: 4.          Running MCMC-PT iteration number: 19200 of 40000. Chain number 4. Current logpost: -358.239. Length of jump: 9.          Running MCMC-PT iteration number: 19300 of 40000. Chain number 2. Current logpost: -363.688. Length of jump: 6.          Running MCMC-PT iteration number: 19400 of 40000. Chain number 3. Current logpost: -359.309. Length of jump: 7.          Running MCMC-PT iteration number: 19400 of 40000. Chain number 1. Current logpost: -360.627. Length of jump: 4.          Running MCMC-PT iteration number: 19300 of 40000. Chain number 4. Current logpost: -358.963. Length of jump: 10.          Running MCMC-PT iteration number: 19400 of 40000. Chain number 2. Current logpost: -363.082. Length of jump: 5.          Running MCMC-PT iteration number: 19500 of 40000. Chain number 3. Current logpost: -358.702. Length of jump: 4.          Running MCMC-PT iteration number: 19500 of 40000. Chain number 1. Current logpost: -361.186. Length of jump: 5.          Running MCMC-PT iteration number: 19400 of 40000. Chain number 4. Current logpost: -358.5. Length of jump: 8.          Running MCMC-PT iteration number: 19500 of 40000. Chain number 2. Current logpost: -361.971. Length of jump: 5.          Running MCMC-PT iteration number: 19600 of 40000. Chain number 3. Current logpost: -359.223. Length of jump: 4.          Running MCMC-PT iteration number: 19600 of 40000. Chain number 1. Current logpost: -362.471. Length of jump: 5.          Running MCMC-PT iteration number: 19500 of 40000. Chain number 4. Current logpost: -361.301. Length of jump: 7.          Running MCMC-PT iteration number: 19600 of 40000. Chain number 4. Current logpost: -358.838. Length of jump: 7.          Running MCMC-PT iteration number: 19700 of 40000. Chain number 4. Current logpost: -358.197. Length of jump: 7.          Running MCMC-PT iteration number: 19800 of 40000. Chain number 2. Current logpost: -360.975. Length of jump: 3.          Running MCMC-PT iteration number: 19900 of 40000. Chain number 3. Current logpost: -361.547. Length of jump: 4.          Running MCMC-PT iteration number: 19900 of 40000. Chain number 1. Current logpost: -363.18. Length of jump: 5.          Running MCMC-PT iteration number: 19800 of 40000. Chain number 4. Current logpost: -358.143. Length of jump: 7.          Running MCMC-PT iteration number: 19900 of 40000. Chain number 2. Current logpost: -359.361. Length of jump: 5.          Running MCMC-PT iteration number: 20000 of 40000. Chain number 2. Current logpost: -361.904. Length of jump: 7.          Running MCMC-PT iteration number: 20100 of 40000. Chain number 3. Current logpost: -356.943. Length of jump: 6.          Running MCMC-PT iteration number: 20100 of 40000. Chain number 1. Current logpost: -360.816. Length of jump: 4.          Running MCMC-PT iteration number: 20000 of 40000. Chain number 4. Current logpost: -358.408. Length of jump: 6.          Running MCMC-PT iteration number: 20100 of 40000. Chain number 2. Current logpost: -360.617. Length of jump: 7.          Running MCMC-PT iteration number: 20200 of 40000. Chain number 3. Current logpost: -357.608. Length of jump: 6.          Running MCMC-PT iteration number: 20200 of 40000. Chain number 1. Current logpost: -360.906. Length of jump: 4.          Running MCMC-PT iteration number: 20100 of 40000. Chain number 4. Current logpost: -358.832. Length of jump: 6.          Running MCMC-PT iteration number: 20200 of 40000. Chain number 2. Current logpost: -362.381. Length of jump: 7.          Running MCMC-PT iteration number: 20300 of 40000. Chain number 3. Current logpost: -359.031. Length of jump: 7.          Running MCMC-PT iteration number: 20300 of 40000. Chain number 1. Current logpost: -360.614. Length of jump: 5.          Running MCMC-PT iteration number: 20200 of 40000. Chain number 4. Current logpost: -358.539. Length of jump: 6.          Running MCMC-PT iteration number: 20300 of 40000. Chain number 2. Current logpost: -362.668. Length of jump: 7.          Running MCMC-PT iteration number: 20400 of 40000. Chain number 3. Current logpost: -359.915. Length of jump: 5.          Running MCMC-PT iteration number: 20400 of 40000. Chain number 1. Current logpost: -360.64. Length of jump: 6.          Running MCMC-PT iteration number: 20300 of 40000. Chain number 4. Current logpost: -358.379. Length of jump: 6.          Running MCMC-PT iteration number: 20400 of 40000. Chain number 2. Current logpost: -360.886. Length of jump: 7.          Running MCMC-PT iteration number: 20500 of 40000. Chain number 2. Current logpost: -362.371. Length of jump: 7.          Running MCMC-PT iteration number: 20600 of 40000. Chain number 3. Current logpost: -360.887. Length of jump: 6.          Running MCMC-PT iteration number: 20600 of 40000. Chain number 1. Current logpost: -361.043. Length of jump: 4.          Running MCMC-PT iteration number: 20500 of 40000. Chain number 4. Current logpost: -357.263. Length of jump: 6.          Running MCMC-PT iteration number: 20600 of 40000. Chain number 2. Current logpost: -361.002. Length of jump: 5.          Running MCMC-PT iteration number: 20700 of 40000. Chain number 1. Current logpost: -361.568. Length of jump: 4.          Running MCMC-PT iteration number: 20600 of 40000. Chain number 4. Current logpost: -358.593. Length of jump: 7.          Running MCMC-PT iteration number: 20700 of 40000. Chain number 2. Current logpost: -361.986. Length of jump: 5.          Running MCMC-PT iteration number: 20800 of 40000. Chain number 3. Current logpost: -357.784. Length of jump: 6.          Running MCMC-PT iteration number: 20800 of 40000. Chain number 1. Current logpost: -360.002. Length of jump: 4.          Running MCMC-PT iteration number: 20700 of 40000. Chain number 4. Current logpost: -358.825. Length of jump: 7.          Running MCMC-PT iteration number: 20800 of 40000. Chain number 2. Current logpost: -361.497. Length of jump: 5.          Running MCMC-PT iteration number: 20900 of 40000. Chain number 3. Current logpost: -357.246. Length of jump: 6.          Running MCMC-PT iteration number: 20900 of 40000. Chain number 1. Current logpost: -359.876. Length of jump: 5.          Running MCMC-PT iteration number: 20800 of 40000. Chain number 4. Current logpost: -359.55. Length of jump: 7.          Running MCMC-PT iteration number: 20900 of 40000. Chain number 2. Current logpost: -361.426. Length of jump: 5.          Running MCMC-PT iteration number: 21000 of 40000. Chain number 3. Current logpost: -357.447. Length of jump: 6.          Running MCMC-PT iteration number: 21000 of 40000. Chain number 1. Current logpost: -365.202. Length of jump: 7.          Running MCMC-PT iteration number: 20900 of 40000. Chain number 4. Current logpost: -358.235. Length of jump: 6.          Running MCMC-PT iteration number: 21000 of 40000. Chain number 2. Current logpost: -362.382. Length of jump: 5.          Running MCMC-PT iteration number: 21100 of 40000. Chain number 3. Current logpost: -360.466. Length of jump: 6.          Running MCMC-PT iteration number: 21100 of 40000. Chain number 1. Current logpost: -362.588. Length of jump: 7.          Running MCMC-PT iteration number: 21000 of 40000. Chain number 4. Current logpost: -357.724. Length of jump: 6.          Running MCMC-PT iteration number: 21100 of 40000. Chain number 2. Current logpost: -362.789. Length of jump: 5.          Running MCMC-PT iteration number: 21200 of 40000. Chain number 3. Current logpost: -356.504. Length of jump: 6.          Running MCMC-PT iteration number: 21200 of 40000. Chain number 1. Current logpost: -363.694. Length of jump: 7.          Running MCMC-PT iteration number: 21100 of 40000. Chain number 4. Current logpost: -361.157. Length of jump: 5.          Running MCMC-PT iteration number: 21200 of 40000. Chain number 2. Current logpost: -364.73. Length of jump: 5.          Running MCMC-PT iteration number: 21300 of 40000. Chain number 3. Current logpost: -355.41. Length of jump: 7.          Running MCMC-PT iteration number: 21300 of 40000. Chain number 1. Current logpost: -364.103. Length of jump: 7.          Running MCMC-PT iteration number: 21200 of 40000. Chain number 4. Current logpost: -360.906. Length of jump: 4.          Running MCMC-PT iteration number: 21300 of 40000. Chain number 2. Current logpost: -364.673. Length of jump: 5.          Running MCMC-PT iteration number: 21400 of 40000. Chain number 3. Current logpost: -358.12. Length of jump: 6.          Running MCMC-PT iteration number: 21400 of 40000. Chain number 1. Current logpost: -362.42. Length of jump: 6.          Running MCMC-PT iteration number: 21300 of 40000. Chain number 4. Current logpost: -359.081. Length of jump: 4.          Running MCMC-PT iteration number: 21400 of 40000. Chain number 2. Current logpost: -361.621. Length of jump: 5.          Running MCMC-PT iteration number: 21500 of 40000. Chain number 3. Current logpost: -355.781. Length of jump: 6.          Running MCMC-PT iteration number: 21500 of 40000. Chain number 1. Current logpost: -365.796. Length of jump: 6.          Running MCMC-PT iteration number: 21400 of 40000. Chain number 4. Current logpost: -358.053. Length of jump: 5.          Running MCMC-PT iteration number: 21500 of 40000. Chain number 4. Current logpost: -356.77. Length of jump: 6.          Running MCMC-PT iteration number: 21600 of 40000. Chain number 2. Current logpost: -362.032. Length of jump: 4.          Running MCMC-PT iteration number: 21700 of 40000. Chain number 3. Current logpost: -357.043. Length of jump: 7.          Running MCMC-PT iteration number: 21700 of 40000. Chain number 1. Current logpost: -362.536. Length of jump: 5.          Running MCMC-PT iteration number: 21600 of 40000. Chain number 4. Current logpost: -356.817. Length of jump: 6.          Running MCMC-PT iteration number: 21700 of 40000. Chain number 2. Current logpost: -360.884. Length of jump: 5.          Running MCMC-PT iteration number: 21800 of 40000. Chain number 3. Current logpost: -355.537. Length of jump: 7.          Running MCMC-PT iteration number: 21800 of 40000. Chain number 1. Current logpost: -365.408. Length of jump: 5.          Running MCMC-PT iteration number: 21700 of 40000. Chain number 4. Current logpost: -356.337. Length of jump: 6.          Running MCMC-PT iteration number: 21800 of 40000. Chain number 2. Current logpost: -360.899. Length of jump: 6.          Running MCMC-PT iteration number: 21900 of 40000. Chain number 3. Current logpost: -356.21. Length of jump: 7.          Running MCMC-PT iteration number: 21900 of 40000. Chain number 1. Current logpost: -360.45. Length of jump: 5.          Running MCMC-PT iteration number: 21800 of 40000. Chain number 4. Current logpost: -356.994. Length of jump: 6.          Running MCMC-PT iteration number: 21900 of 40000. Chain number 2. Current logpost: -361.345. Length of jump: 6.          Running MCMC-PT iteration number: 22000 of 40000. Chain number 3. Current logpost: -354.721. Length of jump: 7.          Running MCMC-PT iteration number: 22000 of 40000. Chain number 1. Current logpost: -358.095. Length of jump: 4.          Running MCMC-PT iteration number: 21900 of 40000. Chain number 4. Current logpost: -356.643. Length of jump: 7.          Running MCMC-PT iteration number: 22000 of 40000. Chain number 2. Current logpost: -364.322. Length of jump: 7.          Running MCMC-PT iteration number: 22100 of 40000. Chain number 3. Current logpost: -355.852. Length of jump: 7.          Running MCMC-PT iteration number: 22100 of 40000. Chain number 1. Current logpost: -358.464. Length of jump: 4.          Running MCMC-PT iteration number: 22000 of 40000. Chain number 4. Current logpost: -356.348. Length of jump: 6.          Running MCMC-PT iteration number: 22100 of 40000. Chain number 2. Current logpost: -362.448. Length of jump: 6.          Running MCMC-PT iteration number: 22200 of 40000. Chain number 1. Current logpost: -361.038. Length of jump: 4.          Running MCMC-PT iteration number: 22100 of 40000. Chain number 4. Current logpost: -359.929. Length of jump: 7.          Running MCMC-PT iteration number: 22200 of 40000. Chain number 2. Current logpost: -362.207. Length of jump: 6.          Running MCMC-PT iteration number: 22300 of 40000. Chain number 3. Current logpost: -356.613. Length of jump: 8.          Running MCMC-PT iteration number: 22300 of 40000. Chain number 1. Current logpost: -359.275. Length of jump: 4.          Running MCMC-PT iteration number: 22200 of 40000. Chain number 4. Current logpost: -359.584. Length of jump: 8.          Running MCMC-PT iteration number: 22300 of 40000. Chain number 2. Current logpost: -361.281. Length of jump: 5.          Running MCMC-PT iteration number: 22400 of 40000. Chain number 3. Current logpost: -358.41. Length of jump: 8.          Running MCMC-PT iteration number: 22400 of 40000. Chain number 1. Current logpost: -358.558. Length of jump: 4.          Running MCMC-PT iteration number: 22300 of 40000. Chain number 4. Current logpost: -357.423. Length of jump: 8.          Running MCMC-PT iteration number: 22400 of 40000. Chain number 2. Current logpost: -359.851. Length of jump: 7.          Running MCMC-PT iteration number: 22500 of 40000. Chain number 3. Current logpost: -358.509. Length of jump: 7.          Running MCMC-PT iteration number: 22500 of 40000. Chain number 1. Current logpost: -358.785. Length of jump: 4.          Running MCMC-PT iteration number: 22400 of 40000. Chain number 4. Current logpost: -358.681. Length of jump: 8.          Running MCMC-PT iteration number: 22500 of 40000. Chain number 2. Current logpost: -358.634. Length of jump: 6.          Running MCMC-PT iteration number: 22600 of 40000. Chain number 3. Current logpost: -357.972. Length of jump: 6.          Running MCMC-PT iteration number: 22600 of 40000. Chain number 1. Current logpost: -358.521. Length of jump: 5.          Running MCMC-PT iteration number: 22500 of 40000. Chain number 4. Current logpost: -360.145. Length of jump: 7.          Running MCMC-PT iteration number: 22600 of 40000. Chain number 2. Current logpost: -364.331. Length of jump: 8.          Running MCMC-PT iteration number: 22700 of 40000. Chain number 3. Current logpost: -356.424. Length of jump: 7.          Running MCMC-PT iteration number: 22700 of 40000. Chain number 1. Current logpost: -360.16. Length of jump: 6.          Running MCMC-PT iteration number: 22600 of 40000. Chain number 4. Current logpost: -357.463. Length of jump: 7.          Running MCMC-PT iteration number: 22700 of 40000. Chain number 2. Current logpost: -359.829. Length of jump: 8.          Running MCMC-PT iteration number: 22800 of 40000. Chain number 3. Current logpost: -356.386. Length of jump: 7.          Running MCMC-PT iteration number: 22800 of 40000. Chain number 1. Current logpost: -359.697. Length of jump: 6.          Running MCMC-PT iteration number: 22700 of 40000. Chain number 4. Current logpost: -357.105. Length of jump: 6.          Running MCMC-PT iteration number: 22800 of 40000. Chain number 2. Current logpost: -358.398. Length of jump: 8.          Running MCMC-PT iteration number: 22900 of 40000. Chain number 3. Current logpost: -356.449. Length of jump: 8.          Running MCMC-PT iteration number: 22900 of 40000. Chain number 1. Current logpost: -359.085. Length of jump: 5.          Running MCMC-PT iteration number: 22800 of 40000. Chain number 4. Current logpost: -358.186. Length of jump: 5.          Running MCMC-PT iteration number: 22900 of 40000. Chain number 2. Current logpost: -358.297. Length of jump: 8.          Running MCMC-PT iteration number: 23000 of 40000. Chain number 3. Current logpost: -359.023. Length of jump: 8.          Running MCMC-PT iteration number: 23000 of 40000. Chain number 1. Current logpost: -359.401. Length of jump: 4.          Running MCMC-PT iteration number: 22900 of 40000. Chain number 4. Current logpost: -360.489. Length of jump: 5.          Running MCMC-PT iteration number: 23000 of 40000. Chain number 2. Current logpost: -357.111. Length of jump: 7.          Running MCMC-PT iteration number: 23100 of 40000. Chain number 3. Current logpost: -355.924. Length of jump: 8.          Running MCMC-PT iteration number: 23100 of 40000. Chain number 1. Current logpost: -361.598. Length of jump: 3.          Running MCMC-PT iteration number: 23000 of 40000. Chain number 4. Current logpost: -359.652. Length of jump: 5.          Running MCMC-PT iteration number: 23100 of 40000. Chain number 2. Current logpost: -356.446. Length of jump: 7.          Running MCMC-PT iteration number: 23200 of 40000. Chain number 3. Current logpost: -356.788. Length of jump: 8.          Running MCMC-PT iteration number: 23200 of 40000. Chain number 1. Current logpost: -361.598. Length of jump: 3.          Running MCMC-PT iteration number: 23100 of 40000. Chain number 4. Current logpost: -359.327. Length of jump: 6.          Running MCMC-PT iteration number: 23200 of 40000. Chain number 2. Current logpost: -358.169. Length of jump: 7.          Running MCMC-PT iteration number: 23300 of 40000. Chain number 3. Current logpost: -355.443. Length of jump: 7.          Running MCMC-PT iteration number: 23300 of 40000. Chain number 1. Current logpost: -361.012. Length of jump: 3.          Running MCMC-PT iteration number: 23200 of 40000. Chain number 4. Current logpost: -359.789. Length of jump: 6.          Running MCMC-PT iteration number: 23300 of 40000. Chain number 2. Current logpost: -361.143. Length of jump: 8.          Running MCMC-PT iteration number: 23400 of 40000. Chain number 3. Current logpost: -356.699. Length of jump: 6.          Running MCMC-PT iteration number: 23400 of 40000. Chain number 1. Current logpost: -360.732. Length of jump: 4.          Running MCMC-PT iteration number: 23300 of 40000. Chain number 4. Current logpost: -358.968. Length of jump: 6.          Running MCMC-PT iteration number: 23400 of 40000. Chain number 2. Current logpost: -359.528. Length of jump: 8.          Running MCMC-PT iteration number: 23500 of 40000. Chain number 3. Current logpost: -356.865. Length of jump: 6.          Running MCMC-PT iteration number: 23400 of 40000. Chain number 4. Current logpost: -357.442. Length of jump: 6.          Running MCMC-PT iteration number: 23500 of 40000. Chain number 1. Current logpost: -360.965. Length of jump: 4.          Running MCMC-PT iteration number: 23500 of 40000. Chain number 2. Current logpost: -362.958. Length of jump: 8.          Running MCMC-PT iteration number: 23600 of 40000. Chain number 3. Current logpost: -358.356. Length of jump: 6.          Running MCMC-PT iteration number: 23600 of 40000. Chain number 1. Current logpost: -360.812. Length of jump: 4.          Running MCMC-PT iteration number: 23500 of 40000. Chain number 4. Current logpost: -357.689. Length of jump: 6.          Running MCMC-PT iteration number: 23600 of 40000. Chain number 2. Current logpost: -358.054. Length of jump: 7.          Running MCMC-PT iteration number: 23700 of 40000. Chain number 3. Current logpost: -355.775. Length of jump: 7.          Running MCMC-PT iteration number: 23700 of 40000. Chain number 1. Current logpost: -361.23. Length of jump: 6.          Running MCMC-PT iteration number: 23600 of 40000. Chain number 4. Current logpost: -359.669. Length of jump: 7.          Running MCMC-PT iteration number: 23700 of 40000. Chain number 2. Current logpost: -358.578. Length of jump: 7.          Running MCMC-PT iteration number: 23800 of 40000. Chain number 3. Current logpost: -357.288. Length of jump: 7.          Running MCMC-PT iteration number: 23800 of 40000. Chain number 1. Current logpost: -362.098. Length of jump: 7.          Running MCMC-PT iteration number: 23700 of 40000. Chain number 4. Current logpost: -357.538. Length of jump: 8.          Running MCMC-PT iteration number: 23800 of 40000. Chain number 2. Current logpost: -359.637. Length of jump: 7.          Running MCMC-PT iteration number: 23900 of 40000. Chain number 3. Current logpost: -355.533. Length of jump: 7.          Running MCMC-PT iteration number: 23900 of 40000. Chain number 1. Current logpost: -362.311. Length of jump: 6.          Running MCMC-PT iteration number: 23800 of 40000. Chain number 4. Current logpost: -359.73. Length of jump: 8.          Running MCMC-PT iteration number: 23900 of 40000. Chain number 2. Current logpost: -356.696. Length of jump: 8.          Running MCMC-PT iteration number: 24000 of 40000. Chain number 3. Current logpost: -354.882. Length of jump: 7.          Running MCMC-PT iteration number: 24000 of 40000. Chain number 1. Current logpost: -360.244. Length of jump: 5.          Running MCMC-PT iteration number: 23900 of 40000. Chain number 4. Current logpost: -357.964. Length of jump: 8.          Running MCMC-PT iteration number: 24000 of 40000. Chain number 2. Current logpost: -360.185. Length of jump: 8.          Running MCMC-PT iteration number: 24100 of 40000. Chain number 3. Current logpost: -357.966. Length of jump: 6.          Running MCMC-PT iteration number: 24100 of 40000. Chain number 1. Current logpost: -360.456. Length of jump: 5.          Running MCMC-PT iteration number: 24000 of 40000. Chain number 4. Current logpost: -356.43. Length of jump: 8.          Running MCMC-PT iteration number: 24100 of 40000. Chain number 2. Current logpost: -360.09. Length of jump: 8.          Running MCMC-PT iteration number: 24200 of 40000. Chain number 3. Current logpost: -358.162. Length of jump: 7.          Running MCMC-PT iteration number: 24200 of 40000. Chain number 1. Current logpost: -360.307. Length of jump: 5.          Running MCMC-PT iteration number: 24100 of 40000. Chain number 4. Current logpost: -355.821. Length of jump: 7.          Running MCMC-PT iteration number: 24200 of 40000. Chain number 2. Current logpost: -361.686. Length of jump: 8.          Running MCMC-PT iteration number: 24300 of 40000. Chain number 3. Current logpost: -358.675. Length of jump: 7.          Running MCMC-PT iteration number: 24300 of 40000. Chain number 1. Current logpost: -360.146. Length of jump: 5.          Running MCMC-PT iteration number: 24200 of 40000. Chain number 4. Current logpost: -355.89. Length of jump: 7.          Running MCMC-PT iteration number: 24300 of 40000. Chain number 2. Current logpost: -359.766. Length of jump: 8.          Running MCMC-PT iteration number: 24400 of 40000. Chain number 3. Current logpost: -357.058. Length of jump: 6.          Running MCMC-PT iteration number: 24400 of 40000. Chain number 1. Current logpost: -360.602. Length of jump: 6.          Running MCMC-PT iteration number: 24300 of 40000. Chain number 4. Current logpost: -357.037. Length of jump: 8.          Running MCMC-PT iteration number: 24400 of 40000. Chain number 2. Current logpost: -357.924. Length of jump: 8.          Running MCMC-PT iteration number: 24500 of 40000. Chain number 3. Current logpost: -356.212. Length of jump: 6.          Running MCMC-PT iteration number: 24500 of 40000. Chain number 1. Current logpost: -360.953. Length of jump: 5.          Running MCMC-PT iteration number: 24400 of 40000. Chain number 4. Current logpost: -359.436. Length of jump: 8.          Running MCMC-PT iteration number: 24500 of 40000. Chain number 2. Current logpost: -358.703. Length of jump: 8.          Running MCMC-PT iteration number: 24600 of 40000. Chain number 3. Current logpost: -363.407. Length of jump: 9.          Running MCMC-PT iteration number: 24600 of 40000. Chain number 1. Current logpost: -361.021. Length of jump: 5.          Running MCMC-PT iteration number: 24500 of 40000. Chain number 4. Current logpost: -356.998. Length of jump: 7.          Running MCMC-PT iteration number: 24600 of 40000. Chain number 2. Current logpost: -359.87. Length of jump: 6.          Running MCMC-PT iteration number: 24700 of 40000. Chain number 3. Current logpost: -361.498. Length of jump: 6.          Running MCMC-PT iteration number: 24800 of 40000. Chain number 3. Current logpost: -356.447. Length of jump: 7.          Running MCMC-PT iteration number: 24800 of 40000. Chain number 1. Current logpost: -364.971. Length of jump: 6.          Running MCMC-PT iteration number: 24700 of 40000. Chain number 4. Current logpost: -358.626. Length of jump: 8.          Running MCMC-PT iteration number: 24800 of 40000. Chain number 2. Current logpost: -360.58. Length of jump: 7.          Running MCMC-PT iteration number: 24900 of 40000. Chain number 3. Current logpost: -357.098. Length of jump: 7.          Running MCMC-PT iteration number: 24900 of 40000. Chain number 1. Current logpost: -361.06. Length of jump: 4.          Running MCMC-PT iteration number: 24800 of 40000. Chain number 4. Current logpost: -359.326. Length of jump: 8.          Running MCMC-PT iteration number: 24900 of 40000. Chain number 2. Current logpost: -358.765. Length of jump: 7.          Running MCMC-PT iteration number: 24900 of 40000. Chain number 4. Current logpost: -358.212. Length of jump: 8.          Running MCMC-PT iteration number: 25000 of 40000. Chain number 2. Current logpost: -357.07. Length of jump: 6.          Running MCMC-PT iteration number: 25100 of 40000. Chain number 3. Current logpost: -360.926. Length of jump: 8.          Running MCMC-PT iteration number: 25100 of 40000. Chain number 1. Current logpost: -362.214. Length of jump: 7.          Running MCMC-PT iteration number: 25000 of 40000. Chain number 4. Current logpost: -358.248. Length of jump: 7.          Running MCMC-PT iteration number: 25100 of 40000. Chain number 2. Current logpost: -357.942. Length of jump: 7.          Running MCMC-PT iteration number: 25200 of 40000. Chain number 3. Current logpost: -358.652. Length of jump: 7.          Running MCMC-PT iteration number: 25200 of 40000. Chain number 1. Current logpost: -359.509. Length of jump: 6.          Running MCMC-PT iteration number: 25100 of 40000. Chain number 4. Current logpost: -358.668. Length of jump: 7.          Running MCMC-PT iteration number: 25200 of 40000. Chain number 2. Current logpost: -355.978. Length of jump: 7.          Running MCMC-PT iteration number: 25300 of 40000. Chain number 3. Current logpost: -357.65. Length of jump: 6.          Running MCMC-PT iteration number: 25300 of 40000. Chain number 1. Current logpost: -362.597. Length of jump: 6.          Running MCMC-PT iteration number: 25200 of 40000. Chain number 4. Current logpost: -359.016. Length of jump: 7.          Running MCMC-PT iteration number: 25300 of 40000. Chain number 2. Current logpost: -354.795. Length of jump: 7.          Running MCMC-PT iteration number: 25400 of 40000. Chain number 3. Current logpost: -361.027. Length of jump: 7.          Running MCMC-PT iteration number: 25400 of 40000. Chain number 1. Current logpost: -362.583. Length of jump: 6.          Running MCMC-PT iteration number: 25300 of 40000. Chain number 4. Current logpost: -359.923. Length of jump: 7.          Running MCMC-PT iteration number: 25400 of 40000. Chain number 2. Current logpost: -358.387. Length of jump: 9.          Running MCMC-PT iteration number: 25500 of 40000. Chain number 3. Current logpost: -360.315. Length of jump: 8.          Running MCMC-PT iteration number: 25500 of 40000. Chain number 1. Current logpost: -362.04. Length of jump: 6.          Running MCMC-PT iteration number: 25400 of 40000. Chain number 4. Current logpost: -358.716. Length of jump: 7.          Running MCMC-PT iteration number: 25500 of 40000. Chain number 2. Current logpost: -355.199. Length of jump: 9.          Running MCMC-PT iteration number: 25600 of 40000. Chain number 3. Current logpost: -360.067. Length of jump: 8.          Running MCMC-PT iteration number: 25600 of 40000. Chain number 1. Current logpost: -359.446. Length of jump: 6.          Running MCMC-PT iteration number: 25500 of 40000. Chain number 4. Current logpost: -360.991. Length of jump: 7.          Running MCMC-PT iteration number: 25600 of 40000. Chain number 2. Current logpost: -356.614. Length of jump: 9.          Running MCMC-PT iteration number: 25700 of 40000. Chain number 3. Current logpost: -361.166. Length of jump: 8.          Running MCMC-PT iteration number: 25700 of 40000. Chain number 1. Current logpost: -361.088. Length of jump: 6.          Running MCMC-PT iteration number: 25600 of 40000. Chain number 4. Current logpost: -361.201. Length of jump: 7.          Running MCMC-PT iteration number: 25700 of 40000. Chain number 2. Current logpost: -356.664. Length of jump: 9.          Running MCMC-PT iteration number: 25800 of 40000. Chain number 3. Current logpost: -362.806. Length of jump: 7.          Running MCMC-PT iteration number: 25800 of 40000. Chain number 1. Current logpost: -358.324. Length of jump: 5.          Running MCMC-PT iteration number: 25700 of 40000. Chain number 4. Current logpost: -362.308. Length of jump: 7.          Running MCMC-PT iteration number: 25800 of 40000. Chain number 2. Current logpost: -356.463. Length of jump: 9.          Running MCMC-PT iteration number: 25900 of 40000. Chain number 3. Current logpost: -359.917. Length of jump: 7.          Running MCMC-PT iteration number: 25900 of 40000. Chain number 1. Current logpost: -359.941. Length of jump: 5.          Running MCMC-PT iteration number: 25800 of 40000. Chain number 4. Current logpost: -362.744. Length of jump: 7.          Running MCMC-PT iteration number: 25900 of 40000. Chain number 2. Current logpost: -353.662. Length of jump: 10.          Running MCMC-PT iteration number: 26000 of 40000. Chain number 3. Current logpost: -360.47. Length of jump: 7.          Running MCMC-PT iteration number: 26000 of 40000. Chain number 1. Current logpost: -360.9. Length of jump: 5.          Running MCMC-PT iteration number: 25900 of 40000. Chain number 4. Current logpost: -366.562. Length of jump: 7.          Running MCMC-PT iteration number: 26000 of 40000. Chain number 2. Current logpost: -355.47. Length of jump: 9.          Running MCMC-PT iteration number: 26100 of 40000. Chain number 3. Current logpost: -358.405. Length of jump: 7.          Running MCMC-PT iteration number: 26100 of 40000. Chain number 1. Current logpost: -360.211. Length of jump: 4.          Running MCMC-PT iteration number: 26000 of 40000. Chain number 4. Current logpost: -362.596. Length of jump: 8.          Running MCMC-PT iteration number: 26100 of 40000. Chain number 2. Current logpost: -357.666. Length of jump: 9.          Running MCMC-PT iteration number: 26200 of 40000. Chain number 3. Current logpost: -360.782. Length of jump: 7.          Running MCMC-PT iteration number: 26200 of 40000. Chain number 1. Current logpost: -361.985. Length of jump: 5.          Running MCMC-PT iteration number: 26100 of 40000. Chain number 4. Current logpost: -364.629. Length of jump: 6.          Running MCMC-PT iteration number: 26200 of 40000. Chain number 2. Current logpost: -358.346. Length of jump: 10.          Running MCMC-PT iteration number: 26300 of 40000. Chain number 3. Current logpost: -359.715. Length of jump: 8.          Running MCMC-PT iteration number: 26300 of 40000. Chain number 1. Current logpost: -359.868. Length of jump: 5.          Running MCMC-PT iteration number: 26200 of 40000. Chain number 4. Current logpost: -363.268. Length of jump: 6.          Running MCMC-PT iteration number: 26300 of 40000. Chain number 2. Current logpost: -360.673. Length of jump: 10.          Running MCMC-PT iteration number: 26400 of 40000. Chain number 3. Current logpost: -359.793. Length of jump: 8.          Running MCMC-PT iteration number: 26400 of 40000. Chain number 1. Current logpost: -359.886. Length of jump: 5.          Running MCMC-PT iteration number: 26300 of 40000. Chain number 4. Current logpost: -360.908. Length of jump: 5.          Running MCMC-PT iteration number: 26400 of 40000. Chain number 2. Current logpost: -358.48. Length of jump: 8.          Running MCMC-PT iteration number: 26500 of 40000. Chain number 3. Current logpost: -364.093. Length of jump: 8.          Running MCMC-PT iteration number: 26500 of 40000. Chain number 1. Current logpost: -360.102. Length of jump: 5.          Running MCMC-PT iteration number: 26400 of 40000. Chain number 4. Current logpost: -363.163. Length of jump: 4.          Running MCMC-PT iteration number: 26500 of 40000. Chain number 2. Current logpost: -358.923. Length of jump: 7.          Running MCMC-PT iteration number: 26600 of 40000. Chain number 3. Current logpost: -360.454. Length of jump: 7.          Running MCMC-PT iteration number: 26600 of 40000. Chain number 1. Current logpost: -360.974. Length of jump: 5.          Running MCMC-PT iteration number: 26500 of 40000. Chain number 4. Current logpost: -361.293. Length of jump: 5.          Running MCMC-PT iteration number: 26600 of 40000. Chain number 2. Current logpost: -360.435. Length of jump: 9.          Running MCMC-PT iteration number: 26700 of 40000. Chain number 3. Current logpost: -359.164. Length of jump: 7.          Running MCMC-PT iteration number: 26700 of 40000. Chain number 1. Current logpost: -361.046. Length of jump: 5.          Running MCMC-PT iteration number: 26600 of 40000. Chain number 4. Current logpost: -361.105. Length of jump: 5.          Running MCMC-PT iteration number: 26700 of 40000. Chain number 2. Current logpost: -357.999. Length of jump: 7.          Running MCMC-PT iteration number: 26800 of 40000. Chain number 3. Current logpost: -358.769. Length of jump: 7.          Running MCMC-PT iteration number: 26800 of 40000. Chain number 1. Current logpost: -361.031. Length of jump: 5.          Running MCMC-PT iteration number: 26700 of 40000. Chain number 4. Current logpost: -360.61. Length of jump: 5.          Running MCMC-PT iteration number: 26800 of 40000. Chain number 2. Current logpost: -357.272. Length of jump: 6.          Running MCMC-PT iteration number: 26900 of 40000. Chain number 3. Current logpost: -359.109. Length of jump: 6.          Running MCMC-PT iteration number: 26900 of 40000. Chain number 1. Current logpost: -361.568. Length of jump: 6.          Running MCMC-PT iteration number: 26800 of 40000. Chain number 4. Current logpost: -362.032. Length of jump: 6.          Running MCMC-PT iteration number: 26900 of 40000. Chain number 2. Current logpost: -357.686. Length of jump: 6.          Running MCMC-PT iteration number: 27000 of 40000. Chain number 3. Current logpost: -360.447. Length of jump: 6.          Running MCMC-PT iteration number: 27000 of 40000. Chain number 1. Current logpost: -364.121. Length of jump: 6.          Running MCMC-PT iteration number: 26900 of 40000. Chain number 4. Current logpost: -360.465. Length of jump: 7.          Running MCMC-PT iteration number: 27000 of 40000. Chain number 2. Current logpost: -363.181. Length of jump: 10.          Running MCMC-PT iteration number: 27100 of 40000. Chain number 3. Current logpost: -358.456. Length of jump: 6.          Running MCMC-PT iteration number: 27100 of 40000. Chain number 1. Current logpost: -361.816. Length of jump: 5.          Running MCMC-PT iteration number: 27000 of 40000. Chain number 4. Current logpost: -361.713. Length of jump: 8.          Running MCMC-PT iteration number: 27100 of 40000. Chain number 2. Current logpost: -363.125. Length of jump: 10.          Running MCMC-PT iteration number: 27100 of 40000. Chain number 4. Current logpost: -360.753. Length of jump: 8.          Running MCMC-PT iteration number: 27200 of 40000. Chain number 2. Current logpost: -359.722. Length of jump: 9.          Running MCMC-PT iteration number: 27300 of 40000. Chain number 3. Current logpost: -358.025. Length of jump: 6.          Running MCMC-PT iteration number: 27300 of 40000. Chain number 1. Current logpost: -359.996. Length of jump: 5.          Running MCMC-PT iteration number: 27200 of 40000. Chain number 4. Current logpost: -358.735. Length of jump: 7.          Running MCMC-PT iteration number: 27300 of 40000. Chain number 2. Current logpost: -364.812. Length of jump: 9.          Running MCMC-PT iteration number: 27300 of 40000. Chain number 4. Current logpost: -358.874. Length of jump: 7.          Running MCMC-PT iteration number: 27400 of 40000. Chain number 2. Current logpost: -358.054. Length of jump: 8.          Running MCMC-PT iteration number: 27500 of 40000. Chain number 3. Current logpost: -358.257. Length of jump: 6.          Running MCMC-PT iteration number: 27500 of 40000. Chain number 1. Current logpost: -361.513. Length of jump: 6.          Running MCMC-PT iteration number: 27400 of 40000. Chain number 4. Current logpost: -360.347. Length of jump: 7.          Running MCMC-PT iteration number: 27500 of 40000. Chain number 2. Current logpost: -356.918. Length of jump: 7.          Running MCMC-PT iteration number: 27600 of 40000. Chain number 3. Current logpost: -360.811. Length of jump: 7.          Running MCMC-PT iteration number: 27600 of 40000. Chain number 1. Current logpost: -363.413. Length of jump: 7.          Running MCMC-PT iteration number: 27500 of 40000. Chain number 4. Current logpost: -359.356. Length of jump: 6.          Running MCMC-PT iteration number: 27600 of 40000. Chain number 2. Current logpost: -356.117. Length of jump: 7.          Running MCMC-PT iteration number: 27700 of 40000. Chain number 3. Current logpost: -362.918. Length of jump: 8.          Running MCMC-PT iteration number: 27700 of 40000. Chain number 1. Current logpost: -362.701. Length of jump: 7.          Running MCMC-PT iteration number: 27700 of 40000. Chain number 2. Current logpost: -357.626. Length of jump: 9.          Running MCMC-PT iteration number: 27600 of 40000. Chain number 4. Current logpost: -359.659. Length of jump: 6.          Running MCMC-PT iteration number: 27800 of 40000. Chain number 3. Current logpost: -361.326. Length of jump: 8.          Running MCMC-PT iteration number: 27800 of 40000. Chain number 1. Current logpost: -360.693. Length of jump: 6.          Running MCMC-PT iteration number: 27800 of 40000. Chain number 2. Current logpost: -358.232. Length of jump: 9.          Running MCMC-PT iteration number: 27700 of 40000. Chain number 4. Current logpost: -361.706. Length of jump: 5.          Running MCMC-PT iteration number: 27900 of 40000. Chain number 3. Current logpost: -362.648. Length of jump: 9.          Running MCMC-PT iteration number: 27900 of 40000. Chain number 1. Current logpost: -360.089. Length of jump: 5.          Running MCMC-PT iteration number: 27900 of 40000. Chain number 2. Current logpost: -359.304. Length of jump: 9.          Running MCMC-PT iteration number: 27800 of 40000. Chain number 4. Current logpost: -358.927. Length of jump: 5.          Running MCMC-PT iteration number: 28000 of 40000. Chain number 3. Current logpost: -359.405. Length of jump: 8.          Running MCMC-PT iteration number: 28000 of 40000. Chain number 1. Current logpost: -360.84. Length of jump: 5.          Running MCMC-PT iteration number: 28000 of 40000. Chain number 2. Current logpost: -356.557. Length of jump: 8.          Running MCMC-PT iteration number: 27900 of 40000. Chain number 4. Current logpost: -356.956. Length of jump: 6.          Running MCMC-PT iteration number: 28100 of 40000. Chain number 3. Current logpost: -360.646. Length of jump: 8.          Running MCMC-PT iteration number: 28100 of 40000. Chain number 1. Current logpost: -359.879. Length of jump: 5.          Running MCMC-PT iteration number: 28100 of 40000. Chain number 2. Current logpost: -355.511. Length of jump: 7.          Running MCMC-PT iteration number: 28000 of 40000. Chain number 4. Current logpost: -359.71. Length of jump: 6.          Running MCMC-PT iteration number: 28200 of 40000. Chain number 3. Current logpost: -360.826. Length of jump: 7.          Running MCMC-PT iteration number: 28200 of 40000. Chain number 1. Current logpost: -361.851. Length of jump: 7.          Running MCMC-PT iteration number: 28200 of 40000. Chain number 2. Current logpost: -359.131. Length of jump: 7.          Running MCMC-PT iteration number: 28100 of 40000. Chain number 4. Current logpost: -361.901. Length of jump: 5.          Running MCMC-PT iteration number: 28300 of 40000. Chain number 3. Current logpost: -360.829. Length of jump: 7.          Running MCMC-PT iteration number: 28300 of 40000. Chain number 1. Current logpost: -360.88. Length of jump: 5.          Running MCMC-PT iteration number: 28300 of 40000. Chain number 2. Current logpost: -357.641. Length of jump: 7.          Running MCMC-PT iteration number: 28200 of 40000. Chain number 4. Current logpost: -358.154. Length of jump: 5.          Running MCMC-PT iteration number: 28400 of 40000. Chain number 3. Current logpost: -361.266. Length of jump: 7.          Running MCMC-PT iteration number: 28400 of 40000. Chain number 1. Current logpost: -360.713. Length of jump: 5.          Running MCMC-PT iteration number: 28400 of 40000. Chain number 2. Current logpost: -359.884. Length of jump: 6.          Running MCMC-PT iteration number: 28300 of 40000. Chain number 4. Current logpost: -359.162. Length of jump: 7.          Running MCMC-PT iteration number: 28500 of 40000. Chain number 3. Current logpost: -362.176. Length of jump: 8.          Running MCMC-PT iteration number: 28500 of 40000. Chain number 1. Current logpost: -360.88. Length of jump: 5.          Running MCMC-PT iteration number: 28500 of 40000. Chain number 2. Current logpost: -358.911. Length of jump: 6.          Running MCMC-PT iteration number: 28400 of 40000. Chain number 4. Current logpost: -358.664. Length of jump: 6.          Running MCMC-PT iteration number: 28600 of 40000. Chain number 3. Current logpost: -358.301. Length of jump: 6.          Running MCMC-PT iteration number: 28600 of 40000. Chain number 1. Current logpost: -359.93. Length of jump: 5.          Running MCMC-PT iteration number: 28600 of 40000. Chain number 2. Current logpost: -359.396. Length of jump: 6.          Running MCMC-PT iteration number: 28500 of 40000. Chain number 4. Current logpost: -358.278. Length of jump: 6.          Running MCMC-PT iteration number: 28700 of 40000. Chain number 3. Current logpost: -362.431. Length of jump: 8.          Running MCMC-PT iteration number: 28700 of 40000. Chain number 1. Current logpost: -360.039. Length of jump: 5.          Running MCMC-PT iteration number: 28700 of 40000. Chain number 2. Current logpost: -357.387. Length of jump: 6.          Running MCMC-PT iteration number: 28600 of 40000. Chain number 4. Current logpost: -359.307. Length of jump: 7.          Running MCMC-PT iteration number: 28800 of 40000. Chain number 3. Current logpost: -361.081. Length of jump: 6.          Running MCMC-PT iteration number: 28800 of 40000. Chain number 1. Current logpost: -359.877. Length of jump: 5.          Running MCMC-PT iteration number: 28700 of 40000. Chain number 4. Current logpost: -359.968. Length of jump: 7.          Running MCMC-PT iteration number: 28800 of 40000. Chain number 2. Current logpost: -357.775. Length of jump: 6.          Running MCMC-PT iteration number: 28900 of 40000. Chain number 3. Current logpost: -363.336. Length of jump: 7.          Running MCMC-PT iteration number: 28900 of 40000. Chain number 1. Current logpost: -365.095. Length of jump: 4.          Running MCMC-PT iteration number: 28800 of 40000. Chain number 4. Current logpost: -360.722. Length of jump: 7.          Running MCMC-PT iteration number: 28900 of 40000. Chain number 2. Current logpost: -356.736. Length of jump: 5.          Running MCMC-PT iteration number: 29000 of 40000. Chain number 3. Current logpost: -361.359. Length of jump: 6.          Running MCMC-PT iteration number: 29000 of 40000. Chain number 1. Current logpost: -363.551. Length of jump: 5.          Running MCMC-PT iteration number: 28900 of 40000. Chain number 4. Current logpost: -360.729. Length of jump: 5.          Running MCMC-PT iteration number: 29000 of 40000. Chain number 2. Current logpost: -358.759. Length of jump: 5.          Running MCMC-PT iteration number: 29100 of 40000. Chain number 3. Current logpost: -361.268. Length of jump: 7.          Running MCMC-PT iteration number: 29100 of 40000. Chain number 1. Current logpost: -361.499. Length of jump: 6.          Running MCMC-PT iteration number: 29000 of 40000. Chain number 4. Current logpost: -359.191. Length of jump: 5.          Running MCMC-PT iteration number: 29100 of 40000. Chain number 2. Current logpost: -357.834. Length of jump: 5.          Running MCMC-PT iteration number: 29200 of 40000. Chain number 3. Current logpost: -360.442. Length of jump: 5.          Running MCMC-PT iteration number: 29200 of 40000. Chain number 1. Current logpost: -361.567. Length of jump: 6.          Running MCMC-PT iteration number: 29100 of 40000. Chain number 4. Current logpost: -359.117. Length of jump: 5.          Running MCMC-PT iteration number: 29200 of 40000. Chain number 2. Current logpost: -359.609. Length of jump: 5.          Running MCMC-PT iteration number: 29300 of 40000. Chain number 3. Current logpost: -360.661. Length of jump: 4.          Running MCMC-PT iteration number: 29300 of 40000. Chain number 1. Current logpost: -358.77. Length of jump: 5.          Running MCMC-PT iteration number: 29200 of 40000. Chain number 4. Current logpost: -359.459. Length of jump: 5.          Running MCMC-PT iteration number: 29300 of 40000. Chain number 2. Current logpost: -356.463. Length of jump: 5.          Running MCMC-PT iteration number: 29400 of 40000. Chain number 3. Current logpost: -361.298. Length of jump: 4.          Running MCMC-PT iteration number: 29400 of 40000. Chain number 1. Current logpost: -358.723. Length of jump: 5.          Running MCMC-PT iteration number: 29300 of 40000. Chain number 4. Current logpost: -359.489. Length of jump: 4.          Running MCMC-PT iteration number: 29400 of 40000. Chain number 2. Current logpost: -357.441. Length of jump: 5.          Running MCMC-PT iteration number: 29500 of 40000. Chain number 3. Current logpost: -361.073. Length of jump: 3.          Running MCMC-PT iteration number: 29500 of 40000. Chain number 1. Current logpost: -358.198. Length of jump: 5.          Running MCMC-PT iteration number: 29400 of 40000. Chain number 4. Current logpost: -358.945. Length of jump: 4.          Running MCMC-PT iteration number: 29500 of 40000. Chain number 2. Current logpost: -356.971. Length of jump: 6.          Running MCMC-PT iteration number: 29600 of 40000. Chain number 3. Current logpost: -362.27. Length of jump: 3.          Running MCMC-PT iteration number: 29600 of 40000. Chain number 1. Current logpost: -360.816. Length of jump: 5.          Running MCMC-PT iteration number: 29500 of 40000. Chain number 4. Current logpost: -357.86. Length of jump: 4.          Running MCMC-PT iteration number: 29600 of 40000. Chain number 2. Current logpost: -359.086. Length of jump: 7.          Running MCMC-PT iteration number: 29700 of 40000. Chain number 3. Current logpost: -362.961. Length of jump: 3.          Running MCMC-PT iteration number: 29700 of 40000. Chain number 1. Current logpost: -362.191. Length of jump: 4.          Running MCMC-PT iteration number: 29600 of 40000. Chain number 4. Current logpost: -358.532. Length of jump: 4.          Running MCMC-PT iteration number: 29700 of 40000. Chain number 2. Current logpost: -358.84. Length of jump: 7.          Running MCMC-PT iteration number: 29800 of 40000. Chain number 3. Current logpost: -363.545. Length of jump: 5.          Running MCMC-PT iteration number: 29800 of 40000. Chain number 1. Current logpost: -360.233. Length of jump: 4.          Running MCMC-PT iteration number: 29700 of 40000. Chain number 4. Current logpost: -358.988. Length of jump: 4.          Running MCMC-PT iteration number: 29800 of 40000. Chain number 2. Current logpost: -358.651. Length of jump: 8.          Running MCMC-PT iteration number: 29900 of 40000. Chain number 3. Current logpost: -361.248. Length of jump: 5.          Running MCMC-PT iteration number: 29900 of 40000. Chain number 1. Current logpost: -361.381. Length of jump: 4.          Running MCMC-PT iteration number: 29800 of 40000. Chain number 4. Current logpost: -359.922. Length of jump: 4.          Running MCMC-PT iteration number: 29900 of 40000. Chain number 2. Current logpost: -357.901. Length of jump: 8.          Running MCMC-PT iteration number: 30000 of 40000. Chain number 3. Current logpost: -359.897. Length of jump: 4.          Running MCMC-PT iteration number: 30000 of 40000. Chain number 1. Current logpost: -362.885. Length of jump: 4.          Running MCMC-PT iteration number: 29900 of 40000. Chain number 4. Current logpost: -358.34. Length of jump: 5.          Running MCMC-PT iteration number: 30000 of 40000. Chain number 2. Current logpost: -358.519. Length of jump: 8.          Running MCMC-PT iteration number: 30100 of 40000. Chain number 3. Current logpost: -360.553. Length of jump: 6.          Running MCMC-PT iteration number: 30100 of 40000. Chain number 1. Current logpost: -360.234. Length of jump: 4.          Running MCMC-PT iteration number: 30000 of 40000. Chain number 4. Current logpost: -358.119. Length of jump: 6.          Running MCMC-PT iteration number: 30100 of 40000. Chain number 2. Current logpost: -359.184. Length of jump: 8.          Running MCMC-PT iteration number: 30200 of 40000. Chain number 3. Current logpost: -360.071. Length of jump: 5.          Running MCMC-PT iteration number: 30200 of 40000. Chain number 1. Current logpost: -360.616. Length of jump: 4.          Running MCMC-PT iteration number: 30100 of 40000. Chain number 4. Current logpost: -361.739. Length of jump: 5.          Running MCMC-PT iteration number: 30200 of 40000. Chain number 2. Current logpost: -357.492. Length of jump: 6.          Running MCMC-PT iteration number: 30300 of 40000. Chain number 3. Current logpost: -359.995. Length of jump: 5.          Running MCMC-PT iteration number: 30300 of 40000. Chain number 1. Current logpost: -360.331. Length of jump: 4.          Running MCMC-PT iteration number: 30200 of 40000. Chain number 4. Current logpost: -358.656. Length of jump: 5.          Running MCMC-PT iteration number: 30300 of 40000. Chain number 2. Current logpost: -358.537. Length of jump: 7.          Running MCMC-PT iteration number: 30400 of 40000. Chain number 3. Current logpost: -361.405. Length of jump: 6.          Running MCMC-PT iteration number: 30500 of 40000. Chain number 3. Current logpost: -361.684. Length of jump: 5.          Running MCMC-PT iteration number: 30500 of 40000. Chain number 1. Current logpost: -360.726. Length of jump: 5.          Running MCMC-PT iteration number: 30400 of 40000. Chain number 4. Current logpost: -359.42. Length of jump: 5.          Running MCMC-PT iteration number: 30500 of 40000. Chain number 2. Current logpost: -358.629. Length of jump: 7.          Running MCMC-PT iteration number: 30600 of 40000. Chain number 3. Current logpost: -360.559. Length of jump: 5.          Running MCMC-PT iteration number: 30600 of 40000. Chain number 1. Current logpost: -360.455. Length of jump: 5.          Running MCMC-PT iteration number: 30500 of 40000. Chain number 4. Current logpost: -359.927. Length of jump: 5.          Running MCMC-PT iteration number: 30600 of 40000. Chain number 2. Current logpost: -358.167. Length of jump: 6.          Running MCMC-PT iteration number: 30700 of 40000. Chain number 3. Current logpost: -361.506. Length of jump: 4.          Running MCMC-PT iteration number: 30700 of 40000. Chain number 1. Current logpost: -362.152. Length of jump: 4.          Running MCMC-PT iteration number: 30600 of 40000. Chain number 4. Current logpost: -360.144. Length of jump: 6.          Running MCMC-PT iteration number: 30700 of 40000. Chain number 2. Current logpost: -357.944. Length of jump: 5.          Running MCMC-PT iteration number: 30800 of 40000. Chain number 3. Current logpost: -360.765. Length of jump: 4.          Running MCMC-PT iteration number: 30800 of 40000. Chain number 1. Current logpost: -359.9. Length of jump: 5.          Running MCMC-PT iteration number: 30700 of 40000. Chain number 4. Current logpost: -361.266. Length of jump: 6.          Running MCMC-PT iteration number: 30800 of 40000. Chain number 2. Current logpost: -359.156. Length of jump: 5.          Running MCMC-PT iteration number: 30900 of 40000. Chain number 3. Current logpost: -360.236. Length of jump: 4.          Running MCMC-PT iteration number: 30900 of 40000. Chain number 1. Current logpost: -362.778. Length of jump: 6.          Running MCMC-PT iteration number: 30800 of 40000. Chain number 4. Current logpost: -360.949. Length of jump: 6.          Running MCMC-PT iteration number: 30900 of 40000. Chain number 2. Current logpost: -358.876. Length of jump: 6.          Running MCMC-PT iteration number: 31000 of 40000. Chain number 3. Current logpost: -362.303. Length of jump: 5.          Running MCMC-PT iteration number: 31000 of 40000. Chain number 1. Current logpost: -362.038. Length of jump: 5.          Running MCMC-PT iteration number: 30900 of 40000. Chain number 4. Current logpost: -360.467. Length of jump: 6.          Running MCMC-PT iteration number: 31000 of 40000. Chain number 2. Current logpost: -357.738. Length of jump: 6.          Running MCMC-PT iteration number: 31100 of 40000. Chain number 3. Current logpost: -361.489. Length of jump: 6.          Running MCMC-PT iteration number: 31100 of 40000. Chain number 1. Current logpost: -362.039. Length of jump: 5.          Running MCMC-PT iteration number: 31000 of 40000. Chain number 4. Current logpost: -359.18. Length of jump: 6.          Running MCMC-PT iteration number: 31100 of 40000. Chain number 2. Current logpost: -361.487. Length of jump: 8.          Running MCMC-PT iteration number: 31200 of 40000. Chain number 3. Current logpost: -362.585. Length of jump: 7.          Running MCMC-PT iteration number: 31200 of 40000. Chain number 1. Current logpost: -360.62. Length of jump: 5.          Running MCMC-PT iteration number: 31100 of 40000. Chain number 4. Current logpost: -361.596. Length of jump: 6.          Running MCMC-PT iteration number: 31200 of 40000. Chain number 2. Current logpost: -358.661. Length of jump: 7.          Running MCMC-PT iteration number: 31300 of 40000. Chain number 3. Current logpost: -360.016. Length of jump: 6.          Running MCMC-PT iteration number: 31300 of 40000. Chain number 1. Current logpost: -361.373. Length of jump: 6.          Running MCMC-PT iteration number: 31200 of 40000. Chain number 4. Current logpost: -359.401. Length of jump: 5.          Running MCMC-PT iteration number: 31300 of 40000. Chain number 2. Current logpost: -358.107. Length of jump: 7.          Running MCMC-PT iteration number: 31400 of 40000. Chain number 3. Current logpost: -358.357. Length of jump: 5.          Running MCMC-PT iteration number: 31400 of 40000. Chain number 1. Current logpost: -360.426. Length of jump: 5.          Running MCMC-PT iteration number: 31300 of 40000. Chain number 4. Current logpost: -359.477. Length of jump: 5.          Running MCMC-PT iteration number: 31400 of 40000. Chain number 2. Current logpost: -358.174. Length of jump: 7.          Running MCMC-PT iteration number: 31500 of 40000. Chain number 3. Current logpost: -357.612. Length of jump: 5.          Running MCMC-PT iteration number: 31500 of 40000. Chain number 1. Current logpost: -360.674. Length of jump: 6.          Running MCMC-PT iteration number: 31400 of 40000. Chain number 4. Current logpost: -360.173. Length of jump: 5.          Running MCMC-PT iteration number: 31500 of 40000. Chain number 2. Current logpost: -357.601. Length of jump: 7.          Running MCMC-PT iteration number: 31600 of 40000. Chain number 3. Current logpost: -358.191. Length of jump: 6.          Running MCMC-PT iteration number: 31600 of 40000. Chain number 1. Current logpost: -361.655. Length of jump: 7.          Running MCMC-PT iteration number: 31500 of 40000. Chain number 4. Current logpost: -365.785. Length of jump: 6.          Running MCMC-PT iteration number: 31600 of 40000. Chain number 2. Current logpost: -358.793. Length of jump: 7.          Running MCMC-PT iteration number: 31700 of 40000. Chain number 3. Current logpost: -363.422. Length of jump: 8.          Running MCMC-PT iteration number: 31600 of 40000. Chain number 4. Current logpost: -363.909. Length of jump: 6.          Running MCMC-PT iteration number: 31700 of 40000. Chain number 2. Current logpost: -357.423. Length of jump: 6.          Running MCMC-PT iteration number: 31700 of 40000. Chain number 4. Current logpost: -360.83. Length of jump: 6.          Running MCMC-PT iteration number: 31800 of 40000. Chain number 2. Current logpost: -358.103. Length of jump: 6.          Running MCMC-PT iteration number: 31900 of 40000. Chain number 3. Current logpost: -360.802. Length of jump: 7.          Running MCMC-PT iteration number: 31900 of 40000. Chain number 1. Current logpost: -365.684. Length of jump: 7.          Running MCMC-PT iteration number: 31800 of 40000. Chain number 4. Current logpost: -359.905. Length of jump: 6.          Running MCMC-PT iteration number: 31900 of 40000. Chain number 2. Current logpost: -358.954. Length of jump: 8.          Running MCMC-PT iteration number: 32000 of 40000. Chain number 3. Current logpost: -359.73. Length of jump: 6.          Running MCMC-PT iteration number: 32000 of 40000. Chain number 1. Current logpost: -366.332. Length of jump: 7.          Running MCMC-PT iteration number: 32000 of 40000. Chain number 2. Current logpost: -357.548. Length of jump: 7.          Running MCMC-PT iteration number: 31900 of 40000. Chain number 4. Current logpost: -362.924. Length of jump: 7.          Running MCMC-PT iteration number: 32100 of 40000. Chain number 3. Current logpost: -360.36. Length of jump: 6.          Running MCMC-PT iteration number: 32100 of 40000. Chain number 1. Current logpost: -364.68. Length of jump: 7.          Running MCMC-PT iteration number: 32100 of 40000. Chain number 2. Current logpost: -356.332. Length of jump: 7.          Running MCMC-PT iteration number: 32000 of 40000. Chain number 4. Current logpost: -359.864. Length of jump: 8.          Running MCMC-PT iteration number: 32200 of 40000. Chain number 3. Current logpost: -359.967. Length of jump: 6.          Running MCMC-PT iteration number: 32200 of 40000. Chain number 1. Current logpost: -364.409. Length of jump: 6.          Running MCMC-PT iteration number: 32100 of 40000. Chain number 4. Current logpost: -362.166. Length of jump: 8.          Running MCMC-PT iteration number: 32200 of 40000. Chain number 2. Current logpost: -357.865. Length of jump: 6.          Running MCMC-PT iteration number: 32300 of 40000. Chain number 3. Current logpost: -360.639. Length of jump: 6.          Running MCMC-PT iteration number: 32300 of 40000. Chain number 1. Current logpost: -360.176. Length of jump: 4.          Running MCMC-PT iteration number: 32300 of 40000. Chain number 2. Current logpost: -357.551. Length of jump: 5.          Running MCMC-PT iteration number: 32200 of 40000. Chain number 4. Current logpost: -360.759. Length of jump: 8.          Running MCMC-PT iteration number: 32400 of 40000. Chain number 3. Current logpost: -363.903. Length of jump: 8.          Running MCMC-PT iteration number: 32400 of 40000. Chain number 1. Current logpost: -363.053. Length of jump: 6.          Running MCMC-PT iteration number: 32400 of 40000. Chain number 2. Current logpost: -360.026. Length of jump: 6.          Running MCMC-PT iteration number: 32300 of 40000. Chain number 4. Current logpost: -360.857. Length of jump: 8.          Running MCMC-PT iteration number: 32500 of 40000. Chain number 3. Current logpost: -363.032. Length of jump: 8.          Running MCMC-PT iteration number: 32500 of 40000. Chain number 1. Current logpost: -361.045. Length of jump: 6.          Running MCMC-PT iteration number: 32500 of 40000. Chain number 2. Current logpost: -356.419. Length of jump: 6.          Running MCMC-PT iteration number: 32400 of 40000. Chain number 4. Current logpost: -359.462. Length of jump: 5.          Running MCMC-PT iteration number: 32600 of 40000. Chain number 3. Current logpost: -361.012. Length of jump: 7.          Running MCMC-PT iteration number: 32600 of 40000. Chain number 1. Current logpost: -360.04. Length of jump: 5.          Running MCMC-PT iteration number: 32600 of 40000. Chain number 2. Current logpost: -358.713. Length of jump: 6.          Running MCMC-PT iteration number: 32500 of 40000. Chain number 4. Current logpost: -361.267. Length of jump: 6.          Running MCMC-PT iteration number: 32700 of 40000. Chain number 3. Current logpost: -362.011. Length of jump: 9.          Running MCMC-PT iteration number: 32700 of 40000. Chain number 1. Current logpost: -361.327. Length of jump: 5.          Running MCMC-PT iteration number: 32700 of 40000. Chain number 2. Current logpost: -359.12. Length of jump: 7.          Running MCMC-PT iteration number: 32600 of 40000. Chain number 4. Current logpost: -362.058. Length of jump: 5.          Running MCMC-PT iteration number: 32800 of 40000. Chain number 3. Current logpost: -360.685. Length of jump: 8.          Running MCMC-PT iteration number: 32900 of 40000. Chain number 3. Current logpost: -363.237. Length of jump: 8.          Running MCMC-PT iteration number: 32900 of 40000. Chain number 1. Current logpost: -360.474. Length of jump: 5.          Running MCMC-PT iteration number: 32900 of 40000. Chain number 2. Current logpost: -357.615. Length of jump: 6.          Running MCMC-PT iteration number: 32800 of 40000. Chain number 4. Current logpost: -360.273. Length of jump: 5.          Running MCMC-PT iteration number: 33000 of 40000. Chain number 3. Current logpost: -365.025. Length of jump: 8.          Running MCMC-PT iteration number: 33000 of 40000. Chain number 1. Current logpost: -363.701. Length of jump: 6.          Running MCMC-PT iteration number: 33000 of 40000. Chain number 2. Current logpost: -357.992. Length of jump: 6.          Running MCMC-PT iteration number: 32900 of 40000. Chain number 4. Current logpost: -360.878. Length of jump: 5.          Running MCMC-PT iteration number: 33100 of 40000. Chain number 3. Current logpost: -364.798. Length of jump: 8.          Running MCMC-PT iteration number: 33100 of 40000. Chain number 1. Current logpost: -364.226. Length of jump: 6.          Running MCMC-PT iteration number: 33100 of 40000. Chain number 2. Current logpost: -357.005. Length of jump: 7.          Running MCMC-PT iteration number: 33000 of 40000. Chain number 4. Current logpost: -361.972. Length of jump: 7.          Running MCMC-PT iteration number: 33200 of 40000. Chain number 3. Current logpost: -364.707. Length of jump: 9.          Running MCMC-PT iteration number: 33200 of 40000. Chain number 1. Current logpost: -363.501. Length of jump: 5.          Running MCMC-PT iteration number: 33200 of 40000. Chain number 2. Current logpost: -358.509. Length of jump: 7.          Running MCMC-PT iteration number: 33100 of 40000. Chain number 4. Current logpost: -360.305. Length of jump: 5.          Running MCMC-PT iteration number: 33300 of 40000. Chain number 3. Current logpost: -367.497. Length of jump: 8.          Running MCMC-PT iteration number: 33300 of 40000. Chain number 1. Current logpost: -362.64. Length of jump: 6.          Running MCMC-PT iteration number: 33300 of 40000. Chain number 2. Current logpost: -360.593. Length of jump: 8.          Running MCMC-PT iteration number: 33200 of 40000. Chain number 4. Current logpost: -361.471. Length of jump: 5.          Running MCMC-PT iteration number: 33400 of 40000. Chain number 3. Current logpost: -365.045. Length of jump: 6.          Running MCMC-PT iteration number: 33400 of 40000. Chain number 1. Current logpost: -361.862. Length of jump: 6.          Running MCMC-PT iteration number: 33400 of 40000. Chain number 2. Current logpost: -356.577. Length of jump: 9.          Running MCMC-PT iteration number: 33300 of 40000. Chain number 4. Current logpost: -361.589. Length of jump: 5.          Running MCMC-PT iteration number: 33500 of 40000. Chain number 3. Current logpost: -362.213. Length of jump: 5.          Running MCMC-PT iteration number: 33500 of 40000. Chain number 1. Current logpost: -363.41. Length of jump: 7.          Running MCMC-PT iteration number: 33500 of 40000. Chain number 2. Current logpost: -356.752. Length of jump: 8.          Running MCMC-PT iteration number: 33400 of 40000. Chain number 4. Current logpost: -360.384. Length of jump: 5.          Running MCMC-PT iteration number: 33600 of 40000. Chain number 3. Current logpost: -360.34. Length of jump: 5.          Running MCMC-PT iteration number: 33600 of 40000. Chain number 1. Current logpost: -362.91. Length of jump: 7.          Running MCMC-PT iteration number: 33600 of 40000. Chain number 2. Current logpost: -356.853. Length of jump: 8.          Running MCMC-PT iteration number: 33500 of 40000. Chain number 4. Current logpost: -360.289. Length of jump: 4.          Running MCMC-PT iteration number: 33700 of 40000. Chain number 3. Current logpost: -363.007. Length of jump: 5.          Running MCMC-PT iteration number: 33700 of 40000. Chain number 1. Current logpost: -360.907. Length of jump: 5.          Running MCMC-PT iteration number: 33600 of 40000. Chain number 4. Current logpost: -361.645. Length of jump: 4.          Running MCMC-PT iteration number: 33800 of 40000. Chain number 3. Current logpost: -360.254. Length of jump: 5.          Running MCMC-PT iteration number: 33800 of 40000. Chain number 1. Current logpost: -361.577. Length of jump: 4.          Running MCMC-PT iteration number: 33800 of 40000. Chain number 2. Current logpost: -358.752. Length of jump: 8.          Running MCMC-PT iteration number: 33700 of 40000. Chain number 4. Current logpost: -361.431. Length of jump: 4.          Running MCMC-PT iteration number: 33900 of 40000. Chain number 3. Current logpost: -361.462. Length of jump: 6.          Running MCMC-PT iteration number: 33900 of 40000. Chain number 1. Current logpost: -361.635. Length of jump: 5.          Running MCMC-PT iteration number: 33800 of 40000. Chain number 4. Current logpost: -363.632. Length of jump: 4.          Running MCMC-PT iteration number: 33900 of 40000. Chain number 2. Current logpost: -359.872. Length of jump: 8.          Running MCMC-PT iteration number: 34000 of 40000. Chain number 3. Current logpost: -361.581. Length of jump: 6.          Running MCMC-PT iteration number: 34000 of 40000. Chain number 1. Current logpost: -364.362. Length of jump: 5.          Running MCMC-PT iteration number: 34000 of 40000. Chain number 2. Current logpost: -362.117. Length of jump: 9.          Running MCMC-PT iteration number: 33900 of 40000. Chain number 4. Current logpost: -361.289. Length of jump: 4.          Running MCMC-PT iteration number: 34100 of 40000. Chain number 3. Current logpost: -361.5. Length of jump: 6.          Running MCMC-PT iteration number: 34100 of 40000. Chain number 2. Current logpost: -359.76. Length of jump: 7.          Running MCMC-PT iteration number: 34000 of 40000. Chain number 4. Current logpost: -360.583. Length of jump: 4.          Running MCMC-PT iteration number: 34200 of 40000. Chain number 3. Current logpost: -360.892. Length of jump: 5.          Running MCMC-PT iteration number: 34200 of 40000. Chain number 1. Current logpost: -363.931. Length of jump: 4.          Running MCMC-PT iteration number: 34200 of 40000. Chain number 2. Current logpost: -359.33. Length of jump: 6.          Running MCMC-PT iteration number: 34100 of 40000. Chain number 4. Current logpost: -360.79. Length of jump: 4.          Running MCMC-PT iteration number: 34300 of 40000. Chain number 3. Current logpost: -360.077. Length of jump: 5.          Running MCMC-PT iteration number: 34300 of 40000. Chain number 1. Current logpost: -364.544. Length of jump: 4.          Running MCMC-PT iteration number: 34300 of 40000. Chain number 2. Current logpost: -361.388. Length of jump: 6.          Running MCMC-PT iteration number: 34200 of 40000. Chain number 4. Current logpost: -360.119. Length of jump: 4.          Running MCMC-PT iteration number: 34400 of 40000. Chain number 3. Current logpost: -360.815. Length of jump: 6.          Running MCMC-PT iteration number: 34400 of 40000. Chain number 1. Current logpost: -360.471. Length of jump: 5.          Running MCMC-PT iteration number: 34400 of 40000. Chain number 2. Current logpost: -358.66. Length of jump: 5.          Running MCMC-PT iteration number: 34300 of 40000. Chain number 4. Current logpost: -360.155. Length of jump: 5.          Running MCMC-PT iteration number: 34500 of 40000. Chain number 3. Current logpost: -360.951. Length of jump: 6.          Running MCMC-PT iteration number: 34500 of 40000. Chain number 1. Current logpost: -359.991. Length of jump: 5.          Running MCMC-PT iteration number: 34500 of 40000. Chain number 2. Current logpost: -360.998. Length of jump: 4.          Running MCMC-PT iteration number: 34400 of 40000. Chain number 4. Current logpost: -360.345. Length of jump: 5.          Running MCMC-PT iteration number: 34600 of 40000. Chain number 3. Current logpost: -361.86. Length of jump: 5.          Running MCMC-PT iteration number: 34600 of 40000. Chain number 1. Current logpost: -360.06. Length of jump: 5.          Running MCMC-PT iteration number: 34600 of 40000. Chain number 2. Current logpost: -358.216. Length of jump: 4.          Running MCMC-PT iteration number: 34500 of 40000. Chain number 4. Current logpost: -360.044. Length of jump: 5.          Running MCMC-PT iteration number: 34700 of 40000. Chain number 3. Current logpost: -362.977. Length of jump: 6.          Running MCMC-PT iteration number: 34700 of 40000. Chain number 1. Current logpost: -360.328. Length of jump: 5.          Running MCMC-PT iteration number: 34700 of 40000. Chain number 2. Current logpost: -358.428. Length of jump: 5.          Running MCMC-PT iteration number: 34600 of 40000. Chain number 4. Current logpost: -360.825. Length of jump: 6.          Running MCMC-PT iteration number: 34800 of 40000. Chain number 3. Current logpost: -361.231. Length of jump: 7.          Running MCMC-PT iteration number: 34800 of 40000. Chain number 1. Current logpost: -361.335. Length of jump: 6.          Running MCMC-PT iteration number: 34800 of 40000. Chain number 2. Current logpost: -357.835. Length of jump: 7.          Running MCMC-PT iteration number: 34700 of 40000. Chain number 4. Current logpost: -361.643. Length of jump: 7.          Running MCMC-PT iteration number: 34900 of 40000. Chain number 3. Current logpost: -362.322. Length of jump: 7.          Running MCMC-PT iteration number: 34900 of 40000. Chain number 1. Current logpost: -363.325. Length of jump: 7.          Running MCMC-PT iteration number: 34900 of 40000. Chain number 2. Current logpost: -357.064. Length of jump: 7.          Running MCMC-PT iteration number: 34800 of 40000. Chain number 4. Current logpost: -361.661. Length of jump: 5.          Running MCMC-PT iteration number: 35000 of 40000. Chain number 3. Current logpost: -359.731. Length of jump: 6.          Running MCMC-PT iteration number: 35000 of 40000. Chain number 1. Current logpost: -363.229. Length of jump: 5.          Running MCMC-PT iteration number: 35000 of 40000. Chain number 2. Current logpost: -361.047. Length of jump: 7.          Running MCMC-PT iteration number: 34900 of 40000. Chain number 4. Current logpost: -361.405. Length of jump: 4.          Running MCMC-PT iteration number: 35100 of 40000. Chain number 3. Current logpost: -359.441. Length of jump: 5.          Running MCMC-PT iteration number: 35100 of 40000. Chain number 1. Current logpost: -364.261. Length of jump: 5.          Running MCMC-PT iteration number: 35100 of 40000. Chain number 2. Current logpost: -356.932. Length of jump: 8.          Running MCMC-PT iteration number: 35000 of 40000. Chain number 4. Current logpost: -362.012. Length of jump: 4.          Running MCMC-PT iteration number: 35200 of 40000. Chain number 3. Current logpost: -358.997. Length of jump: 5.          Running MCMC-PT iteration number: 35200 of 40000. Chain number 1. Current logpost: -362.653. Length of jump: 5.          Running MCMC-PT iteration number: 35100 of 40000. Chain number 4. Current logpost: -360.726. Length of jump: 5.          Running MCMC-PT iteration number: 35200 of 40000. Chain number 2. Current logpost: -359.85. Length of jump: 9.          Running MCMC-PT iteration number: 35300 of 40000. Chain number 3. Current logpost: -359.295. Length of jump: 5.          Running MCMC-PT iteration number: 35300 of 40000. Chain number 1. Current logpost: -364.221. Length of jump: 4.          Running MCMC-PT iteration number: 35200 of 40000. Chain number 4. Current logpost: -361.324. Length of jump: 6.          Running MCMC-PT iteration number: 35300 of 40000. Chain number 2. Current logpost: -363.06. Length of jump: 9.          Running MCMC-PT iteration number: 35400 of 40000. Chain number 3. Current logpost: -358.398. Length of jump: 5.          Running MCMC-PT iteration number: 35400 of 40000. Chain number 1. Current logpost: -365.986. Length of jump: 4.          Running MCMC-PT iteration number: 35300 of 40000. Chain number 4. Current logpost: -362.849. Length of jump: 6.          Running MCMC-PT iteration number: 35400 of 40000. Chain number 2. Current logpost: -360.668. Length of jump: 8.          Running MCMC-PT iteration number: 35500 of 40000. Chain number 3. Current logpost: -357.616. Length of jump: 5.          Running MCMC-PT iteration number: 35500 of 40000. Chain number 1. Current logpost: -362.138. Length of jump: 5.          Running MCMC-PT iteration number: 35400 of 40000. Chain number 4. Current logpost: -362.935. Length of jump: 5.          Running MCMC-PT iteration number: 35500 of 40000. Chain number 2. Current logpost: -358.795. Length of jump: 8.          Running MCMC-PT iteration number: 35600 of 40000. Chain number 3. Current logpost: -359.451. Length of jump: 7.          Running MCMC-PT iteration number: 35600 of 40000. Chain number 1. Current logpost: -366.736. Length of jump: 6.          Running MCMC-PT iteration number: 35500 of 40000. Chain number 4. Current logpost: -360.974. Length of jump: 5.          Running MCMC-PT iteration number: 35600 of 40000. Chain number 2. Current logpost: -362.169. Length of jump: 7.          Running MCMC-PT iteration number: 35700 of 40000. Chain number 3. Current logpost: -358.085. Length of jump: 6.          Running MCMC-PT iteration number: 35700 of 40000. Chain number 1. Current logpost: -359.731. Length of jump: 6.          Running MCMC-PT iteration number: 35600 of 40000. Chain number 4. Current logpost: -360.477. Length of jump: 5.          Running MCMC-PT iteration number: 35700 of 40000. Chain number 2. Current logpost: -360.141. Length of jump: 7.          Running MCMC-PT iteration number: 35800 of 40000. Chain number 3. Current logpost: -358.368. Length of jump: 6.          Running MCMC-PT iteration number: 35800 of 40000. Chain number 1. Current logpost: -359.98. Length of jump: 6.          Running MCMC-PT iteration number: 35700 of 40000. Chain number 4. Current logpost: -360.551. Length of jump: 5.          Running MCMC-PT iteration number: 35800 of 40000. Chain number 2. Current logpost: -365.994. Length of jump: 8.          Running MCMC-PT iteration number: 35900 of 40000. Chain number 3. Current logpost: -360.271. Length of jump: 6.          Running MCMC-PT iteration number: 35900 of 40000. Chain number 1. Current logpost: -358.628. Length of jump: 5.          Running MCMC-PT iteration number: 35800 of 40000. Chain number 4. Current logpost: -360.985. Length of jump: 5.          Running MCMC-PT iteration number: 35900 of 40000. Chain number 2. Current logpost: -358.954. Length of jump: 7.          Running MCMC-PT iteration number: 36000 of 40000. Chain number 3. Current logpost: -358.176. Length of jump: 5.          Running MCMC-PT iteration number: 36000 of 40000. Chain number 1. Current logpost: -359.193. Length of jump: 5.          Running MCMC-PT iteration number: 35900 of 40000. Chain number 4. Current logpost: -360.183. Length of jump: 6.          Running MCMC-PT iteration number: 36000 of 40000. Chain number 2. Current logpost: -361.058. Length of jump: 7.          Running MCMC-PT iteration number: 36100 of 40000. Chain number 3. Current logpost: -358.598. Length of jump: 5.          Running MCMC-PT iteration number: 36100 of 40000. Chain number 1. Current logpost: -359.736. Length of jump: 5.          Running MCMC-PT iteration number: 36000 of 40000. Chain number 4. Current logpost: -359.758. Length of jump: 5.          Running MCMC-PT iteration number: 36100 of 40000. Chain number 2. Current logpost: -358.992. Length of jump: 7.          Running MCMC-PT iteration number: 36200 of 40000. Chain number 3. Current logpost: -360.047. Length of jump: 5.          Running MCMC-PT iteration number: 36200 of 40000. Chain number 1. Current logpost: -359.817. Length of jump: 5.          Running MCMC-PT iteration number: 36100 of 40000. Chain number 4. Current logpost: -359.007. Length of jump: 6.          Running MCMC-PT iteration number: 36200 of 40000. Chain number 2. Current logpost: -358.267. Length of jump: 7.          Running MCMC-PT iteration number: 36300 of 40000. Chain number 3. Current logpost: -359.876. Length of jump: 5.          Running MCMC-PT iteration number: 36300 of 40000. Chain number 1. Current logpost: -363.801. Length of jump: 5.          Running MCMC-PT iteration number: 36200 of 40000. Chain number 4. Current logpost: -356.95. Length of jump: 5.          Running MCMC-PT iteration number: 36300 of 40000. Chain number 2. Current logpost: -359.981. Length of jump: 6.          Running MCMC-PT iteration number: 36400 of 40000. Chain number 3. Current logpost: -360.742. Length of jump: 5.          Running MCMC-PT iteration number: 36400 of 40000. Chain number 1. Current logpost: -365.211. Length of jump: 7.          Running MCMC-PT iteration number: 36300 of 40000. Chain number 4. Current logpost: -360.859. Length of jump: 4.          Running MCMC-PT iteration number: 36400 of 40000. Chain number 2. Current logpost: -361.347. Length of jump: 6.          Running MCMC-PT iteration number: 36500 of 40000. Chain number 3. Current logpost: -361.029. Length of jump: 5.          Running MCMC-PT iteration number: 36500 of 40000. Chain number 1. Current logpost: -356.799. Length of jump: 6.          Running MCMC-PT iteration number: 36400 of 40000. Chain number 4. Current logpost: -359.363. Length of jump: 4.          Running MCMC-PT iteration number: 36500 of 40000. Chain number 2. Current logpost: -357.823. Length of jump: 5.          Running MCMC-PT iteration number: 36600 of 40000. Chain number 3. Current logpost: -360.902. Length of jump: 5.          Running MCMC-PT iteration number: 36600 of 40000. Chain number 1. Current logpost: -362.275. Length of jump: 7.          Running MCMC-PT iteration number: 36500 of 40000. Chain number 4. Current logpost: -359.428. Length of jump: 4.          Running MCMC-PT iteration number: 36600 of 40000. Chain number 2. Current logpost: -357.467. Length of jump: 5.          Running MCMC-PT iteration number: 36700 of 40000. Chain number 3. Current logpost: -360.558. Length of jump: 5.          Running MCMC-PT iteration number: 36700 of 40000. Chain number 1. Current logpost: -362.519. Length of jump: 9.          Running MCMC-PT iteration number: 36600 of 40000. Chain number 4. Current logpost: -360.095. Length of jump: 4.          Running MCMC-PT iteration number: 36800 of 40000. Chain number 1. Current logpost: -360.568. Length of jump: 8.          Running MCMC-PT iteration number: 36700 of 40000. Chain number 4. Current logpost: -360.466. Length of jump: 4.          Running MCMC-PT iteration number: 36800 of 40000. Chain number 4. Current logpost: -361.768. Length of jump: 5.          Running MCMC-PT iteration number: 36900 of 40000. Chain number 4. Current logpost: -361.178. Length of jump: 3.          Running MCMC-PT iteration number: 37000 of 40000. Chain number 2. Current logpost: -361.947. Length of jump: 6.          Running MCMC-PT iteration number: 37100 of 40000. Chain number 3. Current logpost: -360.623. Length of jump: 7.          Running MCMC-PT iteration number: 37100 of 40000. Chain number 1. Current logpost: -361.07. Length of jump: 5.          Running MCMC-PT iteration number: 37000 of 40000. Chain number 4. Current logpost: -362.981. Length of jump: 3.          Running MCMC-PT iteration number: 37100 of 40000. Chain number 2. Current logpost: -361.424. Length of jump: 7.          Running MCMC-PT iteration number: 37200 of 40000. Chain number 3. Current logpost: -361.012. Length of jump: 7.          Running MCMC-PT iteration number: 37200 of 40000. Chain number 1. Current logpost: -361.59. Length of jump: 5.          Running MCMC-PT iteration number: 37100 of 40000. Chain number 4. Current logpost: -361.554. Length of jump: 3.          Running MCMC-PT iteration number: 37200 of 40000. Chain number 2. Current logpost: -359.363. Length of jump: 6.          Running MCMC-PT iteration number: 37300 of 40000. Chain number 3. Current logpost: -364.14. Length of jump: 5.          Running MCMC-PT iteration number: 37300 of 40000. Chain number 1. Current logpost: -362.195. Length of jump: 5.          Running MCMC-PT iteration number: 37200 of 40000. Chain number 4. Current logpost: -365.095. Length of jump: 3.          Running MCMC-PT iteration number: 37300 of 40000. Chain number 2. Current logpost: -358.353. Length of jump: 6.          Running MCMC-PT iteration number: 37400 of 40000. Chain number 3. Current logpost: -361.162. Length of jump: 6.          Running MCMC-PT iteration number: 37400 of 40000. Chain number 1. Current logpost: -359.58. Length of jump: 5.          Running MCMC-PT iteration number: 37300 of 40000. Chain number 4. Current logpost: -363.83. Length of jump: 4.          Running MCMC-PT iteration number: 37400 of 40000. Chain number 2. Current logpost: -359.08. Length of jump: 6.          Running MCMC-PT iteration number: 37500 of 40000. Chain number 3. Current logpost: -361.914. Length of jump: 5.          Running MCMC-PT iteration number: 37500 of 40000. Chain number 1. Current logpost: -358.731. Length of jump: 5.          Running MCMC-PT iteration number: 37400 of 40000. Chain number 4. Current logpost: -360.206. Length of jump: 4.          Running MCMC-PT iteration number: 37500 of 40000. Chain number 2. Current logpost: -359.486. Length of jump: 6.          Running MCMC-PT iteration number: 37600 of 40000. Chain number 3. Current logpost: -361.559. Length of jump: 4.          Running MCMC-PT iteration number: 37600 of 40000. Chain number 1. Current logpost: -359.362. Length of jump: 5.          Running MCMC-PT iteration number: 37500 of 40000. Chain number 4. Current logpost: -360.926. Length of jump: 5.          Running MCMC-PT iteration number: 37600 of 40000. Chain number 2. Current logpost: -358.771. Length of jump: 6.          Running MCMC-PT iteration number: 37700 of 40000. Chain number 3. Current logpost: -361.398. Length of jump: 4.          Running MCMC-PT iteration number: 37700 of 40000. Chain number 1. Current logpost: -359.402. Length of jump: 5.          Running MCMC-PT iteration number: 37600 of 40000. Chain number 4. Current logpost: -363.236. Length of jump: 5.          Running MCMC-PT iteration number: 37700 of 40000. Chain number 2. Current logpost: -359.603. Length of jump: 6.          Running MCMC-PT iteration number: 37800 of 40000. Chain number 3. Current logpost: -363.708. Length of jump: 5.          Running MCMC-PT iteration number: 37800 of 40000. Chain number 1. Current logpost: -361.14. Length of jump: 5.          Running MCMC-PT iteration number: 37700 of 40000. Chain number 4. Current logpost: -363.202. Length of jump: 5.          Running MCMC-PT iteration number: 37800 of 40000. Chain number 2. Current logpost: -358.878. Length of jump: 6.          Running MCMC-PT iteration number: 37900 of 40000. Chain number 3. Current logpost: -360.632. Length of jump: 5.          Running MCMC-PT iteration number: 37900 of 40000. Chain number 1. Current logpost: -358.406. Length of jump: 6.          Running MCMC-PT iteration number: 37800 of 40000. Chain number 4. Current logpost: -360.815. Length of jump: 5.          Running MCMC-PT iteration number: 37900 of 40000. Chain number 2. Current logpost: -359.011. Length of jump: 6.          Running MCMC-PT iteration number: 38000 of 40000. Chain number 3. Current logpost: -362.4. Length of jump: 6.          Running MCMC-PT iteration number: 38000 of 40000. Chain number 1. Current logpost: -358.317. Length of jump: 7.          Running MCMC-PT iteration number: 37900 of 40000. Chain number 4. Current logpost: -361.938. Length of jump: 6.          Running MCMC-PT iteration number: 38000 of 40000. Chain number 2. Current logpost: -360.102. Length of jump: 7.          Running MCMC-PT iteration number: 38100 of 40000. Chain number 3. Current logpost: -362.588. Length of jump: 6.          Running MCMC-PT iteration number: 38000 of 40000. Chain number 4. Current logpost: -360.744. Length of jump: 6.          Running MCMC-PT iteration number: 38100 of 40000. Chain number 1. Current logpost: -361.903. Length of jump: 7.          Running MCMC-PT iteration number: 38100 of 40000. Chain number 2. Current logpost: -359.411. Length of jump: 5.          Running MCMC-PT iteration number: 38200 of 40000. Chain number 3. Current logpost: -361.94. Length of jump: 5.          Running MCMC-PT iteration number: 38100 of 40000. Chain number 4. Current logpost: -362.461. Length of jump: 6.          Running MCMC-PT iteration number: 38200 of 40000. Chain number 1. Current logpost: -360.438. Length of jump: 5.          Running MCMC-PT iteration number: 38200 of 40000. Chain number 2. Current logpost: -359.826. Length of jump: 4.          Running MCMC-PT iteration number: 38300 of 40000. Chain number 3. Current logpost: -364.32. Length of jump: 6.          Running MCMC-PT iteration number: 38300 of 40000. Chain number 1. Current logpost: -362.746. Length of jump: 4.          Running MCMC-PT iteration number: 38200 of 40000. Chain number 4. Current logpost: -364.306. Length of jump: 6.          Running MCMC-PT iteration number: 38300 of 40000. Chain number 2. Current logpost: -359.924. Length of jump: 4.          Running MCMC-PT iteration number: 38400 of 40000. Chain number 3. Current logpost: -363.307. Length of jump: 7.          Running MCMC-PT iteration number: 38300 of 40000. Chain number 4. Current logpost: -361.934. Length of jump: 5.          Running MCMC-PT iteration number: 38400 of 40000. Chain number 1. Current logpost: -360.158. Length of jump: 4.          Running MCMC-PT iteration number: 38400 of 40000. Chain number 2. Current logpost: -359.38. Length of jump: 4.          Running MCMC-PT iteration number: 38500 of 40000. Chain number 3. Current logpost: -363.68. Length of jump: 7.          Running MCMC-PT iteration number: 38400 of 40000. Chain number 4. Current logpost: -362.557. Length of jump: 5.          Running MCMC-PT iteration number: 38500 of 40000. Chain number 1. Current logpost: -360.265. Length of jump: 4.          Running MCMC-PT iteration number: 38500 of 40000. Chain number 2. Current logpost: -357.237. Length of jump: 5.          Running MCMC-PT iteration number: 38600 of 40000. Chain number 3. Current logpost: -362.292. Length of jump: 7.          Running MCMC-PT iteration number: 38500 of 40000. Chain number 4. Current logpost: -360.631. Length of jump: 3.          Running MCMC-PT iteration number: 38600 of 40000. Chain number 1. Current logpost: -360.169. Length of jump: 4.          Running MCMC-PT iteration number: 38600 of 40000. Chain number 2. Current logpost: -356.941. Length of jump: 5.          Running MCMC-PT iteration number: 38700 of 40000. Chain number 3. Current logpost: -362.953. Length of jump: 6.          Running MCMC-PT iteration number: 38700 of 40000. Chain number 1. Current logpost: -361.47. Length of jump: 4.          Running MCMC-PT iteration number: 38600 of 40000. Chain number 4. Current logpost: -360.6. Length of jump: 3.          Running MCMC-PT iteration number: 38700 of 40000. Chain number 2. Current logpost: -356.579. Length of jump: 5.          Running MCMC-PT iteration number: 38800 of 40000. Chain number 3. Current logpost: -360.484. Length of jump: 6.          Running MCMC-PT iteration number: 38700 of 40000. Chain number 4. Current logpost: -362.954. Length of jump: 3.          Running MCMC-PT iteration number: 38800 of 40000. Chain number 1. Current logpost: -360.601. Length of jump: 4.          Running MCMC-PT iteration number: 38800 of 40000. Chain number 2. Current logpost: -357.671. Length of jump: 5.          Running MCMC-PT iteration number: 38900 of 40000. Chain number 3. Current logpost: -360.929. Length of jump: 7.          Running MCMC-PT iteration number: 38800 of 40000. Chain number 4. Current logpost: -362.35. Length of jump: 3.          Running MCMC-PT iteration number: 38900 of 40000. Chain number 1. Current logpost: -360.721. Length of jump: 4.          Running MCMC-PT iteration number: 38900 of 40000. Chain number 2. Current logpost: -358.126. Length of jump: 4.          Running MCMC-PT iteration number: 39000 of 40000. Chain number 3. Current logpost: -364.992. Length of jump: 7.          Running MCMC-PT iteration number: 38900 of 40000. Chain number 4. Current logpost: -362.403. Length of jump: 4.          Running MCMC-PT iteration number: 39000 of 40000. Chain number 1. Current logpost: -360.012. Length of jump: 4.          Running MCMC-PT iteration number: 39000 of 40000. Chain number 2. Current logpost: -360.593. Length of jump: 5.          Running MCMC-PT iteration number: 39100 of 40000. Chain number 3. Current logpost: -363.557. Length of jump: 7.          Running MCMC-PT iteration number: 39000 of 40000. Chain number 4. Current logpost: -363.514. Length of jump: 4.          Running MCMC-PT iteration number: 39100 of 40000. Chain number 1. Current logpost: -360.92. Length of jump: 4.          Running MCMC-PT iteration number: 39100 of 40000. Chain number 2. Current logpost: -363.431. Length of jump: 4.          Running MCMC-PT iteration number: 39200 of 40000. Chain number 3. Current logpost: -361.292. Length of jump: 6.          Running MCMC-PT iteration number: 39100 of 40000. Chain number 4. Current logpost: -360.768. Length of jump: 3.          Running MCMC-PT iteration number: 39200 of 40000. Chain number 1. Current logpost: -361.108. Length of jump: 5.          Running MCMC-PT iteration number: 39200 of 40000. Chain number 2. Current logpost: -361.091. Length of jump: 4.          Running MCMC-PT iteration number: 39300 of 40000. Chain number 3. Current logpost: -360.395. Length of jump: 5.          Running MCMC-PT iteration number: 39200 of 40000. Chain number 4. Current logpost: -364.727. Length of jump: 3.          Running MCMC-PT iteration number: 39300 of 40000. Chain number 1. Current logpost: -362.404. Length of jump: 4.          Running MCMC-PT iteration number: 39300 of 40000. Chain number 2. Current logpost: -360.669. Length of jump: 3.          Running MCMC-PT iteration number: 39400 of 40000. Chain number 3. Current logpost: -361.215. Length of jump: 6.          Running MCMC-PT iteration number: 39300 of 40000. Chain number 4. Current logpost: -360.998. Length of jump: 3.          Running MCMC-PT iteration number: 39400 of 40000. Chain number 1. Current logpost: -360.986. Length of jump: 4.          Running MCMC-PT iteration number: 39400 of 40000. Chain number 2. Current logpost: -363.086. Length of jump: 5.          Running MCMC-PT iteration number: 39500 of 40000. Chain number 3. Current logpost: -362.497. Length of jump: 7.          Running MCMC-PT iteration number: 39400 of 40000. Chain number 4. Current logpost: -360.6. Length of jump: 3.          Running MCMC-PT iteration number: 39500 of 40000. Chain number 1. Current logpost: -361.585. Length of jump: 6.          Running MCMC-PT iteration number: 39600 of 40000. Chain number 3. Current logpost: -366.055. Length of jump: 6.          Running MCMC-PT iteration number: 39500 of 40000. Chain number 2. Current logpost: -363.251. Length of jump: 6.          Running MCMC-PT iteration number: 39500 of 40000. Chain number 4. Current logpost: -360.818. Length of jump: 3.          Running MCMC-PT iteration number: 39600 of 40000. Chain number 1. Current logpost: -361.095. Length of jump: 5.          Running MCMC-PT iteration number: 39700 of 40000. Chain number 3. Current logpost: -363.726. Length of jump: 6.          Running MCMC-PT iteration number: 39600 of 40000. Chain number 2. Current logpost: -359.157. Length of jump: 6.          Running MCMC-PT iteration number: 39600 of 40000. Chain number 4. Current logpost: -361.735. Length of jump: 4.          Running MCMC-PT iteration number: 39700 of 40000. Chain number 1. Current logpost: -360.244. Length of jump: 5.          Running MCMC-PT iteration number: 39800 of 40000. Chain number 3. Current logpost: -359.755. Length of jump: 5.          Running MCMC-PT iteration number: 39700 of 40000. Chain number 2. Current logpost: -360.863. Length of jump: 6.          Running MCMC-PT iteration number: 39700 of 40000. Chain number 4. Current logpost: -362.042. Length of jump: 5.          Running MCMC-PT iteration number: 39800 of 40000. Chain number 1. Current logpost: -361.076. Length of jump: 6.          Running MCMC-PT iteration number: 39900 of 40000. Chain number 3. Current logpost: -361.405. Length of jump: 5.          Running MCMC-PT iteration number: 39800 of 40000. Chain number 2. Current logpost: -361.962. Length of jump: 7.          Running MCMC-PT iteration number: 39800 of 40000. Chain number 4. Current logpost: -363.842. Length of jump: 5.          Running MCMC-PT iteration number: 39900 of 40000. Chain number 1. Current logpost: -360.929. Length of jump: 7.          Running MCMC-PT iteration number: 39900 of 40000. Chain number 2. Current logpost: -359.367. Length of jump: 6.          Running MCMC-PT iteration number: 39900 of 40000. Chain number 4. Current logpost: -360.775. Length of jump: 5.          </span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run diagnostics to check for mixing issues</span></span>
<span><span class="co">#saveRDS(outputs, here::here("outputs", "fits", "epi", "fit_seir_cp.RDS"))</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="posterior-analysis-and-recovery">5. Posterior analysis and recovery<a class="anchor" aria-label="anchor" href="#posterior-analysis-and-recovery"></a>
</h2>
<div class="section level3">
<h3 id="posterior-over-number-of-segments-change-points-1">5.1 Posterior over number of segments (change-points + 1)<a class="anchor" aria-label="anchor" href="#posterior-over-number-of-segments-change-points-1"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">K_counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="va">outputs</span><span class="op">$</span><span class="va">jump</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span> <span class="co"># number of posterior samples per chain</span></span>
<span><span class="va">K_tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">outputs</span><span class="op">$</span><span class="va">jump</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">c</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>K <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_int</a></span><span class="op">(</span><span class="va">outputs</span><span class="op">$</span><span class="va">jump</span><span class="op">[[</span><span class="va">c</span><span class="op">]</span><span class="op">]</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">K</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="va">n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">K_mode</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">K_tab</span><span class="op">$</span><span class="va">K</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">K_tab</span><span class="op">$</span><span class="va">prop</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">K_tab</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">K</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">prop</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Number of segments (K)"</span>, y <span class="op">=</span> <span class="st">"Posterior proportion"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Posterior over number of segments"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Ex2_seir_attack_rate_files/figure-html/posterior_K-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="recover-transmission-rate-and-incidence-conditional-on-modal-k">5.2 Recover transmission rate and incidence (conditional on modal
K)<a class="anchor" aria-label="anchor" href="#recover-transmission-rate-and-incidence-conditional-on-modal-k"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract samples with K == K_mode across all chains</span></span>
<span><span class="va">samples_K</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">outputs</span><span class="op">$</span><span class="va">jump</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">c</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">keep_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_int</a></span><span class="op">(</span><span class="va">outputs</span><span class="op">$</span><span class="va">jump</span><span class="op">[[</span><span class="va">c</span><span class="op">]</span><span class="op">]</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="va">K_mode</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">keep_idx</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span><span class="va">keep_idx</span>, <span class="kw">function</span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">jump_mat</span> <span class="op">&lt;-</span> <span class="va">outputs</span><span class="op">$</span><span class="va">jump</span><span class="op">[[</span><span class="va">c</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="va">s</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">beta_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">jump_mat</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">cp_vec</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">jump_mat</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">beta_t</span>   <span class="op">&lt;-</span> <span class="fu">make_beta_t</span><span class="op">(</span><span class="va">beta_vec</span>, <span class="va">cp_vec</span>, <span class="va">T_days</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>chain <span class="op">=</span> <span class="va">c</span>, sample <span class="op">=</span> <span class="va">s</span>, day <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">T_days</span>, beta_t <span class="op">=</span> <span class="va">beta_t</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summaries for beta(t)</span></span>
<span><span class="va">beta_sum</span> <span class="op">&lt;-</span> <span class="va">samples_K</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">day</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://mjskay.github.io/ggdist/reference/point_interval.html" class="external-link">mean_qi</a></span><span class="op">(</span><span class="va">beta_t</span>, .width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">beta_sum_c</span> <span class="op">&lt;-</span> <span class="va">samples_K</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">day</span>, <span class="va">chain</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://mjskay.github.io/ggdist/reference/point_interval.html" class="external-link">mean_qi</a></span><span class="op">(</span><span class="va">beta_t</span>, .width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot with chain-specific colors</span></span>
<span><span class="va">p_beta_rec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">beta_sum_c</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">day</span>, <span class="va">beta_t</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_step</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>day <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">T_days</span>, beta_t <span class="op">=</span> <span class="va">beta_true_t</span><span class="op">)</span>,</span>
<span>            color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">.lower</span>, ymax <span class="op">=</span> <span class="va">.upper</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">chain</span><span class="op">)</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">chain</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Day"</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">beta</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Posterior "</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">beta</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">*</span><span class="st">" (modal K) with truth (red)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Incidence summaries from posterior beta paths</span></span>
<span><span class="va">inc_sum</span> <span class="op">&lt;-</span> <span class="va">samples_K</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">chain</span>, <span class="va">sample</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">seir_expected_incidence</span><span class="op">(</span></span>
<span>      T <span class="op">=</span> <span class="va">T_days</span>, N <span class="op">=</span> <span class="va">N_pop</span>, beta_t <span class="op">=</span> <span class="va">beta_t</span>,</span>
<span>      gamma <span class="op">=</span> <span class="va">gamma</span>, S0 <span class="op">=</span> <span class="va">N_pop</span> <span class="op">-</span> <span class="fl">1000</span>, E0 <span class="op">=</span> <span class="fl">0</span>, I0 <span class="op">=</span> <span class="fl">1000</span>, R0 <span class="op">=</span> <span class="fl">0</span>, rho <span class="op">=</span> <span class="va">rho_true</span></span>
<span>    <span class="op">)</span><span class="op">$</span><span class="va">incidence</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    day <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">T_days</span><span class="op">)</span>,</span>
<span>    mu <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span><span class="va">mu</span>, <span class="va">day</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"day_"</span>, <span class="va">.y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest_longer.html" class="external-link">unnest_longer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mu</span>, <span class="va">day</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">day</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://mjskay.github.io/ggdist/reference/point_interval.html" class="external-link">mean_qi</a></span><span class="op">(</span><span class="va">mu</span>, .width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_inc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>day <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">T_days</span>, y <span class="op">=</span> <span class="va">obs_y</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">day</span>, <span class="va">y</span><span class="op">)</span>,</span>
<span>           fill <span class="op">=</span> <span class="st">"grey85"</span>, color <span class="op">=</span> <span class="st">"grey40"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">inc_sum</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">day</span>, ymin <span class="op">=</span> <span class="va">.lower</span>, ymax <span class="op">=</span> <span class="va">.upper</span><span class="op">)</span>,</span>
<span>              fill <span class="op">=</span> <span class="st">"tomato"</span>, alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">inc_sum</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">day</span>, y <span class="op">=</span> <span class="va">mu</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"tomato4"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Day"</span>, y <span class="op">=</span> <span class="st">"Incidence"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Posterior incidence (modal K) with observed data"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_beta_rec</span> <span class="op">/</span> <span class="va">p_inc</span></span></code></pre></div>
<p><img src="Ex2_seir_attack_rate_files/figure-html/posterior_beta_inc-1.png" width="672"></p>
<p>This analysis shows that RJMCMC can recover both the number and
locations of change-points in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\beta(t)</annotation></semantics></math>,
and yields posterior predictive incidence consistent with the simulated
data.</p>
</div>
<div class="section level3">
<h3 id="convergence-diagnostics-between-chains">5.3 Convergence Diagnostics Between Chains<a class="anchor" aria-label="anchor" href="#convergence-diagnostics-between-chains"></a>
</h3>
<p>Let’s check for convergence between chains by comparing the posterior
distributions of beta values and change-points.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract all samples across chains for convergence analysis</span></span>
<span><span class="va">all_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">outputs</span><span class="op">$</span><span class="va">jump</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">c</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">outputs</span><span class="op">$</span><span class="va">jump</span><span class="op">[[</span><span class="va">c</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">jump_mat</span> <span class="op">&lt;-</span> <span class="va">outputs</span><span class="op">$</span><span class="va">jump</span><span class="op">[[</span><span class="va">c</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="va">s</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">K</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">jump_mat</span><span class="op">)</span></span>
<span>    <span class="va">beta_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">jump_mat</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">cp_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">jump_mat</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>      chain <span class="op">=</span> <span class="va">c</span>,</span>
<span>      sample <span class="op">=</span> <span class="va">s</span>,</span>
<span>      K <span class="op">=</span> <span class="va">K</span>,</span>
<span>      beta_1 <span class="op">=</span> <span class="kw">if</span><span class="op">(</span><span class="va">K</span> <span class="op">&gt;=</span> <span class="fl">1</span><span class="op">)</span> <span class="va">beta_vec</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="kw">else</span> <span class="cn">NA_real_</span>,</span>
<span>      beta_2 <span class="op">=</span> <span class="kw">if</span><span class="op">(</span><span class="va">K</span> <span class="op">&gt;=</span> <span class="fl">2</span><span class="op">)</span> <span class="va">beta_vec</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="kw">else</span> <span class="cn">NA_real_</span>,</span>
<span>      beta_3 <span class="op">=</span> <span class="kw">if</span><span class="op">(</span><span class="va">K</span> <span class="op">&gt;=</span> <span class="fl">3</span><span class="op">)</span> <span class="va">beta_vec</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="kw">else</span> <span class="cn">NA_real_</span>,</span>
<span>      beta_4 <span class="op">=</span> <span class="kw">if</span><span class="op">(</span><span class="va">K</span> <span class="op">&gt;=</span> <span class="fl">4</span><span class="op">)</span> <span class="va">beta_vec</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="kw">else</span> <span class="cn">NA_real_</span>,</span>
<span>      beta_5 <span class="op">=</span> <span class="kw">if</span><span class="op">(</span><span class="va">K</span> <span class="op">&gt;=</span> <span class="fl">5</span><span class="op">)</span> <span class="va">beta_vec</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span> <span class="kw">else</span> <span class="cn">NA_real_</span>,</span>
<span>      beta_6 <span class="op">=</span> <span class="kw">if</span><span class="op">(</span><span class="va">K</span> <span class="op">&gt;=</span> <span class="fl">6</span><span class="op">)</span> <span class="va">beta_vec</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span> <span class="kw">else</span> <span class="cn">NA_real_</span>,</span>
<span>      beta_7 <span class="op">=</span> <span class="kw">if</span><span class="op">(</span><span class="va">K</span> <span class="op">&gt;=</span> <span class="fl">7</span><span class="op">)</span> <span class="va">beta_vec</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span> <span class="kw">else</span> <span class="cn">NA_real_</span>,</span>
<span>      beta_8 <span class="op">=</span> <span class="kw">if</span><span class="op">(</span><span class="va">K</span> <span class="op">&gt;=</span> <span class="fl">8</span><span class="op">)</span> <span class="va">beta_vec</span><span class="op">[</span><span class="fl">8</span><span class="op">]</span> <span class="kw">else</span> <span class="cn">NA_real_</span>,</span>
<span>      beta_9 <span class="op">=</span> <span class="kw">if</span><span class="op">(</span><span class="va">K</span> <span class="op">&gt;=</span> <span class="fl">9</span><span class="op">)</span> <span class="va">beta_vec</span><span class="op">[</span><span class="fl">9</span><span class="op">]</span> <span class="kw">else</span> <span class="cn">NA_real_</span>,</span>
<span>      beta_10 <span class="op">=</span> <span class="kw">if</span><span class="op">(</span><span class="va">K</span> <span class="op">&gt;=</span> <span class="fl">10</span><span class="op">)</span> <span class="va">beta_vec</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span> <span class="kw">else</span> <span class="cn">NA_real_</span>,</span>
<span>      cp_1 <span class="op">=</span> <span class="kw">if</span><span class="op">(</span><span class="va">K</span> <span class="op">&gt;=</span> <span class="fl">2</span><span class="op">)</span> <span class="va">cp_vec</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="kw">else</span> <span class="cn">NA_real_</span>,</span>
<span>      cp_2 <span class="op">=</span> <span class="kw">if</span><span class="op">(</span><span class="va">K</span> <span class="op">&gt;=</span> <span class="fl">3</span><span class="op">)</span> <span class="va">cp_vec</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="kw">else</span> <span class="cn">NA_real_</span>,</span>
<span>      cp_3 <span class="op">=</span> <span class="kw">if</span><span class="op">(</span><span class="va">K</span> <span class="op">&gt;=</span> <span class="fl">4</span><span class="op">)</span> <span class="va">cp_vec</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="kw">else</span> <span class="cn">NA_real_</span>,</span>
<span>      cp_4 <span class="op">=</span> <span class="kw">if</span><span class="op">(</span><span class="va">K</span> <span class="op">&gt;=</span> <span class="fl">5</span><span class="op">)</span> <span class="va">cp_vec</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="kw">else</span> <span class="cn">NA_real_</span>,</span>
<span>      cp_5 <span class="op">=</span> <span class="kw">if</span><span class="op">(</span><span class="va">K</span> <span class="op">&gt;=</span> <span class="fl">6</span><span class="op">)</span> <span class="va">cp_vec</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span> <span class="kw">else</span> <span class="cn">NA_real_</span>,</span>
<span>      cp_6 <span class="op">=</span> <span class="kw">if</span><span class="op">(</span><span class="va">K</span> <span class="op">&gt;=</span> <span class="fl">7</span><span class="op">)</span> <span class="va">cp_vec</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span> <span class="kw">else</span> <span class="cn">NA_real_</span>,</span>
<span>      cp_7 <span class="op">=</span> <span class="kw">if</span><span class="op">(</span><span class="va">K</span> <span class="op">&gt;=</span> <span class="fl">8</span><span class="op">)</span> <span class="va">cp_vec</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span> <span class="kw">else</span> <span class="cn">NA_real_</span>,</span>
<span>      cp_8 <span class="op">=</span> <span class="kw">if</span><span class="op">(</span><span class="va">K</span> <span class="op">&gt;=</span> <span class="fl">9</span><span class="op">)</span> <span class="va">cp_vec</span><span class="op">[</span><span class="fl">8</span><span class="op">]</span> <span class="kw">else</span> <span class="cn">NA_real_</span>    <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 1. Compare number of segments (K) between chains</span></span>
<span><span class="va">K_convergence</span> <span class="op">&lt;-</span> <span class="va">all_samples</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">chain</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    mean_K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">K</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    sd_K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">K</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    median_K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">K</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    q25_K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">K</span>, <span class="fl">0.25</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    q75_K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">K</span>, <span class="fl">0.75</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Convergence check for number of segments (K):"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Convergence check for number of segments (K):"</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">K_convergence</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 6</span></span></span>
<span><span class="co">##   chain mean_K  sd_K median_K q25_K q75_K</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>     1   5.21  1.03        5     4     6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>     2   6.64  1.42        7     6     8</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>     3   6.25  1.21        6     5     7</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>     4   5.60  1.37        6     5     7</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 2. Compare beta values between chains (conditional on K)</span></span>
<span><span class="co"># Focus on the most common K value</span></span>
<span><span class="va">K_mode</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">all_samples</span><span class="op">$</span><span class="va">K</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nMost common K value:"</span>, <span class="va">K_mode</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Most common K value: 5</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract samples with K == K_mode for beta comparison</span></span>
<span><span class="va">beta_samples</span> <span class="op">&lt;-</span> <span class="va">all_samples</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">K</span> <span class="op">==</span> <span class="va">K_mode</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">chain</span>, <span class="va">sample</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"beta_"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"beta_"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"segment"</span>, values_to <span class="op">=</span> <span class="st">"beta"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>segment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"beta_"</span>, <span class="st">""</span>, <span class="va">segment</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Beta convergence by segment</span></span>
<span><span class="va">beta_convergence</span> <span class="op">&lt;-</span> <span class="va">beta_samples</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">segment</span>, <span class="va">chain</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    mean_beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">beta</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    sd_beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">beta</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    median_beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">beta</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    q25_beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">beta</span>, <span class="fl">0.25</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    q75_beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">beta</span>, <span class="fl">0.75</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"\nBeta convergence by segment and chain:"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "\nBeta convergence by segment and chain:"</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">beta_convergence</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 20 × 7</span></span></span>
<span><span class="co">##    segment chain mean_beta  sd_beta median_beta q25_beta q75_beta</span></span>
<span><span class="co">##      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>       1     1    0.299  0.000<span style="text-decoration: underline;">675</span>      0.299     0.299   0.300 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>       1     2    0.300  0.001<span style="text-decoration: underline;">21</span>       0.300     0.299   0.300 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>       1     3    0.300  0.000<span style="text-decoration: underline;">615</span>      0.299     0.299   0.300 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>       1     4    0.300  0.000<span style="text-decoration: underline;">518</span>      0.300     0.300   0.300 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>       2     1    0.030<span style="text-decoration: underline;">7</span> 0.074<span style="text-decoration: underline;">1</span>        0.01      0.01    0.01  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>       2     2    0.195  0.139         0.297     0.01    0.300 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>       2     3    0.010<span style="text-decoration: underline;">0</span> 0.000<span style="text-decoration: underline;">134</span>      0.01      0.01    0.01  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>       2     4    0.032<span style="text-decoration: underline;">2</span> 0.076<span style="text-decoration: underline;">4</span>        0.01      0.01    0.01  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>       3     1    0.010<span style="text-decoration: underline;">3</span> 0.001<span style="text-decoration: underline;">89</span>       0.01      0.01    0.01  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>       3     2    0.058<span style="text-decoration: underline;">6</span> 0.108         0.01      0.01    0.01  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span>       3     3    0.021<span style="text-decoration: underline;">4</span> 0.052<span style="text-decoration: underline;">4</span>        0.01      0.01    0.010<span style="text-decoration: underline;">1</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span>       3     4    0.027<span style="text-decoration: underline;">4</span> 0.080<span style="text-decoration: underline;">0</span>        0.01      0.01    0.01  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">13</span>       4     1    0.092<span style="text-decoration: underline;">6</span> 0.160         0.01      0.01    0.021<span style="text-decoration: underline;">4</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">14</span>       4     2    0.161  0.187         0.010<span style="text-decoration: underline;">1</span>    0.01    0.393 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">15</span>       4     3    0.218  0.195         0.393     0.01    0.400 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">16</span>       4     4    0.171  0.193         0.012<span style="text-decoration: underline;">8</span>    0.01    0.400 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">17</span>       5     1    0.402  0.006<span style="text-decoration: underline;">85</span>       0.404     0.400   0.405 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">18</span>       5     2    0.405  0.007<span style="text-decoration: underline;">97</span>       0.404     0.401   0.406 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">19</span>       5     3    0.409  0.012<span style="text-decoration: underline;">6</span>        0.405     0.403   0.412 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">20</span>       5     4    0.408  0.014<span style="text-decoration: underline;">1</span>        0.405     0.401   0.409</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 3. Compare change-points between chains (conditional on K)</span></span>
<span><span class="va">cp_samples</span> <span class="op">&lt;-</span> <span class="va">all_samples</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">K</span> <span class="op">==</span> <span class="va">K_mode</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">chain</span>, <span class="va">sample</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"cp_"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"cp_"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"cp_idx"</span>, values_to <span class="op">=</span> <span class="st">"cp"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">cp</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cp_idx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"cp_"</span>, <span class="st">""</span>, <span class="va">cp_idx</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Change-point convergence by index</span></span>
<span><span class="va">cp_convergence</span> <span class="op">&lt;-</span> <span class="va">cp_samples</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">cp_idx</span>, <span class="va">chain</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    mean_cp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">cp</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    sd_cp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">cp</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    median_cp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">cp</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    q25_cp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">cp</span>, <span class="fl">0.25</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    q75_cp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">cp</span>, <span class="fl">0.75</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"\nChange-point convergence by index and chain:"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "\nChange-point convergence by index and chain:"</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">cp_convergence</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 16 × 7</span></span></span>
<span><span class="co">##    cp_idx chain mean_cp sd_cp median_cp q25_cp q75_cp</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>      1     1    39.4  2.28        40   40       40</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>      1     2    29.6  9.27        28   23       40</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>      1     3    40    0           40   40       40</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>      1     4    39.4  2.79        40   40       40</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>      2     1    55.6  9.67        56   47.2     63</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>      2     2    41.5 10.5         40   40       46</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>      2     3    61.5 10.2         59   54       67</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>      2     4    54.9 10.5         53   48       60</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>      3     1    70.4  7.09        71   65       75</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>      3     2    64.8 15.8         73   52       80</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span>      3     3    75.1  7.76        80   72       80</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span>      3     4    74.3 10.8         76   68       80</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">13</span>      4     1    85.3 10.9         80   80       80</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">14</span>      4     2    83.2  6.70        80   80       84</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">15</span>      4     3    93.1 14.1         87   80      110</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">16</span>      4     4    91.7 14.5         80   80      107</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 4. Visual convergence diagnostics</span></span>
<span><span class="co"># Beta values by chain and segment</span></span>
<span><span class="va">p_beta_conv</span> <span class="op">&lt;-</span> <span class="va">beta_samples</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">chain</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">beta</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">chain</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">segment</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Chain"</span>, y <span class="op">=</span> <span class="st">"Beta value"</span>, title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Beta convergence across chains (K ="</span>, <span class="va">K_mode</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Change-points by chain and index</span></span>
<span><span class="va">p_cp_conv</span> <span class="op">&lt;-</span> <span class="va">cp_samples</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">chain</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">cp</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">chain</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">cp_idx</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Chain"</span>, y <span class="op">=</span> <span class="st">"Change-point day"</span>, title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Change-point convergence across chains (K ="</span>, <span class="va">K_mode</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 5. Gelman-Rubin diagnostic (approximate)</span></span>
<span><span class="co"># Compute within-chain and between-chain variances for key parameters</span></span>
<span><span class="va">gelman_rubin</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">samples</span>, <span class="va">param_name</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Check if the parameter column exists</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">param_name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">NA_real_</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Extract parameter values</span></span>
<span>  <span class="va">param_data</span> <span class="op">&lt;-</span> <span class="va">samples</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">chain</span>, <span class="va">sample</span>, <span class="op">!</span><span class="op">!</span><span class="va">param_name</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html" class="external-link">sym</a></span><span class="op">(</span><span class="va">param_name</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">param_data</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">NA_real_</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Within-chain variance</span></span>
<span>  <span class="va">W</span> <span class="op">&lt;-</span> <span class="va">param_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">chain</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>var_within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html" class="external-link">sym</a></span><span class="op">(</span><span class="va">param_name</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">var_within</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Between-chain variance</span></span>
<span>  <span class="va">chain_means</span> <span class="op">&lt;-</span> <span class="va">param_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">chain</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>mean_val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html" class="external-link">sym</a></span><span class="op">(</span><span class="va">param_name</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">mean_val</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">overall_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">chain_means</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">chain_means</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">param_data</span><span class="op">$</span><span class="va">chain</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Pooled variance</span></span>
<span>  <span class="va">V</span> <span class="op">&lt;-</span> <span class="va">W</span> <span class="op">+</span> <span class="va">B</span></span>
<span>  </span>
<span>  <span class="co"># Potential scale reduction factor</span></span>
<span>  <span class="va">R_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">V</span> <span class="op">/</span> <span class="va">W</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">R_hat</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Compute R-hat for key parameters - only for existing columns</span></span>
<span><span class="co"># First, get the actual columns that exist in beta_samples</span></span>
<span><span class="va">existing_beta_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">beta_samples</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^beta_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">beta_samples</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">existing_cp_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cp_samples</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^cp_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cp_samples</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Extract segment numbers from column names</span></span>
<span><span class="va">beta_segments</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"beta_"</span>, <span class="st">""</span>, <span class="va">existing_beta_cols</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cp_indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"cp_"</span>, <span class="st">""</span>, <span class="va">existing_cp_cols</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute R-hat only for existing parameters</span></span>
<span><span class="va">rhat_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="va">beta_segments</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">gelman_rubin</span><span class="op">(</span><span class="va">beta_samples</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"beta_"</span>, <span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rhat_cp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="va">cp_indices</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">gelman_rubin</span><span class="op">(</span><span class="va">cp_samples</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"cp_"</span>, <span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nGelman-Rubin diagnostic (R-hat) - values close to 1 indicate convergence:"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Gelman-Rubin diagnostic (R-hat) - values close to 1 indicate convergence:</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nBeta parameters:"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Beta parameters:</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">beta_segments</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n  beta_"</span>, <span class="va">beta_segments</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">": "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">rhat_beta</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nChange-point parameters:"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Change-point parameters:</span></span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">cp_indices</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n  cp_"</span>, <span class="va">cp_indices</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">": "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">rhat_cp</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##   cp_NA: NA</span></span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display convergence plots</span></span>
<span><span class="va">p_beta_conv</span></span></code></pre></div>
<p><img src="Ex2_seir_attack_rate_files/figure-html/convergence_check-1.png" width="960"></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_cp_conv</span></span></code></pre></div>
<p><img src="Ex2_seir_attack_rate_files/figure-html/convergence_check-2.png" width="960"></p>
</div>
<div class="section level3">
<h3 id="convergence-assessment">5.4 Convergence Assessment<a class="anchor" aria-label="anchor" href="#convergence-assessment"></a>
</h3>
<p>The convergence diagnostics above help assess whether the RJMCMC
chains have converged:</p>
<ul>
<li>
<strong>R-hat values</strong>: Should be close to 1.0 (typically
&lt; 1.1 is acceptable)</li>
<li>
<strong>Between-chain variation</strong>: Beta values and
change-points should show similar distributions across chains</li>
<li>
<strong>Visual inspection</strong>: Boxplots should show similar
spreads and medians across chains</li>
</ul>
<p>If convergence is poor, consider: - Increasing the number of
iterations - Extending the burn-in period - Adjusting the proposal
distributions - Checking for multimodality in the posterior</p>
</div>
<div class="section level3">
<h3 id="acceptance-ratio-details">5.5 Acceptance Ratio Details<a class="anchor" aria-label="anchor" href="#acceptance-ratio-details"></a>
</h3>
<p>The RJMCMC implementation uses the theoretical framework from
Lyyjynen (2014) §5.2:</p>
<ul>
<li>
<p><strong>Birth acceptance ratio</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mfrac><mrow><mi>π</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mi>′</mi><mo>,</mo><mi>k</mi><mi>′</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>π</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo>,</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>×</mo><mfrac><mrow><mi>q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo>,</mo><mi>k</mi><mo stretchy="false" form="prefix">|</mo><mi>θ</mi><mi>′</mi><mo>,</mo><mi>k</mi><mi>′</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mi>′</mi><mo>,</mo><mi>k</mi><mi>′</mi><mo stretchy="false" form="prefix">|</mo><mi>θ</mi><mo>,</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>×</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>J</mi><mo stretchy="true" form="postfix">|</mo></mrow></mrow><annotation encoding="application/x-tex">A = \frac{\pi(\theta', k')}{\pi(\theta, k)} \times \frac{q(\theta, k|\theta', k')}{q(\theta', k'|\theta, k)} \times |J|</annotation></semantics></math></p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>⋅</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi(\cdot)</annotation></semantics></math>
is the posterior density</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>⋅</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">q(\cdot)</annotation></semantics></math>
is the proposal density<br>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">|</mo><mi>J</mi><mo stretchy="true" form="postfix">|</mo></mrow><annotation encoding="application/x-tex">|J|</annotation></semantics></math>
is the Jacobian determinant for the transformation</li>
</ul>
</li>
<li><p><strong>Death acceptance ratio</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><annotation encoding="application/x-tex">A^{-1}</annotation></semantics></math>
(reciprocal of birth ratio)</p></li>
<li><p><strong>Proposal probabilities</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>b</mi><mi>k</mi></msub><annotation encoding="application/x-tex">b_k</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>d</mi><mi>k</mi></msub><annotation encoding="application/x-tex">d_k</annotation></semantics></math>
derived from Poisson prior ratios</p></li>
<li><p><strong>Jacobian</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">|</mo><mi>J</mi><mo stretchy="true" form="postfix">|</mo></mrow><mo>≈</mo><msub><mi>h</mi><mtext mathvariant="normal">parent</mtext></msub><mi>/</mi><msubsup><mi>u</mi><mn>2</mn><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">|J| \approx h_{\text{parent}} / u_2^2</annotation></semantics></math>
for the height transformation</p></li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by David Hodgson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
